[
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.1 Security Defaults",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.1 Security Defaults"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_1_1",
    "description": "Security defaults in Azure Active Directory (Azure AD) make it easier to be secure and help protect your organization. Security defaults contain preconfigured security settings for common attacks. Security defaults is available to everyone. The goal is to ensure that all organizations have a basic level of security enabled at no extra cost. You may turn on security defaults in the Azure portal.",
    "title": "1.1.1 Ensure Security Defaults is enabled on Azure Active Directory",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.1.1",
      "cis_level": "1",
      "cis_section_id": "1.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nSecurity defaults in Azure Active Directory (Azure AD) make it easier to be secure and help protect your organization. Security defaults contain preconfigured security settings for common attacks.\n\nSecurity defaults is available to everyone. The goal is to ensure that all organizations have a basic level of security enabled at no extra cost. You may turn on security defaults in the Azure portal.\n\nSecurity defaults provide secure default settings that we manage on behalf of organizations to keep customers safe until they are ready to manage their own identity security settings.\nFor example, doing the following:\n- Requiring all users and admins to register for MFA.\n- Challenging users with MFA - when necessary, based on factors such as location, device, role, and task.\n- Disabling authentication from legacy authentication clients, which can’t do MFA.\n\n## Remediation\n\n### From Azure Portal\n\nTo enable security defaults in your directory:\n\n1. From Azure Home select the Portal Menu.\n2. Browse to `Azure Active Directory` \u003e `Properties`.\n3. Select `Manage security defaults`.\n4. Set the `Enable security defaults toggle to Yes`.\n5. Select `Save`.\n\n### Default Value\n\nIf your tenant was created on or after October 22, 2019, security defaults may already be enabled in your tenant.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.1 Security Defaults",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.1 Security Defaults"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_1_2",
    "description": "Enable multi-factor authentication for all roles, groups, and users that have write access or permissions to Azure resources.",
    "title": "1.1.2 Ensure that 'Multi-Factor Auth Status' is 'Enabled' for all Privileged Users",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.1.2",
      "cis_level": "1",
      "cis_section_id": "1.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnable multi-factor authentication for all roles, groups, and users that have write access or permissions to Azure resources. These include custom created objects or built-in roles such as;\n- Service Co-Administrators\n- Subscription Owners\n- Contributors\n\nMulti-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory` blade.\n3. Select `Users`.\n4. Take note of all users with the role `Service Co-Administrators`, `Owners` or `Contributors`.\n5. Click on the `Per-User MFA button` in the top row menu.\n6. Check the box next to each noted user.\n7. Click `Enable` under quick steps in the right-hand panel.\n8. Click `enable multi-factor auth`.\n9. Click `close`.\n\n### Other Options within Azure Portal\n\nFollow Microsoft Azure documentation and enable multi-factor authentication in your environment.\n\nhttps://docs.microsoft.com/en-us/azure/active-directory/authentication/tutorial-enable-azure-mfa\n\nEnabling and configuring MFA with conditional access policy is a multi-step process. Here are some additional resources on the process within Azure AD to enable multi- factor authentication for users within your subscriptions with conditional access policy.\n\nhttps://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-admin-mfa https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted#enable-multi-factor-authentication-with-conditional-access https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-mfasettings\n\n### Default Value\n\nBy default, multi-factor authentication is disabled for all users.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.1 Security Defaults",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.1 Security Defaults"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_1_3",
    "description": "Enable multi-factor authentication for all non-privileged users.",
    "title": "1.1.3 Ensure that 'Multi-Factor Auth Status' is 'Enabled' for all Non-Privileged Users",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.1.3",
      "cis_level": "2",
      "cis_section_id": "1.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnable multi-factor authentication for all non-privileged users.\n\nMulti-factor authentication requires an individual to present a minimum of two separate forms of authentication before access is granted. Multi-factor authentication provides additional assurance that the individual attempting to gain access is who they claim to be. With multi-factor authentication, an attacker would need to compromise at least two different authentication mechanisms, increasing the difficulty of compromise and thus reducing the risk.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select the `Azure Active Directory` blade.\n3. Then `Users`.\n4. Select `All Users`.\n5. Click on `Per-User MFA` button on the top bar.\n6. Ensure that for all users `MULTI-FACTOR AUTH STATUS` is `Enabled`.\n\nFollow Microsoft Azure documentation and enable multi-factor authentication in your environment.\n\n[https://docs.microsoft.com/en-us/azure/active-directory/authentication/tutorial-enable-azure-mfa](https://docs.microsoft.com/en-us/azure/active-directory/authentication/tutorial-enable-azure-mfa)\n\nEnabling and configuring MFA is a multi-step process. Here are some additional resources on the process within Azure AD:\n- [https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-admin-mfa](https://docs.microsoft.com/en-us/azure/active-directory/conditional-access/howto-conditional-access-policy-admin-mfa)\n- [https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted#enable-multi-factor-authentication-with-conditional-access](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-getstarted#enable-multi-factor-authentication-with-conditional-access)\n- [https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-mfasettings](https://docs.microsoft.com/en-us/azure/active-directory/authentication/howto-mfa-mfasettings)\n\n### Default Value\n\nBy default, multi-factor authentication is disabled for all users.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.1 Security Defaults",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.1 Security Defaults"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_1_4",
    "description": "Do not allow users to remember multi-factor authentication on devices.",
    "title": "1.1.4 Ensure that 'Allow users to remember multi-factor authentication on devices they trust' is Disabled",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.1.4",
      "cis_level": "1",
      "cis_section_id": "1.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nDo not allow users to remember multi-factor authentication on devices.\n\nRemembering Multi-Factor Authentication (MFA) for devices and browsers allows users to have the option to bypass MFA for a set number of days after performing a successful sign-in using MFA. This can enhance usability by minimizing the number of times a user may need to perform two-step verification on the same device. However, if an account or device is compromised, remembering MFA for trusted devices may affect security. Hence, it is recommended that users not be allowed to bypass MFA.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Users`.\n4. Click the `Per-user MFA` button on the top bar.\n5. Click on `service settings`.\n6. Uncheck the box next to `Allow users to remember multi-factor authentication on devices they trust`.\n\n### Default Value\n\nBy default, `Allow users to remember multi-factor authentication on devices they trust` is disabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_1",
    "description": "Azure Active Directory Conditional Access allows an organization to configure Named locations and configure whether those locations are trusted or untrusted. These settings provide organizations the means to specify Geographical locations for use in conditional access policies, or define actual IP addresses and IP ranges and whether or not those IP addresses and/or ranges are trusted by the organization.",
    "title": "1.2.1 Ensure Trusted Locations Are Defined",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.1",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nAzure Active Directory Conditional Access allows an organization to configure `Named locations` and configure whether those locations are trusted or untrusted. These settings provide organizations the means to specify Geographical locations for use in conditional access policies, or define actual IP addresses and IP ranges and whether or not those IP addresses and/or ranges are trusted by the organization.\n\nDefining trusted source IP addresses or ranges helps organizations create and enforce Conditional Access policies around those trusted or untrusted IP addresses and ranges. Users authenticating from trusted IP addresses and/or ranges may have less access restrictions or access requirements when compared to users that try to authenticate to Azure Active Directory from untrusted locations or untrusted source IP addresses/ranges.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Azure AD Conditional Access` Blade.\n2. Click on the `Named locations` blade.\n3. Within the `Named locations` blade, click on `IP ranges location`.\n4. Enter a name for this location setting in the Name text box.\n5. Click on the `+` sign.\n6. Add an IP Address Range in CIDR notation inside the text box that appears.\n7. Click on the `Add` button.\n8. Repeat steps 5 through 7 for each IP Range that needs to be added.\n9. If the information entered are trusted ranges, select the `Mark as trusted location` check box.\n10. Once finished, click on `Create`.\n\n### From PowerShell\n\nCreate a new trusted IP-based Named location policy\n\n```bash\n[System.Collections.Generic.List`1[Microsoft.Open.MSGraph.Model.IpRange]]$ipR anges = @()\n$ipRanges.Add(\"\u003cfirst IP range in CIDR notation\u003e\")\n$ipRanges.Add(\"\u003csecond IP range in CIDR notation\u003e\")\n$ipRanges.Add(\"\u003cthird IP range in CIDR notation\u003e\") New-AzureADMSNamedLocationPolicy -OdataType \"#microsoft.graph.ipNamedLocation\" -DisplayName \"\u003cname of IP Named location policy\u003e -IsTrusted $true -IpRanges $ipRanges\n```\n\nSet an existing IP-based Named location policy to trusted\n\n```bash\nSet-AzureADMSNamedLocationPolicy -PolicyId \"\u003cID of the policy\u003e\" -OdataType \"#microsoft.graph.ipNamedLocation\" -IsTrusted $true\n```\n\n### Default Value\n\nBy default, no locations are configured under the Named locations blade within the Azure AD Conditional Access blade.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_2",
    "description": "Conditional Access Policies can be used to block access from geographic locations that are deemed out-of-scope for your organization or application. The scope and variables for this policy should be carefully examined and defined.",
    "title": "1.2.2 Ensure that an exclusionary Geographic Access Policy is considered",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.2",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nConditional Access Policies can be used to block access from geographic locations that are deemed out-of-scope for your organization or application. The scope and variables for this policy should be carefully examined and defined.\n\nConditional Access, when used as a deny list for the tenant or subscription, is able to prevent ingress or egress of traffic to countries that are outside of the scope of interest (e.g.: customers, suppliers) or jurisdiction of an organization. This is an effective way to prevent unnecessary and long-lasting exposure to international threats such as APTs.\n\n## Remediation\n\n### From Azure Portal\n\nPart 1 of 2 - Create the policy and enable it in `Report-only` mode.\n\n1. From Azure Home open the portal menu in the top left, and select `Azure Active Directory`.\n2. Scroll down in the menu on the left, and select `Security`.\n3. Select on the left side `Conditional Access`.\n4. Click the `+ New policy` button, then:\n5. Provide a name for the policy.\n6. Under `Assignments`, select `Users or work load identities` then:\n   - Under `Include`, select `All users`\n   - Under `Exclude`, check Users and groups and only select emergency access accounts and service accounts (**NOTE:** Service accounts are excluded here because service accounts are non-interactive and cannot complete MFA)\n7. Under `Assignments`, select `Cloud apps or actions` then:\n   - Under `Include`, select `All cloud apps`\n   - Leave `Exclude` blank unless you have a well defined exception.\n8. Under `Conditions`, select `Locations` then:\n   - Select `Include`, then add entries for locations for those that should be blocked.\n   - Select `Exclude`, then add entries for those that should be allowed (**IMPORTANT:** Ensure that all Trusted Locations are in the `Exclude` list.)\n9. Under `Access Controls`, select `Grant` and Confirm that `Block Access` is selected.\n10. Set `Enable policy` to `Report-only`.\n11. Click `Create`.\n\n**NOTE:** The policy is not yet 'live,' since `Report-only` is being used to audit the effect of the policy.\n\nPart 2 of 2 - Confirm that the policy is not blocking access that should be granted, then toggle to `On`.\n\n1. With your policy now in report-only mode, return to the Azure Active Directory blade and click on `Sign-in logs`.\n2. Review the recent sign-in events - click an event then review the event details (specifically the `Report-only` tab) to ensure:\n   - The sign-in event you're reviewing occurred **after** turning on the policy in report-only mode.\n   - The policy name from step 5 above is listed in the `Policy Name` column.\n   - The `Result` column for the new policy shows that the policy was `Not applied` (indicating the location origin was not blocked).\n3. If the above conditions are present, navigate back to the policy name in Conditional Access and open it.\n4. Toggle the policy from `Report-only` to `On`.\n5. Click `Save`.\n\n### From PowerShell\n\nFirst, set up the conditions objects values before updating an existing conditional access policy or before creating a new one. You may need to use additional PowerShell cmdlets to retrieve specific IDs such as the `Get-AzureADMSNamedLocationPolicy` which outputs the `Location IDs` for use with conditional access policies.\n\n```bash\n$conditions = New-Object -TypeName Microsoft.Open.MSGraph.Model.ConditionalAccessConditionSet\n\n$conditions.Applications = New-Object -TypeName Microsoft.Open.MSGraph.Model.ConditionalAccessApplicationCondition $conditions.Applications.IncludeApplications = \u003c\"All\" | \"Office365\" | \"app ID\" | @(\"app ID 1\", \"app ID 2\", etc...\u003e $conditions.Applications.ExcludeApplications = \u003c\"Office365\" | \"app ID\" | @(\"app ID 1\", \"app ID 2\", etc...)\u003e\n\n$conditions.Users = New-Object -TypeName Microsoft.Open.MSGraph.Model.ConditionalAccessUserCondition $conditions.Users.IncludeUsers = \u003c\"All\" | \"None\" | \"GuestsOrExternalUsers\" | \"Specific User ID\" | @(\"User ID 1\", \"User ID 2\", etc.)\u003e $conditions.Users.ExcludeUsers = \u003c\"GuestsOrExternalUsers\" | \"Specific User ID\" | @(\"User ID 1\", \"User ID 2\", etc.)\u003e\n$conditions.Users.IncludeGroups = \u003c\"group ID\" | \"All\" | @(\"Group ID 1\", \"Group ID 2\", etc...)\u003e\n$conditions.Users.ExcludeGroups = \u003c\"group ID\" | @(\"Group ID 1\", \"Group ID 2\", etc...)\u003e\n$conditions.Users.IncludeRoles = \u003c\"Role ID\" | \"All\" | @(\"Role ID 1\", \"Role ID 2\", etc...)\u003e\n$conditions.Users.ExcludeRoles = \u003c\"Role ID\" | @(\"Role ID 1\", \"Role ID 2\", etc...)\u003e\n\n$conditions.Locations = New-Object -TypeName Microsoft.Open.MSGraph.Model.ConditionalAccessLocationCondition $conditions.Locations.IncludeLocations = \u003c\"Location ID\" | @(\"Location ID 1\", \"Location ID 2\", etc...) \u003e\n$conditions.Locations.ExcludeLocations = \u003c\"AllTrusted\" | \"Location ID\" | @(\"Location ID 1\", \"Location ID 2\", etc...)\u003e\n\n\n$controls = New-Object -TypeName Microsoft.Open.MSGraph.Model.ConditionalAccessGrantControls $controls._Operator = \"OR\"\n$controls.BuiltInControls = \"block\"\n```\n\nNext, update the existing conditional access policy with the condition set options configured with the previous commands.\n\n```bash\nSet-AzureADMSConditionalAccessPolicy -PolicyId \u003cpolicy ID\u003e -Conditions $conditions -GrantControls $controls\n```\n\nTo create a new conditional access policy that complies with this best practice, run the following commands after creating the condition set above\n\n```bash\nNew-AzureADMSConditionalAccessPolicy -Name \"Policy Name\" -State \u003cenabled|disabled\u003e -Conditions $conditions -GrantControls $controls\n```\n\n### Default Value\n\nThis policy does not exist by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_3",
    "description": "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.",
    "title": "1.2.3 Ensure that A Multi-factor Authentication Policy Exists for Administrative Groups",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.3",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nFor designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.\n\nEnabling multi-factor authentication is a recommended setting to limit the use of Administrative accounts to authenticated personnel.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home open the Portal Menu in top left, and select Azure Active Directory.\n2. Select `Security`.\n3. Select `Conditional Access`.\n4. Click `+ New policy`.\n5. Enter a name for the policy.\n6. Select `Users or workload identities`.\n7. Check `Users and groups`.\n8. Select administrative groups this policy should apply to and click `Select`.\n9. Under `Exclude`, check `Users and groups`.\n10. Select users this policy not should apply to and click `Select`.\n11. Select `Cloud apps or actions`.\n12. Select `All cloud apps`.\n13. Select `Grant`.\n14. Under Grant access, check `Require multifactor authentication` and click `Select`.\n15. Set `Enable policy` to `Report-only`.\n16. Click `Create`.\n\nAfter testing the policy in report-only mode, update the `Enable policy` setting from `Report-only` to `On`.\n\n### Default Value\n\nBy default, MFA is not enabled for any administrative accounts.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_4",
    "description": "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.",
    "title": "1.2.4 Ensure that A Multi-factor Authentication Policy Exists for All Users",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.4",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nFor designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.\n\nEnabling multi-factor authentication is a recommended setting to limit the potential of accounts being compromised and limiting access to authenticated personnel.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home open Portal menu in the top left, and select `Azure Active Directory`.\n2. Select `Security`.\n3. Select `Conditional Access`.\n4. Click `+ New policy`.\n5. Enter a name for the policy.\n6. Select `Users or work load identities`.\n7. Under `Include`, select `All users`.\n8. Under `Exclude`, check `Users and groups`.\n9. Select users this policy should not apply to and click `Select`.\n10. Select `Cloud apps or actions`.\n11. Select `All cloud apps`.\n12. Select `Grant`.\n13. Under `Grant access`, check `Require multifactor authentication` and click `Select`.\n14. Set `Enable policy` to `Report-only`.\n15. Click `Create`.\n\nAfter testing the policy in report-only mode, update the `Enable policy` setting from `Report-only` to `On`.\n\n### Default Value\n\nMFA is not enabled by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_5",
    "description": "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.",
    "title": "1.2.5 Ensure Multi-factor Authentication is Required for Risky Sign-ins",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.5",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nFor designated users, they will be prompted to use their multi-factor authentication (MFA) process on login.\n\nEnabling multi-factor authentication is a recommended setting to limit the potential of accounts being compromised and limiting access to authenticated personnel.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu in the top left, and select `Azure Active Directory`.\n2. Select `Security`\n3. Select `Conditional Access`.\n4. Click `+ New policy`.\n5. Enter a name for the policy.\n6. Select `Users or workload identities`.\n7. Under `Include`, select `All users`.\n8. Under `Exclude`, check `Users and groups`.\n9. Select users this policy should not apply to and click `Select`.\n10. Select `Cloud apps or actions`.\n11. Select `All cloud apps`.\n12. Select `Conditions`.\n13. Select `Sign-in risk`.\n14. Update the `Configure` toggle to `Yes`.\n15. Check the sign-in risk level this policy should apply to, e.g. `High` and `Medium`.\n16. Select `Done`.\n17. Select `Grant`.\n18. Under `Grant access`, check `Require multifactor authentication` and click `Select`.\n19. Set `Enable policy` to `Report-only`.\n20. Click `Create`.\n\nAfter testing the policy in report-only mode, update the `Enable policy` setting from `Report-only` to `On`.\n\n### Default Value\n\nMFA is not enabled by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management \u003e 1.2 Conditional Access",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management",
      "1.2 Conditional Access"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_2_6",
    "description": "For designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.",
    "title": "1.2.6 Ensure Multi-factor Authentication is Required for Azure Management",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.2.6",
      "cis_level": "1",
      "cis_section_id": "1.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nFor designated users, they will be prompted to use their multi-factor authentication (MFA) process on logins.\n\nEnabling multi-factor authentication is a recommended setting to limit the use of Administrative actions and to prevent intruders from changing settings.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu and select `Azure Active Directory`.\n2. Select `Security`.\n3. Select `Conditional Access`.\n4. Click `+ New policy`.\n5. Enter a name for the policy.\n6. Select `Users or workload identities`.\n7. Under `Include`, select `All users`.\n8. Under `Exclude`, check `Users and groups`.\n9. Select users this policy should not apply to and click `Select`.\n10. Select `Cloud apps or actions`.\n11. Select `Select apps`.\n12. Check the box next to `Microsoft Azure Management` and click `Select`.\n13. Select `Grant`.\n14. Under `Grant access`, check `Require multifactor authentication` and click `Select`.\n15. Set `Enable policy` to `Report-only`.\n16. Click `Create`.\n\nAfter testing the policy in report-only mode, update the `Enable policy` setting from `Report-onl`y to `On`.\n\n### Default Value\n\nMFA is not enabled by default for administrative actions.\n\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1",
      "azure_compliance.benchmark.cis_v200_1_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1/azure_compliance.benchmark.cis_v200_1_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_3",
    "description": "Require administrators or appropriately delegated users to create new tenants.",
    "title": "1.3 Ensure that 'Users can create Azure AD Tenants' is set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.3",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRequire administrators or appropriately delegated users to create new tenants.\n\nIt is recommended to only allow an administrator to create new tenants. This prevent users from creating new Azure AD or Azure AD B2C tenants and ensures that only authorized users are able to do so.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Users`.\n4. Select `User settings`.\n5. Set `Users can create Azure AD Tenants` to `No`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_4",
    "description": "This recommendation extends guest access review by utilizing the Azure AD Privileged Identity Management feature provided in Azure AD Premium P2. Azure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities.",
    "title": "1.4 Ensure Access Review is Set Up for External Users in Azure AD Privileged Identity Management",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.4",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nThis recommendation extends guest access review by utilizing the Azure AD Privileged Identity Management feature provided in Azure AD Premium P2.\n\nAzure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data.\n\nWork with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources a a guest user.\n\n## Remediation\n\n### From Azure Portal\n\n1. From the Azure Portal home page click the portal menu in the top left.\n2. Select `Azure Active Directory`.\n3. Select `Users` in the left column under the `Manage` heading.\n4. Next to the search box select the `filter` option.\n5. Search for and select `User Type`.\n6. In the third drop down `Value` select `Guest`.\n7. Review the guest users in your Active Directory.\n8. For those you wish to delete, select the checkbox on the left then the `Delete` option in the top row.\n\n### From Azure CLI\n\nWith the information from the audit procedure, to remove a Guest user run the following command with their User Principal Value.\n\n```bash\nRemove-AzureADUser -ObjectId \"\u003cUserPrincipalName@emailaddress.com\"\n```\n\n### From Powershell\n\nWith the information from the audit procedure, to remove a Guest user run the following command with their User Principal Value.\n\n```bash\nRemove-AzureADUser -ObjectId \"\u003cUserPrincipalName@emailaddress.com\u003e\"\n```\n\n### Default Value\n\nBy default no guest users are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_5",
    "description": "Azure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data. Work with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources as a guest user. Guest users in every subscription should be review on a regular basis to ensure that inactive and unneeded accounts are removed.",
    "title": "1.5 Ensure Guest Users Are Reviewed on a Regular Basis",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.5",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nAzure AD is extended to include Azure AD B2B collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account and sign in with their own work, school, or social identities. Guest users allow you to share your company's applications and services with users from any other organization, while maintaining control over your own corporate data.\n\nWork with external partners, large or small, even if they don't have Azure AD or an IT department. A simple invitation and redemption process lets partners use their own credentials to access your company's resources as a guest user.\n\nGuest users in every subscription should be review on a regular basis to ensure that inactive and unneeded accounts are removed.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu\n2. Select `Azure Active Directory`\n3. Select `Users`\n4. Click on `Add filter`\n5. Select `User type`\n6. Select `Guest` from the Value drop down\n7. Click `Apply`\n8. Delete all `Guest` users that are no longer required or are inactive\n\n### From Azure CLI\n\nBefore deleting the user, set it to inactive using the ID from the Audit Procedure to determine if there are any dependent systems.\n\n```bash\naz ad user update --id \u003cexampleaccountid@domain.com\u003e --account-enabled {false}\n```\n\nAfter determining that there are no dependent systems delete the user.\n\n```bash\nRemove-AzureADUser -ObjectId \u003cexampleaccountid@domain.com\u003e\n```\n\n### From Azure PowerShell\n\nBefore deleting the user, set it to inactive using the ID from the Audit Procedure to determine if there are any dependent systems.\n\n```bash\nSet-AzureADUser -ObjectId \"\u003cexampleaccountid@domain.com\u003e\" -AccountEnabled false\n```\n\nAfter determining that there are no dependent systems delete the user.\n\n```bash\nPS C:\\\u003eRemove-AzureADUser -ObjectId \u003cexampleaccountid@domain.com\u003e\n```\n\n### Default Value\n\nBy default no guest users are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_6",
    "description": "Ensures that two alternate forms of identification are provided before allowing a password reset.",
    "title": "1.6 Ensure That 'Number of methods required to reset' is set to '2'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.6",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnsures that two alternate forms of identification are provided before allowing a password reset.\n\nA Self-service Password Reset (SSPR) through Azure Multi-factor Authentication (MFA) ensures the user's identity is confirmed using two separate methods of identification. With multiple methods set, an attacker would have to compromise both methods before they could maliciously reset a user's password.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Users`.\n4. Select `Password reset`.\n5. Then `Authentication methods`.\n6. Set the `Number of methods required to reset` to `2`.\n\nPlease **note** that at this point of time, there is no Azure CLI or other API commands available to programmatically conduct security configuration for this recommendation.\n\n### Default Value\n\nBy default, the `Number of methods required to reset` is set to \"2\".\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_7",
    "description": "Microsoft Azure provides a Global Banned Password policy that applies to Azure administrative and normal user accounts. This is not applied to user accounts that are synced from an on-premise Active Directory unless Azure AD Connect is used and you enable EnforceCloudPasswordPolicyForPasswordSyncedUsers. Please see the list in default values on the specifics of this policy. To further password security, it is recommended to further define a custom banned password policy.",
    "title": "1.7 Ensure that a Custom Bad Password List is set to 'Enforce' for your Organization",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.7",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nMicrosoft Azure provides a Global Banned Password policy that applies to Azure administrative and normal user accounts. This is not applied to user accounts that are synced from an on-premise Active Directory unless Azure AD Connect is used and you enable EnforceCloudPasswordPolicyForPasswordSyncedUsers. Please see the list in default values on the specifics of this policy. To further password security, it is recommended to further define a custom banned password policy.\n\nEnabling this gives your organization further customization on what secure passwords are allowed. Setting a bad password list enables your organization to fine-tune its password policy further, depending on your needs. Removing easy-to-guess passwords increases the security of access to your Azure resources.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Security`.\n4. Under `Manage`, select `Authentication Methods`.\n5. Select `Password Protection`.\n6. Set the `Enforce custom list` option to `Yes`.\n7. Double click the custom banned password list to add a string.\n\n### Default Value\n\nBy default the custom bad password list is not 'Enabled'. Organizational-specific terms can be added to the custom banned password list, such as the following examples:\n- Brand names\n- Product names\n- Locations, such as company headquarters\n- Company-specific internal terms\n- Abbreviations that have specific company meaning\n- Months and weekdays with your company's local languages.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_8",
    "description": "Ensure that the number of days before users are asked to re-confirm their authentication information is not set to 0.",
    "title": "1.8 Ensure that 'Number of days before users are asked to re- confirm their authentication information' is not set to '0'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.8",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnsure that the number of days before users are asked to re-confirm their authentication information is not set to 0.\n\nThis setting is necessary if you have setup 'Require users to register when signing in option'. If authentication re-confirmation is disabled, registered users will never be prompted to re-confirm their existing authentication information. If the authentication information for a user changes, such as a phone number or email, then the password reset information for that user reverts to the previously registered authentication information.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Users`.\n4. Select `Password reset`.\n5. Then `Registration`.\n6. Set the `Number of days before users are asked to re-confirm their authentication information` to your organization-defined frequency.\n\n### Default Value\n\nBy default, `the Number of days before users are asked to re-confirm their authentication information` is set to \"180 days\".\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_9",
    "description": "Ensure that users are notified on their primary and secondary emails on password resets.",
    "title": "1.9 Ensure that 'Notify users on password resets?' is set to 'Yes'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.9",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnsure that users are notified on their primary and secondary emails on password resets.\n\nUser notification on password reset is a proactive way of confirming password reset activity. It helps the user to recognize unauthorized password reset activities.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Users`.\n4. Select `Password reset`.\n5. Under Manage, select `Notifications`.\n6. Set `Notify users on password resets?` to `Yes`.\n\n### Default Value\n\nBy default, `Notify users on password resets?` is set to \"Yes\".\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_10",
    "description": "Ensure that all Global Administrators are notified if any other administrator resets their password.",
    "title": "1.10 Ensure That 'Notify all admins when other admins reset their password?' is set to 'Yes'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.10",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nEnsure that all Global Administrators are notified if any other administrator resets their password.\n\nGlobal Administrator accounts are sensitive. Any password reset activity notification, when sent to all Global Administrators, ensures that all Global administrators can passively confirm if such a reset is a common pattern within their group. For example, if all Global Administrators change their password every 30 days, any password reset activity before that may require administrator(s) to evaluate any unusual activity and confirm its origin.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Users`.\n4. Select `Password reset`.\n5. Under Manage, select `Notifications`.\n6. Set `Notify all admins when other admins reset their password?` to `Yes`.\n\n### Default Value\n\nBy default, `Notify all admins when other admins reset their password?` is set to \"No\".",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_11",
    "description": "Require administrators to provide consent for applications before use.",
    "title": "1.11 Ensure 'User consent for applications' is set to 'Do not allow user consent'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.11",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRequire administrators to provide consent for applications before use.\n\nIf Azure Active Directory is running as an identity provider for third-party applications, permissions and consent should be limited to administrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Enterprise Applications`.\n4. Select `Consent and permissions`.\n5. Select `User consent settings`.\n6. Set `User consent for applications` to `Do not allow user consent`.\n7. Click save\n\n### Default Value\n\nBy default, `Users consent for applications` is set to `Allow user consent for apps`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_12",
    "description": "Allow users to provide consent for selected permissions when a request is coming from a verified publisher.",
    "title": "1.12 Ensure 'User consent for applications' Is Set To 'Allow for Verified Publishers'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.12",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nAllow users to provide consent for selected permissions when a request is coming from a verified publisher.\n\nIf Azure Active Directory is running as an identity provider for third-party applications, permissions and consent should be limited to administrators or pre-approved. Malicious applications may attempt to exfiltrate data or abuse privileged user accounts.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Enterprise Applications`.\n4. Select `Consent and permissions`.\n5. Select `User consent settings`.\n6. Under `User consent for applications`, select `Allow user consent for apps from verified publishers, for selected permissions`.\n7. Select `Save`.\n\n### From PowerShell\n\n```bash\nConnect-MsolService\nSet-MsolCompanyInformation --UsersPermissionToUserConsentToAppEnabled $False\n```\n\n### Default Value\n\nBy default, `User consent for applications` is set to `Allow user consent for apps`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_13",
    "description": "Require administrators to provide consent for the apps before use.",
    "title": "1.13 Ensure that 'Users can add gallery apps to My Apps' is set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.13",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRequire administrators to provide consent for the apps before use.\n\nUnless Azure Active Directory is running as an identity provider for third-party applications, do not allow users to use their identity outside of your cloud environment. User profiles contain private information such as phone numbers and email addresses which could then be sold off to other third parties without requiring any further consent from the user.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Users`.\n4. Select `User settings`.\n5. Then `Manage how end users launch and view their applications`.\n6. Set `Users can add gallery apps to My Apps` to `No`.\n\n### Default Value\n\nBy default, `Users can add gallery apps to My Apps` is set to `No`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_14",
    "description": "Require administrators or appropriately delegated users to register third-party applications.",
    "title": "1.14 Ensure That 'Users Can Register Applications' Is Set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.14",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRequire administrators or appropriately delegated users to register third-party applications.\n\nIt is recommended to only allow an administrator to register custom-developed applications. This ensures that the application undergoes a formal security review and approval process prior to exposing Azure Active Directory data. Certain users like developers or other high-request users may also be delegated permissions to prevent them from waiting on an administrative user. Your organization should review your policies and decide your needs.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Users`.\n4. Select `User settings`.\n5. Set `Users can register applications` to `No`.\n\n### From Powershell\n\n```bash\nConnect-MsolService\nSet-MsolCompanyInformation -UsersPermissionToCreateLOBAppsEnabled $False\n```\n\n### Default Value\n\nBy default, `Users can register applications` is set to \"Yes\".\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_15",
    "description": "Limit guest user permissions.",
    "title": "1.15 Ensure That 'Guest users access restrictions' is set to 'Guest user access is restricted to properties and memberships of their own directory objects'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.15",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nLimit guest user permissions.\n\nLimiting guest access ensures that guest accounts do not have permission for certain directory tasks, such as enumerating users, groups or other directory resources, and cannot be assigned to administrative roles in your directory. Guest access has three levels of restriction.\n\n1. Guest users have the same access as members (most inclusive),\n2. Guest users have limited access to properties and memberships of directory objects (default value),\n3. Guest user access is restricted to properties and memberships of their own directory objects (most restrictive).\n\nThe recommended option is the 3rd, most restrictive: \"Guest user access is restricted to their own directory object\".\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `External Identities`.\n4. Select `External collaboration settings`.\n5. Under `Guest user access`, change `Guest user access restrictions` to be `Guest user access is restricted to properties and memberships of their own directory objects`.\n\n### From Powershell\n\n1. From a PowerShell session enter `Set-AzureADMSAuthorizationPolicy- GuestUserRoleId '2af84b1e-32c8-42b7-82bc-daa82404023b'`\n2. Check that the setting was applied by entering `Get- AzureADMSAuthorizationPolicy`\n3. Make certain that the GuestUserRoleId is equal to the earlier entered value of 2af84b1e-32c8-42b7-82bc-daa82404023b.\n\n### Default Value\n\nBy default, `Guest user access restrictions` is set to `Guest user access is restricted to properties and memberships of their own directory objects`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_16",
    "description": "Restrict invitations to users with specific administrative roles only.",
    "title": "1.16 Ensure that 'Guest invite restrictions' is set to 'Only users assigned to specific admin roles can invite guest users'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.16",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestrict invitations to users with specific administrative roles only.\n\nRestricting invitations to users with specific administrator roles ensures that only authorized accounts have access to cloud resources. This helps to maintain \"Need to Know\" permissions and prevents inadvertent access to data.\n\nBy default the setting Guest invite restrictions is set to Anyone in the organization can invite guest users including guests and non-admins. This would allow anyone within the organization to invite guests and non-admins to the tenant, posing a security risk.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `External Identities`.\n4. Select `External collaboration settings`.\n5. Under `Guest invite settings`, for `Guest invite restrictions`, ensure that `Only users assigned to specific admin roles can invite guest users` is selected.\n\n### Default Value\n\nBy default, `Guest invite restrictions` is set to `Anyone in the organization can invite guest users including guests and non-admins`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_17",
    "description": "Restrict access to the Azure AD administration portal to administrators only.",
    "title": "1.17 Ensure That 'Restrict access to Azure AD administration portal' is Set to 'Yes'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.17",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestrict access to the Azure AD administration portal to administrators only.\n\n**NOTE:** This only affects access to the Azure AD administrator's web portal. This setting does not prohibit privileged users from using other methods such as Rest API or Powershell to obtain sensitive information from Azure AD.\n\nThe Azure AD administrative portal has sensitive data and permission settings. All non- administrators should be prohibited from accessing any Azure AD data in the administration portal to avoid exposure.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Users`.\n4. Select `User settings`.\n5. Set `Restrict access to Azure AD administration portal` to `Yes`.\n\n### Default Value\n\nBy default, `Restrict access to Azure AD administration portal` is set to `No`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_18",
    "description": "Restricts group creation to administrators with permissions only.",
    "title": "1.18 Ensure that 'Restrict user ability to access groups features in the Access Pane' is Set to 'Yes'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.18",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestricts group creation to administrators with permissions only.\n\nSelf-service group management enables users to create and manage security groups or Office 365 groups in Azure Active Directory (Azure AD). Unless a business requires this day-to-day delegation for some users, self-service group management should be disabled.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Groups`.\n4. Select `General` under `Settings`.\n5. Ensure that `Restrict user ability to access groups features in the Access Panel` is set to `Yes`.\n\n### Default Value\n\nBy default, `Restrict user ability to access groups features in the Access Pane` is set to `No`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_19",
    "description": "Restrict security group creation to administrators only.",
    "title": "1.19 Ensure that 'Users can create security groups in Azure portals, API or PowerShell' is set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.19",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestrict security group creation to administrators only.\n\nWhen creating security groups is enabled, all users in the directory are allowed to create new security groups and add members to those groups. Unless a business requires this day-to-day delegation, security group creation should be restricted to administrators only.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Groups`.\n4. Select `General under Settings`.\n5. Set `Users can create security groups in Azure portals, API or PowerShell` to `No`.\n\n### Default Value\n\nBy default, `Users can create security groups in Azure portals, API or PowerShell` is set to `Yes`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_20",
    "description": "Restrict security group management to administrators only.",
    "title": "1.20 Ensure that 'Owners can manage group membership requests in the Access Panel' is set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.20",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestrict security group management to administrators only.\n\nRestricting security group management to administrators only prohibits users from making changes to security groups. This ensures that security groups are appropriately managed and their management is not delegated to non-administrators.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Groups`.\n4. Select `General` in `settings`.\n5. Set `Owners can manage group membership requests in the Access Panel` to `No`.\n\n### Default Value\n\nBy default, `Owners can manage group membership requests in the Access Panel` is set to `No`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_21",
    "description": "Restrict Microsoft 365 group creation to administrators only.",
    "title": "1.21 Ensure that 'Users can create Microsoft 365 groups in Azure portals, API or PowerShell' is set to 'No'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.21",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nRestrict Microsoft 365 group creation to administrators only.\n\nRestricting Microsoft 365 group creation to administrators only ensures that creation of Microsoft 365 groups is controlled by the administrator. Appropriate groups should be created and managed by the administrator and group creation rights should not be delegated to any other user.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Then `Groups`.\n4. Select `General` in `settings`.\n5. Set `Users can create Microsoft 365 groups in Azure portals, API or PowerShell` to `No`.\n\n### Default Value\n\nBy default, `Users can create Microsoft 365 groups in Azure portals, API or PowerShell` is set to `Yes`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_22",
    "description": "Joining or registering devices to the active directory should require Multi-factor authentication.",
    "title": "1.22 Ensure that 'Require Multi-Factor Authentication to register or join devices with Azure AD' is set to 'Yes'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.22",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nJoining or registering devices to the active directory should require Multi-factor authentication.\n\nMulti-factor authentication is recommended when adding devices to Azure AD. When set to Yes, users who are adding devices from the internet must first use the second method of authentication before their device is successfully added to the directory. This ensures that rogue devices are not added to the domain using a compromised user account. Note: Some Microsoft documentation suggests to use conditional access policies for joining a domain from certain whitelisted networks or devices. Even with these in place, using Multi-Factor Authentication is still recommended, as it creates a process for review before joining the domain.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Active Directory`.\n3. Select `Devices`.\n4. Select `Device settings`.\n5. Set `Require Multi-Factor Authentication to register or join devices with Azure AD` to `Yes`.\n\n### Default Value\n\nBy default, `Require Multi-Factor Authentication to register or join devices with Azure AD` is set to `No`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_23",
    "description": "The principle of least privilege should be followed and only necessary privileges should be assigned instead of allowing full administrative access.",
    "title": "1.23 Ensure That No Custom Subscription Administrator Roles Exist",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.23",
      "cis_level": "1",
      "cis_section_id": "1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nThe principle of least privilege should be followed and only necessary privileges should be assigned instead of allowing full administrative access.\n\nClassic subscription admin roles offer basic access management and include Account Administrator, Service Administrator, and Co-Administrators. It is recommended the least necessary permissions be given initially. Permissions can be added as needed by the account holder. This ensures the account holder cannot perform actions which were not intended.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Subscriptions`.\n3. Select `Access control (IAM)`.\n4. Select `Roles`.\n5. Click `Type` and select `CustomRole` from the drop down menu.\n6. Check the box next to each role which grants subscription administrator privileges.\n7. Select `Remove`.\n8. Select `Yes`.\n\n### From Azure CLI\n\nList custom roles:\n\n```bash\naz role definition list --custom-role-only True\n```\nCheck for entries with `assignableScope` of / or the `subscription`, and an action of `*`. To remove a violating role:\n\n```bash\naz role definition delete --name \u003crole name\u003e\n```\n\n**Note** that any role assignments must be removed before a custom role can be deleted. Ensure impact is assessed before deleting a custom role granting subscription administrator privileges.\n\n### Default Value\n\nBy default, no custom owner roles are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_24",
    "description": "Resource locking is a powerful protection mechanism that can prevent inadvertent modification/deletion of resources within Azure subscriptions/Resource Groups and is a recommended NIST configuration.",
    "title": "1.24 Ensure a Custom Role is Assigned Permissions for Administering Resource Locks",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.24",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nResource locking is a powerful protection mechanism that can prevent inadvertent modification/deletion of resources within Azure subscriptions/Resource Groups and is a recommended NIST configuration.\n\nGiven the resource lock functionality is outside of standard Role Based Access Control(RBAC), it would be prudent to create a resource lock administrator role to prevent inadvertent unlocking of resources.\n\n## Remediation\n\n### From Azure Portal\n\n1. In the Azure portal, open a subscription or resource group where you want the custom role to be assigned.\n2. `Select Access control (IAM).`\n3. Click `Add`.\n4. Select `Add custom role`.\n5. In the `Custom Role Name` field enter `Resource Lock Administrator`.\n6. In the Description field enter `Can Administer Resource Locks`.\n7. For Baseline permissions select `Start from scratch`\n8. Select `next`.\n9. In the Permissions tab select `Add permissions`.\n10. In the Search for a permission box, type in `Microsoft.Authorization/locks` to search for permissions.\n11. Select the check box next to the permission `Microsoft.Authorization/locks`.\n12. Select `Add`.\n13. Select `Review + create`.\n14. Select `Create`.\n15. Assign the newly created role to the appropriate user.\n\n### From PowerShell:\n\nBelow is a power shell definition for a resource lock administrator role created at an Azure Management group level\n\n```bash\nImport-Module Az.Accounts\nConnect-AzAccount\n\n$role = Get-AzRoleDefinition \"User Access Administrator\" $role.Id = $null\n$role.Name = \"Resource Lock Administrator\" $role.Description = \"Can Administer Resource Locks\" $role.Actions.Clear() $role.Actions.Add(\"Microsoft.Authorization/locks/*\") $role.AssignableScopes.Clear()\n\n* Scope at the Management group level Management group\n\n$role.AssignableScopes.Add(\"/providers/Microsoft.Management/managementGroups/ MG-Name\")\n\nNew-AzRoleDefinition -Role $role Get-AzureRmRoleDefinition \"Resource Lock Administrator\"\n```\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 1 Identity and Access Management",
    "category_hierarchy": [
      "CIS v2.0.0",
      "1 Identity and Access Management"
    ],
    "control_id": "azure_compliance.control.cis_v200_1_25",
    "description": "Users who are set as subscription owners are able to make administrative changes to the subscriptions and move them into and out of Azure Active Directories.",
    "title": "1.25 Ensure That 'Subscription Entering AAD Directory' and 'Subscription Leaving AAD Directory' Is Set To 'Permit No One'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "1.25",
      "cis_level": "2",
      "cis_section_id": "1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/ActiveDirectory"
    },
    "documentation": "## Description\n\nUsers who are set as subscription owners are able to make administrative changes to the subscriptions and move them into and out of Azure Active Directories.\n\nPermissions to move subscriptions in and out of Azure Active Directory must only be given to appropriate administrative personnel. A subscription that is moved into an Azure Active Directory may be within a folder to which other users have elevated permissions. This prevents loss of data or unapproved changes of the objects within by potential bad actors.\n\n## Remediation\n\n### From Azure Portal\n\n1. From the Azure Portal Home select the portal menu.\n2. Select `Subscriptions`.\n3. Select `Manage Policies`.\n4. Under `Subscription leaving AAD directory` and `Subscription entering AAD directory` select `Permit no one`.\n\n### Default Value\n\nBy default `Subscription leaving AAD director`y and `Subscription entering AA`D are set to `Allow everyone (default)`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_1",
    "description": "Turning on Microsoft Defender for Servers enables threat detection for Servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.1 Ensure That Microsoft Defender for Servers Is Set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.1",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Servers enables threat detection for Servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Servers allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings`.\n3. Click on the subscription name.\n4. Select `Defender plans`.\n5. Set `Server` Status to `On`.\n6. Select `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n VirtualMachines --tier 'standard'\n```\n\n### From Powershell\n\nRun the following command:\n\n```bash\nSet-AzSecurityPricing -Name 'VirtualMachines' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_2",
    "description": "Turning on Microsoft Defender for App Service enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.2 Ensure That Microsoft Defender for App Services Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.2",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for App Service enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for App Service allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings`.\n3. Click on the subscription name.\n4. Select `Defender plans`.\n5. Set `App Service` Status to `On`.\n6. Select `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n Appservices --tier 'standard'\n```\n\n### From Powershell\n\nRun the following command:\n\n```bash\nSet-AzSecurityPricing -Name \"AppServices\" -PricingTier \"Standard\"\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_3",
    "description": "Turning on Microsoft Defender for Databases enables threat detection for the instances running your database software. This provides threat intelligence, anomaly detection, and behavior analytics in the Azure Microsoft Defender for Cloud. Instead of being enabled on services like Platform as a Service (PaaS), this implementation will run within your instances as Infrastructure as a Service (IaaS) on the Operating Systems hosting your databases.",
    "title": "2.1.3 Ensure That Microsoft Defender for Databases Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.3",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Databases enables threat detection for the instances running your database software. This provides threat intelligence, anomaly detection, and behavior analytics in the Azure Microsoft Defender for Cloud. Instead of being enabled on services like Platform as a Service (PaaS), this implementation will run within your instances as Infrastructure as a Service (IaaS) on the Operating Systems hosting your databases.\n\nEnabling Microsoft Defender for Azure SQL Databases allows your organization more granular control of the infrastructure running your database software. Instead of waiting on Microsoft release updates or other similar processes, you can manage them yourself. Threat detection is provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings`.\n3. Click on the subscription name.\n4. Select `Defender plans`.\n5. Set `Databases Status` to `On`.\n6. Select `Save`.\n\nReview the chosen pricing tier. For the `Azure Databases` resource review the different plan information and choose one that fits the needs of your organization.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n 'SqlServers' --tier 'Standard'\naz security pricing create -n 'SqlServerVirtualMachines' --tier 'Standard'\naz security pricing create -n 'OpenSourceRelationalDatabases' --tier 'Standard'\naz security pricing create -n 'CosmosDbs' --tier 'Standard'\n```\n\n### From Azure PowerShell\n\nRun the following command:\n\n```bash\nSet-AzSecurityPricing -Name 'SqlServers' -PricingTier 'Standard'\nSet-AzSecurityPricing -Name 'SqlServerVirtualMachines' -PricingTier 'Standard'\nSet-AzSecurityPricing -Name 'OpenSourceRelationalDatabases' -PricingTier 'Standard'\nSet-AzSecurityPricing -Name 'CosmosDbs' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender Plans are off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_4",
    "description": "Turning on Microsoft Defender for Azure SQL Databases enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.4 Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.4",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Azure SQL Databases enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Azure SQL Databases allows for greater defense-in- depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans `blade.\n5. Click `Select types` \u003e in the row for `Databases`.\n6. Set the radio button next to `Azure SQL Databases` to `On`.\n7. Select `Continue`.\n8. Select `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n SqlServers --tier 'standard'az security pricing create -n SqlServers --tier 'standard'\n```\n\n### From Powershell\n\nRun the following command:\n\n```bash\nSet-AzSecurityPricing -Name 'SqlServers' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_5",
    "description": "Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.5 Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.5",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for SQL servers on machines allows for greater defense- in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Click `Select types` \u003e in the row for `Databases`.\n6. Set the radio button next to `SQL servers on machines` to `On`.\n7. Select `Continue`.\n8. Select `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n SqlServerVirtualMachines --tier 'standard'\n```\n\n### From Powershell\n\nRun the following command:\n\n```bash\nSet-AzSecurityPricing -Name 'SqlServerVirtualMachines' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_6",
    "description": "Turning on Microsoft Defender for Open-source relational databases enables threat detection for Open-source relational databases, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.6 Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.6",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Open-source relational databases enables threat detection for Open-source relational databases, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Open-source relational databases allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Click `Select types` \u003e in the row for `Databases`.\n6. Set the radio button next to `Open-source relational databases` to `On`.\n7. Select `Continue`.\n8. Select `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n 'OpenSourceRelationalDatabases' --tier 'standard'\n```\n\n### From Powershell\n\nUse the below command to enable Standard pricing tier for Open-source relational databases\n\n```bash\nset-azsecuritypricing -name \"OpenSourceRelationalDatabases\" -pricingtier \"Standard\"\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_7",
    "description": "Turning on Microsoft Defender for Storage enables threat detection for Storage, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.7 Ensure That Microsoft Defender for Storage Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.7",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Storage enables threat detection for Storage, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Storage allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Set `Status` to `On` for `Storage`.\n6. Select `Save`.\n\n### From Azure CLI\n\nEnsure the output of the below command is Standard\n\n```bash\naz security pricing create -n StorageAccounts --tier 'standard'\n```\n\n### From Powershell\n\n```bash\nSet-AzSecurityPricing -Name 'StorageAccounts' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_8",
    "description": "Turning on Microsoft Defender for Containers enables threat detection for Container Registries including Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.8 Ensure That Microsoft Defender for Containers Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.8",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Containers enables threat detection for Container Registries including Kubernetes, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Container Registries allows for greater defense-in- depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings`.\n3. Click on the subscription name.\n4. Select `Defender plans`.\n5. Set `Status` to `On` for `Containers`.\n6. Click `Save`.\n\n### From Azure CLI\n\n(**Note:** 'ContainerRegistry' has been deprecated and is replaced by 'Containers')\nUse the below command to enable Standard pricing tier for Containers.\n\n```bash\naz security pricing create -n 'Containers' --tier 'standard'\n```\n\n### From Powershell\n\n(**Note:** 'ContainerRegistry' has been deprecated and is replaced by 'Containers')\nUse the below command to enable Standard pricing tier for Containers.\n\n```bash\nSet-AzSecurityPricing -Name 'Containers' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_9",
    "description": "Microsoft Defender for Azure Cosmos DB scans all incoming network requests for threats to your Azure Cosmos DB resources.",
    "title": "2.1.9 Ensure That Microsoft Defender for Azure Cosmos DB Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.9",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nMicrosoft Defender for Azure Cosmos DB scans all incoming network requests for threats to your Azure Cosmos DB resources.\n\nIn scanning Azure Cosmos DB requests within a subscription, requests are compared to a heuristic list of potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. On the Database row click on `Select types \u003e`.\n6. Set the radio button next to `Azure Cosmos DB` to `On`.\n7. Click `Continue`.\n8. Click `Save`.\n\n### From Azure CLI\n\nRun the following command:\n\n```bash\naz security pricing create -n 'CosmosDbs' --tier 'standard'\n```\n\n### From Powershell\n\nUse the below command to enable Standard pricing tier for Azure Cosmos DB\n\n```bash\nSet-AzSecurityPricing -Name 'CosmosDbs' -PricingTier 'Standard\n```\n\n### Default Value\n\nBy default, Microsoft Defender for Azure Cosmos DB is not enabled.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_10",
    "description": "Turning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "title": "2.1.10 Ensure That Microsoft Defender for Key Vault Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.10",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nTurning on Microsoft Defender for Key Vault enables threat detection for Key Vault, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.\n\nEnabling Microsoft Defender for Key Vault allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Select `On` under `Status` for `Key Vault`.\n6. Select `Save`.\n\n### From Azure CLI\n\nEnable Standard pricing tier for Key Vault:\n\n```bash\naz security pricing create -n 'KeyVaults' --tier 'Standard'\n```\n\n### From Powershell\n\nEnable Standard pricing tier for Key Vault:\n\n```bash\nSet-AzSecurityPricing -Name 'KeyVaults' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender plan is off.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_11",
    "description": "Microsoft Defender for DNS scans all network traffic exiting from within a subscription.",
    "title": "2.1.11 Ensure That Microsoft Defender for DNS Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.11",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nMicrosoft Defender for DNS scans all network traffic exiting from within a subscription.\n\nDNS lookups within a subscription are scanned and compared to a dynamic list of websites that might be potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Select `On` under `Status` for `DNS`.\n6. Select `Save`.\n\n### From Azure CLI\n\nEnable Standard pricing tier for DNS:\n\n```bash\naz security pricing create -n 'DNS' --tier 'Standard'\n```\n\n### From Powershell\n\nEnable Standard pricing tier for DNS:\n\n```bash\nSet-AzSecurityPricing -Name 'DNS' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender for DNS is not enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_12",
    "description": "Microsoft Defender for Resource Manager scans incoming administrative requests to change your infrastructure from both CLI and the Azure portal.",
    "title": "2.1.12 Ensure That Microsoft Defender for Resource Manager Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.12",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nMicrosoft Defender for Resource Manager scans incoming administrative requests to change your infrastructure from both CLI and the Azure portal.\n\nScanning resource requests lets you be alerted every time there is suspicious activity in order to prevent a security threat from being introduced.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Microsoft Defender for Cloud`.\n2. Select `Environment Settings` blade.\n3. Click on the subscription name.\n4. Select the `Defender plans` blade.\n5. Select `On` under `Status` for `Resource Manager`.\n6. Select `Save`.\n\n### From Azure CLI\n\nUse the below command to enable Standard pricing tier for Defender for Resource Manager\n\n```bash\naz security pricing create -n 'Arm' --tier 'Standard'\n```\n\n### From PowerShell\n\nUse the below command to enable Standard pricing tier for Defender for Resource Manager\n\n```bash\nSet-AzSecurityPricing -Name 'Arm' -PricingTier 'Standard'\n```\n\n### Default Value\n\nBy default, Microsoft Defender for Resource Manager is not enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_13",
    "description": "Ensure that the latest OS patches for all virtual machines are applied.",
    "title": "2.1.13 Ensure that Microsoft Defender Recommendation for 'Apply system updates' status is 'Completed'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.13",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnsure that the latest OS patches for all virtual machines are applied.\n\nWindows and Linux virtual machines should be kept updated to:\n- Address a specific bug or flaw\n- Improve an OS or application’s general stability\n- Fix a security vulnerability\n\nThe Azure Security Center retrieves a list of available security and critical updates from Windows Update or Windows Server Update Services (WSUS), depending on which service is configured on a Windows VM. The security center also checks for the latest updates in Linux systems. If a VM is missing a system update, the security center will recommend system updates be applied.\n\n## Remediation\n\nFollow Microsoft Azure documentation to apply security patches from the security center. Alternatively, you can employ your own patch assessment and management tool to periodically assess, report, and install the required security patches for your OS.\n\n### Default Value\n\nBy default, patches are not automatically deployed.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_14",
    "description": "None of the settings offered by ASC Default policy should be set to effect Disabled.",
    "title": "2.1.14 Ensure Any of the ASC Default Policy Settings are Not Set to 'Disabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.14",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nNone of the settings offered by ASC Default policy should be set to effect `Disabled`.\n\nA security policy defines the desired configuration of your workloads and helps ensure compliance with company or regulatory security requirements. ASC Default policy is associated with every subscription by default. ASC default policy assignment is a set of security recommendations based on best practices. Enabling recommendations in ASC default policy ensures that Azure security center provides the ability to monitor all of the supported recommendations and optionally allow automated action for a few of the supported recommendations.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Select `Environment Settings`.\n4. Click on a subscription.\n5. Select `Security Policy` in the left column.\n6. Click on `ASC Default` under `Default initiative`.\n7. Ensure `Policy Enforcement` is `Enabled`.\n8. Click on the `Parameters` tab and uncheck `Only show parameters that need input or review`.\n9. For any parameters set to `Disabled` or empty, update to a valid value for the organization.\n10. Click `Save`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_15",
    "description": "Enable automatic provisioning of the monitoring agent to collect security data.",
    "title": "2.1.15 Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.15",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnable automatic provisioning of the monitoring agent to collect security data.\n\nWhen `Log Analytics agent for Azure VMs` is turned on, Microsoft Defender for Cloud provisions the Microsoft Monitoring Agent on all existing supported Azure virtual machines and any new ones that are created. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Select `Environment Settings`.\n4. Select a subscription.\n5. Click on `Settings \u0026 Monitoring`.\n6. Ensure that `Log Analytics agent for Azure VMs` is set to `On`.\n\n### From Azure CLI\n\nUse the below command to set `Automatic provisioning of monitoring agent` to `On`.\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\"\nhttps://management.azure.com/subscriptions/subscriptionID/providers/Microsoft .Security/autoProvisioningSettings/default?api-version=2017-08-01-preview - d@\"input.json\"'\n```\n\nWhere `input.json` contains the Request body json data as mentioned below.\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/autoProvi sioningSettings/default\",\n  \"name\": \"default\",\n  \"type\": \"Microsoft.Security/autoProvisioningSettings\",\n  \"properties\": {\n    \"autoProvision\": \"On\"\n  }\n}\n```\n\n### Default Value\n\nBy default, `Automatic provisioning of monitoring agent` is set to `On`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_16",
    "description": "Enable automatic provisioning of vulnerability assessment for machines on both Azure and hybrid (Arc enabled) machines.",
    "title": "2.1.16 Ensure that Auto provisioning of 'Vulnerability assessment for machines' is Set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.16",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnable automatic provisioning of vulnerability assessment for machines on both Azure and hybrid (Arc enabled) machines.\n\nVulnerability assessment for machines scans for various security-related configurations and events such as system updates, OS vulnerabilities, and endpoint protection, then produces alerts on threat and vulnerability findings.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Then `Environment Settings`.\n4. Select a subscription.\n5. Click on `Settings \u0026 Monitoring`.\n6. Ensure that `Vulnerability assessment for machines` is set to `On`.\n\nRepeat the above for any additional subscriptions.\n\n### Default Value\n\nBy default, `Automatic provisioning of monitoring agent` is set to `Off`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_17",
    "description": "Enable automatic provisioning of the Microsoft Defender for Containers components.",
    "title": "2.1.17 Ensure that Auto provisioning of 'Microsoft Defender for Containers components' is Set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.17",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnable automatic provisioning of the Microsoft Defender for Containers components.\n\nAs with any compute resource, Container environments require hardening and run-time protection to ensure safe operations and detection of threats and vulnerabilities.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Then `Environment Settings`.\n4. Select a subscription.\n5. Then `Auto Provisioning` in the left column.\n6. Set `Microsoft Defender for Containers components` to `On`.\n\nRepeat the above for any additional subscriptions.\n\n### Default Value\n\nBy default, Microsoft Defender for Containers is disabled. If Defender for Containers is enabled from the Microsoft Defender for Cloud portal, auto provisioning will be enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_18",
    "description": "Enable security alert emails to subscription owners.",
    "title": "2.1.18 Ensure That 'All users with the following roles' is set to 'Owner'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.18",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnable security alert emails to subscription owners.\n\nEnabling security alert emails to subscription owners ensures that they receive security alert emails from Microsoft. This ensures that they are aware of any potential security issues and can mitigate the risk in a timely fashion.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Click on `Environment Settings`.\n4. Click on the appropriate Management Group, Subscription, or Workspace.\n5. Click on `Email notifications`.\n6. In the drop down of the `All users with the following roles` field select `Owner`.\n7. Click `Save`.\n\n### From Azure CLI\n\nUse the below command to set `Send email also to subscription owners` to `On`.\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\"\nhttps://management.azure.com/subscriptions/$0/providers/Microsoft.Security/se curityContacts/default1?api-version=2017-08-01-preview -d@\"input.json\"'\n```\n\nWhere `input.json` contains the data below, replacing `validEmailAddress` with a single email address or multiple comma-separated email addresses:\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/securityC ontacts/default1\",\n  \"name\": \"default1\",\n  \"type\": \"Microsoft.Security/securityContacts\",\n  \"properties\": {\n    \"email\": \"\u003cvalidEmailAddress\u003e\",\n    \"alertNotifications\": \"On\",\n    \"alertsToAdmins\": \"On\",\n    \"notificationsByRole\": \"Owner\"\n  }\n}\n```\n\n### Default Value\n\nBy default, `Owner` is selected.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_19",
    "description": "Microsoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.",
    "title": "2.1.19 Ensure 'Additional email addresses' is Configured with a Security Contact Email",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.19",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nMicrosoft Defender for Cloud emails the subscription owners whenever a high-severity alert is triggered for their subscription. You should provide a security contact email address as an additional email address.\n\nMicrosoft Defender for Cloud emails the Subscription Owner to notify them about security alerts. Adding your Security Contact's email address to the 'Additional email addresses' field ensures that your organization's Security Team is included in these alerts. This ensures that the proper people are aware of any potential compromise in order to mitigate the risk in a timely fashion.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Click on `Environment Settings`.\n4. Click on the appropriate Management Group, Subscription, or Workspace.\n5. Click on `Email notifications`.\n6. Enter a valid security contact email address (or multiple addresses separated by commas) in the `Additional email addresses` field.\n7. Click `Save`.\n\n### From Azure CLI\n\nUse the below command to set `Security contact emails` to `On`.\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\"\nhttps://management.azure.com/subscriptions/$0/providers/Microsoft.Security/se curityContacts/default?api-version=2020-01-01-preview -d@\"input.json\"'\n```\n\nWhere `input.json` contains the data below, replacing `validEmailAddress` with a single email address or multiple comma-separated email addresses:\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/securityC ontacts/default\",\n  \"name\": \"default\",\n  \"type\": \"Microsoft.Security/securityContacts\",\n  \"properties\": {\n    \"email\": \"\u003cvalidEmailAddress\u003e\",\n    \"alertNotifications\": \"On\",\n    \"alertsToAdmins\": \"On\"\n  }\n}\n```\n\n### Default Value\n\nBy default, there are no additional email addresses entered.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_20",
    "description": "Enables emailing security alerts to the subscription owner or other designated security contact.",
    "title": "2.1.20 Ensure That 'Notify about alerts with the following severity' is Set to 'High'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.20",
      "cis_level": "1",
      "cis_section_id": "2.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nEnables emailing security alerts to the subscription owner or other designated security contact.\n\nEnabling security alert emails ensures that security alert emails are received from Microsoft. This ensures that the right people are aware of any potential security issues and are able to mitigate the risk.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Click on `Environment Settings`.\n4. Click on the appropriate Management Group, Subscription, or Workspace.\n5. Click on `Email notifications`.\n6. Under `Notification types`, check the check box next to `Notify about alerts with the following severity (or higher)`: and select `High` from the drop down menu.\n7. Click `Save`.\n\n### From Azure CLI\n\nUse the below command to set `Send email notification for high severity alerts` to `On`.\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type:\napplication/json\"\nhttps://management.azure.com/subscriptions/\u003c$0\u003e/providers/Microsoft.Security/ securityContacts/default1?api-version=2017-08-01-preview -d@\"input.json\"'\n```\n\nWhere `input.json` contains the data below, replacing `validEmailAddress` with a single email address or multiple comma-separated email addresses:\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/securityC ontacts/default1\",\n  \"name\": \"default1\",\n  \"type\": \"Microsoft.Security/securityContacts\",\n  \"properties\": {\n    \"email\": \"\u003cvalidEmailAddress\u003e\",\n    \"alertNotifications\": \"On\",\n    \"alertsToAdmins\": \"On\"\n  }\n}\n```\n\n### Default Value\n\nBy default, `Notify about alerts with the following severity (or higher)`: is set to `High`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_21",
    "description": "This integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS' - see additional info) to communicate with Microsoft Defender for Cloud.",
    "title": "2.1.21 Ensure that Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.21",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nThis integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS' - see additional info) to communicate with Microsoft Defender for Cloud.\n\nMicrosoft Defender for Cloud offers an additional layer of protection by using Azure Resource Manager events, which is considered to be the control plane for Azure. By analyzing the Azure Resource Manager records, Microsoft Defender for Cloud detects unusual or potentially harmful operations in the Azure subscription environment. Several of the preceding analytics are powered by Microsoft Defender for Cloud Apps. To benefit from these analytics, subscription must have a Cloud App Security license.\n\nMicrosoft Defender for Cloud Apps works only with Standard Tier subscriptions.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Microsoft Defender for Cloud`.\n3. Select `Environment Settings` blade.\n4. Select the subscription.\n5. Select `Integrations`.\n6. Check `Allow Microsoft Defender for Cloud Apps to access my data`.\n7. Select `Save`.\n\n### From Azure CLI\n\nUse the below command to enable Standard pricing tier for Storage Accounts\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\"\nhttps://management.azure.com/subscriptions/\u003csubscription_ID\u003e/providers/Micros oft.Security/settings/MCAS?api-version=2021-06-01 -d@\"input.json\"'\n```\n\nWhere input.json contains the Request body json data as mentioned below.\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/settings/MCAS\",\n  \"kind\": \"DataExportSetting\",\n  \"type\": \"Microsoft.Security/settings\",\n  \"properties\": {\n    \"enabled\": true\n  }\n}\n```\n\n### Default Value\n\nWith Cloud App Security license, these alerts are enabled by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.1 Microsoft Defender for Cloud",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.1 Microsoft Defender for Cloud"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_1_22",
    "description": "This integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP' - see additional info) to communicate with Microsoft Defender for Cloud.",
    "title": "2.1.22 Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is selected",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.1.22",
      "cis_level": "2",
      "cis_section_id": "2.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nThis integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP' - see additional info) to communicate with Microsoft Defender for Cloud.\n\n**IMPORTANT:** When enabling integration between DfE \u0026 DfC it needs to be taken into account that this will have some side effects that may be undesirable.\n\n1. For server 2019 \u0026 above if defender is installed (default for these server SKU's) this will trigger a deployment of the new unified agent and link to any of the extended configuration in the Defender portal.\n2. If the new unified agent is required for server SKU's of Win 2016 or Linux and lower there is additional integration that needs to be switched on and agents need to be aligned.\n\nMicrosoft Defender for Endpoint integration brings comprehensive Endpoint Detection and Response (EDR) capabilities within Microsoft Defender for Cloud. This integration helps to spot abnormalities, as well as detect and respond to advanced attacks on endpoints monitored by Microsoft Defender for Cloud.\n\nMDE works only with Standard Tier subscriptions.\n\n## Remediation\n\n### From Azure Console\n\n1. From Azure Home select the Portal Menu.\n2. Go to `Microsoft Defender for Cloud`.\n3. Select `Environment Settings` blade.\n4. Select the subscription.\n5. Select `Integrations`.\n6. Check `Allow Microsoft Defender for Endpoint to access my data`.\n7. Select `Save`.\n\n### From Azure CLI\n\nUse the below command to enable Standard pricing tier for Storage Accounts\n\n```bash\naz account get-access-token --query\n\"{subscription:subscription,accessToken:accessToken}\" --out tsv | xargs -L1 bash -c 'curl -X PUT -H \"Authorization: Bearer $1\" -H \"Content-Type: application/json\"\nhttps://management.azure.com/subscriptions/\u003csubscriptionID\u003e/providers/Microso ft.Security/settings/WDATP?api-version=2021-06-01 -d@\"input.json\"'\n```\n\nWhere input.json contains the Request body json data as mentioned below.\n\n```bash\n{\n  \"id\":\"/subscriptions/\u003cYour_Subscription_Id\u003e/providers/Microsoft.Security/settings/ WDATP\",\n  \"kind\": \"DataExportSettings\",\n  \"type\": \"Microsoft.Security/settings\",\n  \"properties\": {\n    \"enabled\": true\n  }\n}\n```\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender \u003e 2.2 Microsoft Defender for IoT",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender",
      "2.2 Microsoft Defender for IoT"
    ],
    "control_id": "azure_compliance.control.cis_v200_2_2_1",
    "description": "Microsoft Defender for IoT acts as a central security hub for IoT devices within your organization.",
    "title": "2.2.1 Ensure That Microsoft Defender for IoT Hub Is Set To 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "2.2.1",
      "cis_level": "2",
      "cis_section_id": "2.2",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter"
    },
    "documentation": "## Description\n\nMicrosoft Defender for IoT acts as a central security hub for IoT devices within your organization.\n\nIoT devices are very rarely patched and can be potential attack vectors for enterprise networks. Updating their network configuration to use a central security hub allows for detection of these breaches.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `IoT Hub`.\n2. Select a `IoT Hub` to validate.\n3. Select `Overview` in `Defender for IoT`.\n4. Click on `Secure your IoT solution`, and complete the onboarding.\n\n### Default Value\n\nBy default, Microsoft Defender for IoT is not enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2",
      "azure_compliance.benchmark.cis_v200_2_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2/azure_compliance.benchmark.cis_v200_2_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 2 Microsoft Defender",
    "category_hierarchy": [
      "CIS v2.0.0",
      "2 Microsoft Defender"
    ],
    "control_id": "azure_compliance.benchmark.cis_v200_2_3",
    "description": "",
    "title": "2.3 Microsoft Defender for External Attack Surface Monitoring",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_section_id": "2",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SecurityCenter",
      "type": "Benchmark"
    },
    "documentation": "## Overview\n\nAs more services are exposed to the public internet it is important to be able to monitor the externally exposed surface of your Azure Tenant, to this end it is recommended that tools that monitor this surface are implemented.\n\nMicrosoft have a new tool to do this in their Defender Suite of products. Defender EASM, this tool is configured very simply to scan specified domains and report on them, specific domains and addresses can be excluded from the scan.\n\nTypically these tools will report on any vulnerability that is identified (CVE) and will also identify ports and protocols that are open on devices.\n\nResults are classified Critical/High/Medium \u0026 Low with proposed mitigations.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_1",
    "description": "Enable data encryption in transit.",
    "title": "3.1 Ensure that 'Secure transfer required' is set to 'Enabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.1",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nEnable data encryption in transit.\n\nThe secure transfer option enhances the security of a storage account by only allowing requests to the storage account by a secure connection. For example, when calling REST APIs to access storage accounts, the connection must use HTTPS. Any requests using HTTP will be rejected when 'secure transfer required' is enabled. When using the Azure files service, connection without encryption will fail, including scenarios using SMB 2.1, SMB 3.0 without encryption, and some flavors of the Linux SMB client. Because Azure storage doesn’t support HTTPS for custom domain names, this option is not applied when using a custom domain name.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Storage Accounts`.\n2. For each storage account, go to `Configuration`.\n3. Set `Secure transfer required` to `Enabled`.\n\n### From Azure CLI\n\nUse the below command to enable `Secure transfer required` for a `Storage Account`\n\n```bash\naz storage account update --name \u003cstorageAccountName\u003e --resource-group \u003cresourceGroupName\u003e --https-only true\n```\n\n### Default Value\n\nBy default, `Secure transfer required` is set to `Disabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_2",
    "description": "Enabling encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.",
    "title": "3.2 Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.2",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nEnabling double encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.\n\nAzure Storage automatically encrypts all data in a storage account at the network level using 256-bit AES encryption, which is one of the strongest, FIPS 140-2-compliant block ciphers available. Customers who require higher levels of assurance that their data is secure can also enable 256-bit AES encryption at the Azure Storage infrastructure level for double encryption. Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised. Similarly, data is encrypted even before network transmission and in all backups. In this scenario, the additional layer of encryption continues to protect your data. For the most secure implementation of key based encryption, it is recommended to use a Customer Managed asymmetric RSA 2048 Key in Azure Key Vault.\n\n## Remediation\n\n### From Azure Portal\n\n1. When creating a storage account, proceed as normal, but stop on the `Advanced` tab.\n2. Select `Enabled` next to Infrastructure Encryption.\n\n### From Azure CLI\n\nReplace the information within \u0026lt;\u0026gt; with your values.\n\n```bash\naz storage account create \\\n --name \u003cstorage-account\u003e \\\n --resource-group \u003cresource-group\u003e \\\n --location \u003clocation\u003e \\\n --sku Standard_RAGRS \\\n --kind StorageV2 \\\n --require-infrastructure-encryption\n```\n\n### From Powershell\n\n```bash\nNew-AzStorageAccount -ResourceGroupName \u003cresource_group\u003e `\n -AccountName \u003cstorage-account\u003e `\n -Location \u003clocation\u003e `\n -SkuName \"Standard_RAGRS\" `\n -Kind StorageV2 `\n -RequireInfrastructureEncryption\n```\n\n`Enabling Infrastructure Encryption after Storage Account Creation`\nIf a infrastructure encryption was not enabled on blob storage creation, there is no official way to enable it. Please see the additional information section.\n\n### Default Value\n\nBy default, Infrastructure Encryption is disabled in blob creation.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_3",
    "description": "Access Keys authenticate application access requests to data contained in Storage Accounts. A periodic rotation of these keys is recommended to ensure that potentially compromised keys cannot result in a long-term exploitable credential. The 'Rotation Reminder' is an automatic reminder feature for a manual procedure.",
    "title": "3.3 Ensure that 'Enable key rotation reminders' is enabled for each Storage Account",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.3",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nAccess Keys authenticate application access requests to data contained in Storage Accounts. A periodic rotation of these keys is recommended to ensure that potentially compromised keys cannot result in a long-term exploitable credential. The \"Rotation Reminder\" is an automatic reminder feature for a manual procedure.\n\nReminders such as those generated by this recommendation will help maintain a regular and healthy cadence for activities which improve the overall efficacy of a security program.\n\nCryptographic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.'\n\nFor the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.\n\n## Remediation\n\n### From Azure Portal\n\nop down menu to `Days`.\n1. Go to `Storage Accounts`.\n2. For each Storage Account that is not compliant, go to `Access keys`.\n3. Click `Set rotation reminder`.\n4. Check `Enable key rotation reminders`.\n5. In the `Send reminders` field select `Custom`, then set the `Remind me every` field to `90` and the period drop down to `Days`.\n6. Click `Save`.\n\n### Default Value\n\nBy default, Key rotation reminders is not configured.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_4",
    "description": "For increased security, regenerate storage account access keys periodically.",
    "title": "3.4 Ensure that Storage Account Access Keys are Periodically Regenerated",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.4",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nFor increased security, regenerate storage account access keys periodically.\n\nWhen a storage account is created, Azure generates two 512-bit storage access keys which are used for authentication when the storage account is accessed. Rotating these keys periodically ensures that any inadvertent access or exposure does not result from the compromise of these keys.\n\nCryptographic key rotation periods will vary depending on your organization's security requirements and the type of data which is being stored in the Storage Account. For example, PCI DSS mandates that cryptographic keys be replaced or rotated 'regularly,' and advises that keys for static data stores be rotated every 'few months.'\n\nFor the purposes of this recommendation, 90 days will prescribed for the reminder. Review and adjustment of the 90 day period is recommended, and may even be necessary. Your organization's security requirements should dictate the appropriate setting.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Storage Accounts`.\n2. For each Storage Account with outdated keys, go to `Access keys`.\n3. Click `Rotate key` next to the outdated key, then click `Yes` to the prompt confirming that you want to regenerate the access key.\n\nAfter Azure regenerates the Access Key, you can confirm that `Access keys` reflects a `Last rotated` date of `(0 days ago)`.\n\n### Default Value\n\nBy default, access keys are not regenerated periodically.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_5",
    "description": "The Storage Queue service stores messages that may be read by any client who has access to the storage account. A queue can contain an unlimited number of messages, each of which can be up to 64KB in size using version 2011-08-18 or newer. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account.",
    "title": "3.5 Ensure Storage Logging is Enabled for Queue Service for 'Read', 'Write', and 'Delete' requests",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.5",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nThe Storage Queue service stores messages that may be read by any client who has access to the storage account. A queue can contain an unlimited number of messages, each of which can be up to 64KB in size using version 2011-08-18 or newer. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the queues. Storage Logging log entries contain the following information about individual requests: Timing information such as start time, end-to-end latency, and server latency, authentication details, concurrency information, and the sizes of the request and response messages.\n\nStorage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor individual requests and to diagnose issues with a storage service. Requests are logged on a best-effort basis.\n\nStorage Analytics logging is not enabled by default for your storage account.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Storage Accounts`.\n2. Select the specific Storage Account.\n3. Click the `Diagnostics settings (classic)` blade from `Monitoring (classic)` section.\n4. Set the `Status` to `On`, if set to `Off`.\n5. Select `Queue properties`.\n6. Select `Read`, `Write` and `Delete` options under the `Logging` section to enable Storage Logging for Queue service.\n\n### From Azure CLI\n\nUse the below command to enable the Storage Logging for Queue service.\n\n```bash\naz storage logging update --account-name \u003cstorageAccountName\u003e --account-key \u003cstorageAccountKey\u003e --services q --log rwd --retention 90\n```\n\n### Default Value\n\nBy default storage account queue services are not logged.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_6",
    "description": "Expire shared access signature tokens within an hour.",
    "title": "3.6 Ensure that Shared Access Signature Tokens Expire Within an Hour",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.6",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nExpire shared access signature tokens within an hour.\n\nA shared access signature (SAS) is a URI that grants restricted access rights to Azure Storage resources. A shared access signature can be provided to clients who should not be trusted with the storage account key but for whom it may be necessary to delegate access to certain storage account resources. Providing a shared access signature URI to these clients allows them access to a resource for a specified period of time. This time should be set as low as possible and preferably no longer than an hour.\n\n## Remediation\n\nWhen generating shared access signature tokens, use start and end time such that it falls within an hour.\n\n### From Azure Portal\n\n1. Go to Storage Accounts\n2. For each storage account, go to Shared access signature\n3. Set Start and expiry date/time within an hour\n\n### Default Value\n\nBy default, expiration for shared access signature is set to 8 hours.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_7",
    "description": "Disallowing public access for a storage account overrides the public access settings for individual containers in that storage account.",
    "title": "3.7 Ensure that 'Public access level' is disabled for storage accounts with blob containers",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.7",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nDisallowing public access for a storage account overrides the public access settings for individual containers in that storage account.\n\nThe default configuration for a storage account permits a user with appropriate permissions to configure public (anonymous) access to containers and blobs in a storage account. Keep in mind that public access to a container is always turned off by default and must be explicitly configured to permit anonymous requests. It grants read- only access to these resources without sharing the account key, and without requiring a shared access signature. It is recommended not to provide anonymous access to blob containers until, and unless, it is strongly desired. A shared access signature token or Azure AD RBAC should be used for providing controlled and timed access to blob containers. If no anonymous access is needed on any container in the storage account, it’s recommended to set allowBlobPublicAccess false at the account level, which forbids any container to accept anonymous access in the future.\n\n## Remediation\n\n### From Azure Portal\n\nFirst, follow Microsoft documentation and create shared access signature tokens for your blob containers. Then,\n\n1. Go to `Storage Accounts`.\n2. For each storage account, go to `Networking` in `Security + networking`.\n3. Set `Public Network Access` to `Disabled` if no anonymous access is needed on the storage account.\n\n### From Azure CLI\n\nSet 'Public Network Access' to `Disabled` on the storage account\n\n1. Set 'Allow Blob Public Access' to false on the storage account\n\n```bash\naz storage account update --name \u003cstorage-account\u003e --resource-group \u003cresource-group\u003e --public-network-access Disabled\n```\n\n### From PowerShell\n\nFor each Storage Account, run the following to set the `PublicNetworkAccess` setting to `Disabled`.\n\n```bash\nSet-AzStorageAccount -ResourceGroupName \u003cresource group name\u003e -Name \u003cstorage account name\u003e -PublicNetworkAccess Disabled\n```\n\n### Default Value\n\nBy default, `Public Network Access` is set to `Enabled from all networks` for the Storage Account.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_8",
    "description": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.",
    "title": "3.8 Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.8",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nRestricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access to selected networks, the default action must be changed.\n\nStorage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtual networks, allowing a secure network boundary for specific applications to be built. Access can also be granted to public internet IP address ranges to enable connections from specific internet or on-premises clients. When network rules are configured, only applications from allowed networks can access a storage account. When calling from an allowed network, applications continue to require proper authorization (a valid access key or SAS token) to access the storage account.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `Storage Accounts`.\n2. For each storage account, Click on the `Networking` blade.\n3. Click the `Firewalls and virtual networks` heading.\n4. Ensure that you have elected to `allow access from Selected networks`.\n5. Add rules to allow traffic from specific network.\n6. Click Save to apply your changes.\n\n### From Azure CLI\n\nUse the below command to update `default-action` to `Deny`.\n\n```bash\naz storage account update --name \u003cStorageAccountName\u003e --resource-group \u003cresourceGroupName\u003e --default-action Deny\n```\n\n### Default Value\n\nBy default, Storage Accounts will accept connections from clients on any network.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_9",
    "description": "Some Azure services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Azure services to bypass the network rules. These services will then use strong authentication to access the storage account.",
    "title": "3.9 Ensure 'Allow Azure services on the trusted services list to access this storage account' is Enabled for Storage Account Access",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.9",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nSome Azure services that interact with storage accounts operate from networks that can't be granted access through network rules. To help this type of service work as intended, allow the set of trusted Azure services to bypass the network rules. These services will then use strong authentication to access the storage account. If the Allow trusted Azure services exception is enabled, the following services are granted access to the storage account: Azure Backup, Azure Site Recovery, Azure DevTest Labs, Azure Event Grid, Azure Event Hubs, Azure Networking, Azure Monitor, and Azure SQL Data Warehouse (when registered in the subscription).\n\nTurning on firewall rules for storage account will block access to incoming requests for data, including from other Azure services. We can re-enable this functionality by enabling \"`Trusted Azure Services`\" through networking exceptions.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `Storage Accounts`.\n2. For each storage account, Click on the `Networking` blade.\n3. Click on the `Firewalls and virtual networks` heading.\n4. Ensure that `Enabled from selected virtual networks and IP addresses` is selected.\n5. Under the 'Exceptions' label, enable check box for `Allow Azure services on the trusted services list to access this storage account`.\n6. Click Save to apply your changes.\n\n### From Azure CLI\n\nUse the below command to update `Azure services`.\n\n```bash\naz storage account update --name \u003cStorageAccountName\u003e --resource-group \u003cresourceGroupName\u003e --bypass AzureServices\n```\n\n### Default Value\n\nBy default, Storage Accounts will accept connections from clients on any network.\n\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_10",
    "description": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet.",
    "title": "3.10 Ensure Private Endpoints are used to access Storage Accounts",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.10",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nUse private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.\n\nSecuring traffic between services through encryption protects the data from easy interception and reading.\n\n## Remediation\n\n### From Azure Console\n\n1. Open the `Storage Accounts` blade.\n2. For each list Storage Account, perform the following:\n3. Under the `Security + networking` heading, click on `Networking`.\n4. Click on the `Private Endpoint Connections` tab at the top of the networking window.\n5. Click the `+Private endpoint` button.\n6. In the `1 - Basics` tab/step:\n   - `Enter a name` that will be easily recognizable as associated with the Storage Account (Note: The \"Network Interface Name\" will be automatically completed, but you can customize it if needed.)\n   - Ensure that the `Region` matches the region of the Storage Account.\n   - Click `Next`.\n7. In the `2 - Resource` tab/step:\n   - Select the `target sub-resource` based on what type of storage resource is being made available.\n   - Click `Next`.\n8. In the `3 - Virtual Network` tab/step:\n   - Select the `Virtual network` that your Storage Account will be connecting to.\n   - Select the `Subnet` that your Storage Account will be connecting to.\n   - (Optional) Select other network settings as appropriate for your environment.\n   - Click `Next`.\n9. In the `4 - DNS` tab/step:\n   - (Optional) Select other DNS settings as appropriate for your environment\n   - Click `Next`.\n10. In the `5 - Tags` tab/step:\n    - (Optional) Set any tags that are relevant to your organization.\n    - Click `Next`.\n11. In the `6 - Review + create` tab/step:\n    - A validation attempt will be made and after a few moments it should indicate `Validation Passed` - if it does not pass, double-check your settings before beginning more in depth troubleshooting.\n    - If validation has passed, click `Create` then wait for a few minutes for the scripted deployment to complete.\n\nRepeat the above procedure for each Private Endpoint required within every Storage Account.\n\n### From PowerShell\n\n```bash\n$storageAccount = Get-AzStorageAccount -ResourceGroupName '\n\u003cResourceGroupName\u003e' -Name '\u003cstorageaccountname\u003e'\n\n\n$privateEndpointConnection = @{\n   Name = 'connectionName'\n   PrivateLinkServiceId = $storageAccount.Id\n   GroupID = \"blob|blob_secondary|file|file_secondary|table|table_secondary|queue|queue_se condary|web|web_secondary|dfs|dfs_secondary\"\n}\n\n$privateLinkServiceConnection = New-AzPrivateLinkServiceConnection @privateEndpointConnection\n\n$virtualNetDetails = Get-AzVirtualNetwork -ResourceGroupName '\n\u003cResourceGroupName\u003e' -Name '\u003cname\u003e'\n\n\n$privateEndpoint = @{\n   ResourceGroupName = '\u003cResourceGroupName\u003e'\n   Name = '\u003cPrivateEndpointName\u003e'\n   Location = '\u003clocation\u003e'\n   Subnet = $virtualNetDetails.Subnets[0]\n   PrivateLinkServiceConnection = $privateLinkServiceConnection\n}\nNew-AzPrivateEndpoint @privateEndpoint\n```\n\n### From Azure CLI\n\n```bash\naz network private-endpoint create --resource-group \u003cResourceGroupName -- location \u003clocation\u003e --name \u003cprivate endpoint name\u003e --vnet-name \u003cVNET Name\u003e -- subnet \u003csubnet name\u003e --private-connection-resource-id \u003cstorage account ID\u003e -- connection-name \u003cprivate link service connection name\u003e --group-id \u003cblob|blob_secondary|file|file_secondary|table|table_secondary|queue|queue_se condary|web|web_secondary|dfs|dfs_secondary\u003e\n```\n\n### Default Value\n\nBy default, Private Endpoints are not created for Storage Accounts.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_11",
    "description": "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.",
    "title": "3.11 Ensure Soft Delete is Enabled for Azure Containers and Blob Storage",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.11",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nThe Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.\n\nIt is recommended that both Azure Containers with attached Blob Storage and standalone containers with Blob Storage be made recoverable by enabling the **soft delete** configuration. This is to save and recover data when blobs or blob snapshots are deleted.\n\nContainers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the \"Retention policies,\" ranging from 7 days to 365 days.\n\n## Remediation\n\n### From Azure Portal\n\n1. From the Azure home page, open the hamburger menu in the top left or click on the arrow pointing right with 'More services' underneath.\n2. Select Storage.\n3. Select Storage Accounts.\n4. For each Storage Account, navigate to Data protection in the left scroll column.\n5. Check soft delete for both blobs and containers. Set the retention period to a sufficient length for your organization.\n\n### From Azure CLI\n\nUpdate blob storage retention days in below command\n\n```bash\naz storage blob service-properties delete-policy update --days-retained \u003cRetentionDaysValue\u003e --account-name \u003cStorageAccountName\u003e --account-key \u003cAccountKey\u003e --enable true\n```\n\nUpdate container retention with the below command\n\n```bash\naz storage account blob-service-properties update\n    --enable-container-delete-retention true\n    --container-delete-retention-days \u003cdays\u003e\n    --account-name \u003cstorage-account\u003e\n    --resource-group \u003cresource_group\u003e\n    --account-key \u003cAccountKey\u003e\n```\n\n### Default Value\n\nWhen a new storage account is created, soft delete for containers and blob storage is by default **disabled**.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_12",
    "description": "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.",
    "title": "3.12 Ensure Storage for Critical Data are Encrypted with Customer Managed Keys",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.12",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nEnable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.\n\nBy default, data in the storage account is encrypted using Microsoft Managed Keys at rest. All Azure Storage resources are encrypted, including blobs, disks, files, queues, and tables. All object metadata is also encrypted. If you want to control and manage this encryption key yourself, however, you can specify a customer-managed key. That key is used to protect and control access to the key that encrypts your data. You can also choose to automatically update the key version used for Azure Storage encryption whenever a new version is available in the associated Key Vault.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Storage Accounts`.\n2. For each storage account, go to `Encryption`.\n3. Set Customer Managed Keys.\n4. Select the Encryption key and enter the appropriate setting value.\n5. Click `Save`.\n\n### Default Value\n\nBy default, Encryption type is set to Microsoft Managed Keys.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_13",
    "description": "The Storage Blob service provides scalable, cost-efficient object storage in the cloud. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the blobs. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.",
    "title": "3.13 Ensure Storage logging is Enabled for Blob Service for 'Read', 'Write', and 'Delete' requests",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.13",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nThe Storage Blob service provides scalable, cost-efficient object storage in the cloud. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the blobs. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.\n\nStorage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor each individual request to a storage service for increased security or diagnostics. Requests are logged on a best- effort basis.\n\nStorage Analytics logging is not enabled by default for your storage account.\n\n## Remediation\n\n### From Azure Portal\n\n1. From the default portal page select `Storage Accounts`.\n2. Select the specific Storage Account.\n3. Click the `Diagnostics settings` under the `Monitoring` section in the left column.\n4. Select the 'blob' tab indented below the storage account.\n5. Click '+ Add diagnostic setting'.\n6. Select `StorageRead`, `StorageWrite` and `StorageDelete` options under the `Logging` section to enable Storage Logging for Blob service.\n7. Select a destination for your logs to be sent to.\n\n### From Azure CLI\n\nUse the below command to enable the Storage Logging for Blob service.\n\n```bash\naz storage logging update --account-name \u003cstorageAccountName\u003e --account-key \u003cstorageAccountKey\u003e --services b --log rwd --retention 90\n```\n\n### Default Value\n\nBy default, storage account blob service logging is disabled for read, write, and delete operations.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_14",
    "description": "Azure Table storage is a service that stores structured NoSQL data in the cloud, providing a key/attribute store with a schema-less design. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the tables. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.",
    "title": "3.14 Ensure Storage Logging is Enabled for Table Service for 'Read', 'Write', and 'Delete' Requests",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.14",
      "cis_level": "2",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nAzure Table storage is a service that stores structured NoSQL data in the cloud, providing a key/attribute store with a schema-less design. Storage Logging happens server-side and allows details for both successful and failed requests to be recorded in the storage account. These logs allow users to see the details of read, write, and delete operations against the tables. Storage Logging log entries contain the following information about individual requests: timing information such as start time, end-to-end latency, and server latency; authentication details; concurrency information; and the sizes of the request and response messages.\n\nStorage Analytics logs contain detailed information about successful and failed requests to a storage service. This information can be used to monitor each individual request to a storage service for increased security or diagnostics. Requests are logged on a best- effort basis.\n\nStorage Analytics logging is not enabled by default for your storage account.\n\n## Remediation\n\n### From Azure Portal\n\n1. From the default portal page select `Storage Accounts`.\n2. Select the specific Storage Account.\n3. Click the `Diagnostics settings` under the `Monitoring` section in the left column.\n4. Select the 'table' tab indented below the storage account.\n5. Click '+ Add diagnostic setting'.\n6. Select `StorageRead`, `StorageWrite` and `StorageDelete` options under the `Logging` section to enable Storage Logging for Table service.\n7. Select a destination for your logs to be sent to.\n\n### From Azure CLI\n\nUse the below command to enable the Storage Logging for Table service.\n\n```bash\naz storage logging update --account-name \u003cstorageAccountName\u003e --account-key \u003cstorageAccountKey\u003e --services t --log rwd --retention 90\n```\n\n### Default Value\n\nBy default, storage account table service logging is disabled for read, write, an delete operations\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 3 Storage Accounts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "3 Storage Accounts"
    ],
    "control_id": "azure_compliance.control.cis_v200_3_15",
    "description": "In some cases, Azure Storage sets the minimum TLS version to be version 1.0 by default. TLS 1.0 is a legacy version and has known vulnerabilities. This minimum TLS version can be configured to be later protocols such as TLS 1.2.",
    "title": "3.15 Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "3.15",
      "cis_level": "1",
      "cis_section_id": "3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Storage"
    },
    "documentation": "## Description\n\nIn some cases, Azure Storage sets the minimum TLS version to be version 1.0 by default. TLS 1.0 is a legacy version and has known vulnerabilities. This minimum TLS version can be configured to be later protocols such as TLS 1.2.\n\nTLS 1.0 has known vulnerabilities and has been replaced by later versions of the TLS protocol. Continued use of this legacy protocol affects the security of data in transit.\n\n## Remediation\n\n### From Azure Console\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `Storage Accounts`.\n3. Click on each Storage Account.\n4. Under `Setting` section, Click on `Configuration`.\n5. Set the `minimum TLS version` to be Version 1.2.\n\n### From Azure CLI\n\n```bash\naz storage account update \\\n--name \u003cstorage-account\u003e \\\n--resource-group \u003cresource-group\u003e \\\n--min-tls-version TLS1_2\n```\n\n### From Azure Powershell\n\nTo set the minimum TLS version, run the following command:\n\n```bash\nSet-AzStorageAccount -AccountName \u003cSTORAGEACCOUNTNAME\u003e `\n-ResourceGroupName \u003cRESOURCEGROUPNAME\u003e `\n-MinimumTlsVersion TLS1_2\n```\n\n### Default Value\n\nIf a storage account is created through the portal, the MinimumTlsVersion property for that storage account will be set to TLS 1.2.\n\nIf a storage account is created through PowerShell or CLI, the MinimumTlsVersion property for that storage account will not be set, and defaults to TLS 1.0.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_1",
    "description": "Enable auditing on SQL Servers.",
    "title": "4.1.1 Ensure that 'Auditing' is set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.1",
      "cis_level": "1",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable auditing on SQL Servers.\n\nThe Azure platform allows a SQL server to be created as a service. Enabling auditing at the server level ensures that all existing and newly created databases on the SQL server instance are audited. Auditing policy applied on the SQL database does not override auditing policy and settings applied on the particular SQL server where the database is hosted.\n\nAuditing tracks database events and writes them to an audit log in the Azure storage account. It also helps to maintain regulatory compliance, understand database activity, and gain insight into discrepancies and anomalies that could indicate business concerns or suspected security violations.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. Select the SQL server instance.\n3. Under `Security`, click `Auditing`.\n4. Click the toggle next to `Enable Azure SQL Auditing`.\n5. Select an Audit log destination.\n6. Click `Save`.\n\n### From Powershell\n\nGet the list of all SQL Servers\n\n```bash\nGet-AzSqlServer\n```\n\nFor each Server, enable auditing and set the retention for at least 90 days.\n\n### Log Analytics Example\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cSQL Server name\u003e -RetentionInDays \u003cNumber of Days to retain the audit logs, should be 90days minimum\u003e -LogAnalyticsTargetState Enabled - WorkspaceResourceId \"/subscriptions/\u003csubscription ID\u003e/resourceGroups/insights- integration/providers/Microsoft.OperationalInsights/workspaces/\u003cworkspace name\u003e\n```\n\n## Event Hub Example\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \"\u003cresource group name\u003e\" -ServerName\n\"\u003cSQL Server name\u003e\" -EventHubTargetState Enabled -EventHubName\n\"\u003cEvent Hub name\u003e\" -EventHubAuthorizationRuleResourceId \"\u003cEvent HubAuthorization Rule Resource ID\u003e\"\n```\n\n## Blob Storage Example*\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \"\u003cresource group name\u003e\" -ServerName \"\u003cSQL Server name\u003e\" -BlobStorageTargetState Enabled\n-StorageAccountResourceId \"/subscriptions/\u003csubscription_ID\u003e/resourceGroups/\u003cResource_Group\u003e/providers/M icrosoft.Stora\nge/storageAccounts/\u003cStorage Account name\u003e\"\n```\n\n### Default Value\n\nBy default, `Enable Azure SQL Auditing` is set to `Off`.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_2",
    "description": "Ensure that no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP).",
    "title": "4.1.2 Ensure no Azure SQL Databases allow ingress from 0.0.0.0/0 (ANY IP)",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.2",
      "cis_level": "1",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnsure that no SQL Databases allow ingress from 0.0.0.0/0 (ANY IP).\n\nAzure SQL Server includes a firewall to block access to unauthorized connections. More granular IP addresses can be defined by referencing the range of addresses available from specific datacenters.\n\nBy default, for a SQL server, a Firewall exists with StartIp of 0.0.0.0 and EndIP of 0.0.0.0 allowing access to all the Azure services.\n\nAdditionally, a custom rule can be set up with StartIp of 0.0.0.0 and EndIP of 255.255.255.255 allowing access from ANY IP over the Internet.\n\nIn order to reduce the potential attack surface for a SQL server, firewall rules should be defined with more granular IP addresses by referencing the range of addresses available from specific datacenters.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. For each SQL server.\n3. Click on `Networking`.\n4. `Uncheck` the checkbox for `Allow Azure services and resources to access this server`.\n5. Set firewall rules to limit access to only authorized connections.\n\n### From Azure CLI\n\nDisable default firewall rule `Allow access to Azure services`:\n\n```bash\naz sql server firewall-rule delete --resource-group \u003cresource group\u003e --server \u003csql server name\u003e --name \"AllowAllWindowsAzureIps\"\n```\n\nRemove a custom firewall rule:\n\n```bash\naz sql server firewall-rule delete --resource-group \u003cresource group\u003e --server \u003csql server name\u003e --name \u003cfirewall rule name\u003e\n```\n\nCreate a firewall rule:\n\n```bash\naz sql server firewall-rule create --resource-group \u003cresource group\u003e --server \u003csql server name\u003e --name \u003cfirewall rule name\u003e --start-ip-address \"\u003cIP Address other than 0.0.0.0\u003e\" --end-ip-address \"\u003cIP Address other than 0.0.0.0 or 255.255.255.255\u003e\"\n```\n\nUpdate a firewall rule:\n\n```bash\naz sql server firewall-rule update --resource-group \u003cresource group\u003e --server \u003csql server name\u003e --name \u003cfirewall rule name\u003e --start-ip-address \"\u003cIP Address other than 0.0.0.0\u003e\" --end-ip-address \"\u003cIP Address other than 0.0.0.0 or 255.255.255.255\u003e\"\n```\n\n### From PowerShell\n\nDisable Default Firewall Rule `Allow access to Azure services:\n\n```bash\nRemove-AzSqlServerFirewallRule -FirewallRuleName \"AllowAllWindowsAzureIps\" -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e\n```\n\nRemove a custom Firewall rule:\n\n```bash\nRemove-AzSqlServerFirewallRule -FirewallRuleName \"\u003cfirewall rule name\u003e\" -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e\n```\n\nSet the appropriate firewall rules:\n\n```bash\nSet-AzSqlServerFirewallRule -ResourceGroupName \u003cresource group name\u003e - ServerName \u003cserver name\u003e -FirewallRuleName \"\u003cfirewall rule name\u003e\" - StartIpAddress \"\u003cIP Address other than 0.0.0.0\u003e\" -EndIpAddress \"\u003cIP Address other than 0.0.0.0 or 255.255.255.255\u003e\"\n```\n\n### Default Value\n\nBy default, `Allow access to Azure Services` is set to `NO`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_3",
    "description": "Transparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.",
    "title": "4.1.3 Ensure SQL server's Transparent Data Encryption (TDE) protector is encrypted with Customer-managed key",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.3",
      "cis_level": "2",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nTransparent Data Encryption (TDE) with Customer-managed key support provides increased transparency and control over the TDE Protector, increased security with an HSM-backed external service, and promotion of separation of duties.\n\nWith TDE, data is encrypted at rest with a symmetric key (called the database encryption key) stored in the database or data warehouse distribution. To protect this data encryption key (DEK) in the past, only a certificate that the Azure SQL Service managed could be used. Now, with Customer-managed key support for TDE, the DEK can be protected with an asymmetric key that is stored in the Azure Key Vault. The Azure Key Vault is a highly available and scalable cloud-based key store which offers central key management, leverages FIPS 140-2 Level 2 validated hardware security modules (HSMs), and allows separation of management of keys and data for additional security.\n\nBased on business needs or criticality of data/databases hosted on a SQL server, it is recommended that the TDE protector is encrypted by a key that is managed by the data owner (Customer-managed key).\n\nCustomer-managed key support for Transparent Data Encryption (TDE) allows user control of TDE encryption keys and restricts who can access them and when. Azure Key Vault, Azure’s cloud-based external key management system, is the first key management service where TDE has integrated support for Customer-managed keys. With Customer-managed key support, the database encryption key is protected by an asymmetric key stored in the Key Vault. The asymmetric key is set at the server level and inherited by all databases under that server.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\nFor the desired server instance\n\n2. Click On `Transparent data encryption`.\n3. Set `Transparent data encryption` to `Customer-managed key`.\n4. Browse through your `key vaults` to Select an existing key or create a new key in the Azure Key Vault.\n5. Check `Make selected key the default TDE protector`.\n\n### From Azure CLI\n\nUse the below command to encrypt SQL server's TDE protector with a Customer- managed key\n\n```bash\naz sql server tde-key set --resource-group \u003cresourceName\u003e --server \u003cdbServerName\u003e --server-key-type {AzureKeyVault} --kid \u003ckeyIdentifier\u003e\n```\n\n### From PowerShell\n\nUse the below command to encrypt SQL server's TDE protector with a Customer- managed Key Vault key\n\n```bash\nSet-AzSqlServerTransparentDataEncryptionProtector -Type AzureKeyVault -KeyId \u003cKeyIdentifier\u003e -ServerName \u003cServerName\u003e -ResourceGroupName\n\u003cResourceGroupName\u003e\n```\n\nSelect `Y` when prompted\n\n### Default Value\n\nBy Default, Microsoft managed TDE protector is enabled for a SQL server.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_4",
    "description": "Use Azure Active Directory Authentication for authentication with SQL Database to manage credentials in a single place.",
    "title": "4.1.4 Ensure that Azure Active Directory Admin is Configured for SQL Servers",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.4",
      "cis_level": "1",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nUse Azure Active Directory Authentication for authentication with SQL Database to manage credentials in a single place.\n\nAzure Active Directory authentication is a mechanism to connect to Microsoft Azure SQL Database and SQL Data Warehouse by using identities in Azure Active Directory (Azure AD). With Azure AD authentication, identities of database users and other Microsoft services can be managed in one central location. Central ID management provides a single place to manage database users and simplifies permission management.\n- It provides an alternative to SQL Server authentication.\n- Helps stop the proliferation of user identities across database servers.\n- Allows password rotation in a single place.\n- Customers can manage database permissions using external (AAD) groups.\n- It can eliminate storing passwords by enabling integrated Windows authentication and other forms of authentication supported by Azure Active Directory.\n- Azure AD authentication uses contained database users to authenticate identities at the database level.\n- Azure AD supports token-based authentication for applications connecting to SQL Database.\n- Azure AD authentication supports ADFS (domain federation) or native user/password authentication for a local Azure Active Directory without domain synchronization.\n- Azure AD supports connections from SQL Server Management Studio that use Active Directory Universal Authentication, which includes Multi-Factor Authentication (MFA). MFA includes strong authentication with a range of easy verification options — phone call, text message, smart cards with pin, or mobile app notification.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. For each SQL server, click on `Active Directory admin`.\n3. Click on `Set admin`.\n4. Select an admin.\n5. Click `Save`.\n\n### From Azure CLI\n\n```bash\naz ad user show --id\n```\n\nFor each Server, set AD Admin\n\n```bash\naz sql server ad-admin create --resource-group \u003cresource group name\u003e --server \u003cserver name\u003e --display-name \u003cdisplay name\u003e --object-id \u003cobject id of user\u003e\n```\n\n### Using PowerShell\n\nFor each Server, set AD Admin\n\n```bash\nSet-AzSqlServerActiveDirectoryAdministrator -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -DisplayName \"\u003cDisplay name of AD account to set as DB administrator\u003e\"\n```\n\n### Default Value\n\nAzure Active Directory Authentication for SQL Database/Server is not enabled by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_5",
    "description": "Enable Transparent Data Encryption on every SQL server.",
    "title": "4.1.5 Ensure that 'Data encryption' is set to 'On' on a SQL Database",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.5",
      "cis_level": "1",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable Transparent Data Encryption on every SQL server.\n\nAzure SQL Database transparent data encryption helps protect against the threat of malicious activity by performing real-time encryption and decryption of the database, associated backups, and transaction log files at rest without requiring changes to the application.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL databases`.\n2. For each DB instance.\n3. Click on `Transparent data encryption`.\n4. Set `Data encryption` to `On`.\n\n### From Azure CLI\n\nUse the below command to enable `Transparent data encryption` for SQL DB instance.\n\n```bash\naz sql db tde set --resource-group \u003cresourceGroup\u003e --server \u003cdbServerName\u003e --database \u003cdbName\u003e --status Enabled\n```\n\n### From PowerShell\n\nUse the below command to enable `Transparent data encryption` for SQL DB instance.\n\n```bash\nSet-AzSqlDatabaseTransparentDataEncryption -ResourceGroupName \u003cResource Group Name\u003e -ServerName \u003cSQL Server Name\u003e -DatabaseName \u003cDatabase Name\u003e -State 'Enabled'\n```\n\n**Note:**\n\n- TDE cannot be used to encrypt the logical master database in SQL Database. The master database contains objects that are needed to perform the TDE operations on the user databases.\n- Azure Portal does not show master databases per SQL server. However, CLI/API responses will show master databases.\n\n### Default Value\n\nBy default, `Data encryption` is set to `On`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.1 SQL Server - Auditing",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.1 SQL Server - Auditing"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_1_6",
    "description": "SQL Server Audit Retention should be configured to be greater than 90 days.",
    "title": "4.1.6 Ensure that 'Auditing' Retention is 'greater than 90 days'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.1.6",
      "cis_level": "1",
      "cis_section_id": "4.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nSQL Server Audit Retention should be configured to be greater than 90 days.\n\nAudit Logs can be used to check for anomalies and give insight into suspected breaches or misuse of information and access.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. For each server instance.\n3. Click on `Auditing`.\n4. If storage is selected, expand `Advanced properties`.\n5. Set the `Retention (days)` setting greater than `90` days or `0` for unlimited retention.\n6. Select `Save`.\n\n### From Powershell\n\nFor each Server, set retention policy to more than 90 days\n\n### Log Analytics Example\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cSQL Server name\u003e -RetentionInDays \u003cNumber of Days to retain the audit logs, should be more than 90 days\u003e -LogAnalyticsTargetState Enabled - WorkspaceResourceId \"/subscriptions/\u003csubscription ID\u003e/resourceGroups/insights- integration/providers/Microsoft.OperationalInsights/workspaces/\u003cworkspace name\u003e\n```\n\n### Event Hub Example\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \"\u003cresource group name\u003e\" -ServerName \"\u003cSQL Server name\u003e\" -EventHubTargetState Enabled -EventHubName\n\"\u003cEvent Hub name\u003e\" -EventHubAuthorizationRuleResourceId \"\u003cEvent Hub Authorization Rule Resource ID\u003e\"\n```\n\n### Blob Storage Example*\n\n```bash\nSet-AzSqlServerAudit -ResourceGroupName \"\u003cresource group name\u003e\" -ServerName \"\u003cSQL Server name\u003e\" -BlobStorageTargetState Enabled\n-StorageAccountResourceId \"/subscriptions/\u003csubscription_ID\u003e/resourceGroups/\u003cResource_Group\u003e/providers/M icrosoft.Stora\nge/storageAccounts/\u003cStorage Account name\u003e\"\n```\n\n### Default Value\n\nBy default, SQL Server audit storage is `disabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.2 SQL Server - Microsoft Defender for SQL",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.2 SQL Server - Microsoft Defender for SQL"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_2_1",
    "description": "Enable \"Azure Defender for SQL\" on critical SQL Servers.",
    "title": "4.2.1 Ensure that Microsoft Defender for SQL is set to 'On' for critical SQL Servers",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.2.1",
      "cis_level": "2",
      "cis_section_id": "4.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable \"Microsoft Defender for SQL\" on critical SQL Servers.\n\nMicrosoft Defender for SQL is a unified package for advanced SQL security capabilities. Microsoft Defender is available for Azure SQL Database, Azure SQL Managed Instance, and Azure Synapse Analytics. It includes functionality for discovering and classifying sensitive data, surfacing and mitigating potential database vulnerabilities, and detecting anomalous activities that could indicate a threat to your database. It provides a single go-to location for enabling and managing these capabilities.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers` For each \"critical\" server instance (e.g. production SQL servers)\n2. Click `Microsoft Defender for Cloud`\n3. Click `Enable Microsoft Defender for SQL`\n\n### From Powershell\n\nEnable `Advanced Data Security` for a SQL Server:\n\n```bash\nSet-AzSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True\n```\n\n**Note:**\n\n- Enabling 'Microsoft Defender for SQL' from the Azure portal enables `Threat Detection`\n- Using Powershell command `Set-AzSqlServerThreatDetectionPolicy` enables `Microsoft Defender for SQL` for a SQL server\n\n### Default Value\n\nBy default, `Microsoft Defender for SQL` is set to `Off`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.2 SQL Server - Microsoft Defender for SQL",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.2 SQL Server - Microsoft Defender for SQL"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_2_2",
    "description": "Enable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.",
    "title": "4.2.2 Ensure that Vulnerability Assessment (VA) is enabled on a SQL server by setting a Storage Account",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.2.2",
      "cis_level": "2",
      "cis_section_id": "4.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable Vulnerability Assessment (VA) service scans for critical SQL servers and corresponding SQL databases.\n\nEnabling Microsoft Defender for SQL server does not enables Vulnerability Assessment capability for individual SQL databases unless storage account is set to store the scanning data and reports.\n\nThe Vulnerability Assessment service scans databases for known security vulnerabilities and highlights deviations from best practices, such as misconfigurations, excessive permissions, and unprotected sensitive data. Results of the scan include actionable steps to resolve each issue and provide customized remediation scripts where applicable. Additionally, an assessment report can be customized by setting an acceptable baseline for permission configurations, feature configurations, and database settings.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. Select a server instance.\n3. Click on `Security Center`.\n4. Select `Configure` next to `Enabled at subscription-level`.\n5. In Section `Vulnerability Assessment Settings`, Click `Select Storage account`.\n6. Choose Storage Account (Existing or `Create New`). Click `Ok`.\n7. Click `Save`.\n\n### From Powershell\n\nIf not already, Enable `Microsoft Defender for a SQL`:\n\n```bash\nSet-AZSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True\n```\n\nTo enable ADS-VA service by setting Storage Account\n\n```bash\nUpdate-AzSqlServerVulnerabilityAssessmentSetting `\n  -ResourceGroupName \"\u003cresource group name\u003e\"`\n  -ServerName \"\u003cServer Name\u003e\"`\n  -StorageAccountName \"\u003cStorage Name from same subscription andsame Location\" `\n  -ScanResultsContainerName \"vulnerability-assessment\" `\n  -RecurringScansInterval Weekly `\n  -EmailSubscriptionAdmins $true `\n  -NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")\n```\n\n### Default Value\n\nBy default, Microsoft Defender for SQL is not enabled for a SQL server. Enabling Microsoft Defender for SQL does not enable VA scanning by setting Storage Account automatically.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.2 SQL Server - Microsoft Defender for SQL",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.2 SQL Server - Microsoft Defender for SQL"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_2_3",
    "description": "Enable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.",
    "title": "4.2.3 Ensure that Vulnerability Assessment (VA) setting 'Periodic recurring scans' is set to 'on' for each SQL server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.2.3",
      "cis_level": "2",
      "cis_section_id": "4.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable Vulnerability Assessment (VA) Periodic recurring scans for critical SQL servers and corresponding SQL databases.\n\nVA setting 'Periodic recurring scans' schedules periodic (weekly) vulnerability scanning for the SQL server and corresponding Databases. Periodic and regular vulnerability scanning provides risk visibility based on updated known vulnerability signatures and best practices.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. For each server instance.\n3. Click on `Security Center`.\n4. In Section `Vulnerability Assessment Settings`, set `Storage Account` if not already.\n5. Toggle 'Periodic recurring scans' to ON.\n6. Click `Save`.\n\n### From Powershell\n\nIf not already, Enable `Advanced Data Security` for a SQL Server:\n\n```bash\nSet-AZSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True\n```\n\nTo enable ADS-VA service with 'Periodic recurring scans'\n\n```bash\nUpdate-AzSqlServerVulnerabilityAssessmentSetting `\n  -ResourceGroupName \"\u003cresource group name\u003e\"`\n  -ServerName \"\u003cServer Name\u003e\"`\n  -StorageAccountName \"\u003cStorage Name from same subscription and same Location\" `\n  -ScanResultsContainerName \"vulnerability-assessment\" `\n  -RecurringScansInterval Weekly `\n  -EmailSubscriptionAdmins $true `\n  -NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")\n```\n\n### Default Value\n\nEnabling `Microsoft Defender for SQL` enables 'Periodic recurring scans' by default but does not configure the Storage account.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.2 SQL Server - Microsoft Defender for SQL",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.2 SQL Server - Microsoft Defender for SQL"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_2_4",
    "description": "Configure 'Send scan reports to' with email ids of concerned data owners/stakeholders for a critical SQL servers.",
    "title": "4.2.4 Ensure that Vulnerability Assessment (VA) setting 'Send scan reports to' is configured for a SQL server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.2.4",
      "cis_level": "2",
      "cis_section_id": "4.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nConfigure 'Send scan reports to' with email addresses of concerned data owners/stakeholders for a critical SQL servers.\n\nVulnerability Assessment (VA) scan reports and alerts will be sent to email addresses configured at 'Send scan reports to'. This may help in reducing time required for identifying risks and taking corrective measures.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. Select a server instance.\n3. Select `Microsoft Defender for Cloud`.\n4. Select `Configure` next to `Enablement status`.\n5. Set `Microsoft Defender for SQL` to `On`.\n6. Under `Vulnerability Assessment Settings`, select a Storage Account.\n7. Set `Periodic recurring scans` to `On`.\n8. Under `Send scan reports to`, provide email addresses for data owners and stakeholders.\n9. Click `Save`.\n\n### From Powershell\n\nIf not already, Enable `Advanced Data Security` for a SQL Server:\n\n```bash\nSet-AZSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True\n```\n\nTo enable ADS-VA service and Set 'Send scan reports to'\n\n```bash\nUpdate-AzSqlServerVulnerabilityAssessmentSetting\n  `-ResourceGroupName \"\u003cresource group name\u003e\"`\n  -ServerName \"\u003cServer Name\u003e\"`\n  -StorageAccountName \"\u003cStorage Name from same subscription and same Location\" `\n  -ScanResultsContainerName \"vulnerability-assessment\" `\n  -RecurringScansInterval Weekly `\n  -EmailSubscriptionAdmins $true `\n  -NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")\n```\n\n### Default Value\n\nBy default, 'Send reports to' is blank.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.2 SQL Server - Microsoft Defender for SQL",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.2 SQL Server - Microsoft Defender for SQL"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_2_5",
    "description": "Enable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.",
    "title": "4.2.5 Ensure that Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners' is set for each SQL Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.2.5",
      "cis_level": "1",
      "cis_section_id": "4.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nEnable Vulnerability Assessment (VA) setting 'Also send email notifications to admins and subscription owners'.\n\nVA scan reports and alerts will be sent to admins and subscription owners by enabling setting 'Also send email notifications to admins and subscription owners'. This may help in reducing time required for identifying risks and taking corrective measures.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `SQL servers`.\n2. Select a server instance.\n3. Click on `Security Center`.\n4. Select `Configure` next to `Enabled at subscription-level`.\n5. In Section `Vulnerability Assessment Settings`, configure `Storage Accounts` if not already.\n6. Check/enable 'Also send email notifications to admins and subscription owners'.\n7. Click `Save`.\n\n### From Powershell\n\nIf not already, Enable `Advanced Data Security` for a SQL Server:\n\n```bash\nSet-AZSqlServerThreatDetectionPolicy -ResourceGroupName \u003cresource group name\u003e -ServerName \u003cserver name\u003e -EmailAdmins $True\n```\n\nTo enable ADS-VA service and Set 'Also send email notifications to admins and subscription owners'\n\n```bash\nUpdate-AzSqlServerVulnerabilityAssessmentSetting `\n  -ResourceGroupName \"\u003cresource group name\u003e\"`\n  -ServerName \"\u003cServer Name\u003e\"`\n  -StorageAccountName \"\u003cStorage Name from same subscription and same Location\" `\n  -ScanResultsContainerName \"vulnerability-assessment\" `\n  -RecurringScansInterval Weekly `\n  -EmailSubscriptionAdmins $true `\n  -NotificationEmail @(\"mail1@mail.com\" , \"mail2@mail.com\")\n```\n\n### Default Value\n\nBy default, 'Also send email notifications to admins and subscription owners' is enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_1",
    "description": "Enable SSL connection on PostgreSQL Servers.",
    "title": "4.3.1 Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.1",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnable `SSL connection` on `PostgreSQL` Servers.\n\n`SSL connectivity` helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against \"man in the middle\" attacks by encrypting the data stream between the server and application.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com)\n2. Go to Azure Database for `PostgreSQL server`.\n3. For each database, click on `Connection security`.\n4. In `SSL` settings, click on `ENABLED` to enforce SSL connections.\n5. Click `Save`.\n\n### From Azure CLI\n\nUse the below command to `enforce ssl connection` for `PostgreSQL` Database.\n\n```bash\naz postgres server update --resource-group \u003cresourceGroupName\u003e --name\n\u003cserverName\u003e --ssl-enforcement Enabled\n```\n\n### From PowerShell\n\n```bash\nUpdate-AzPostgreSqlServer -ResourceGroupName \u003cResourceGroupName \u003e -ServerName \u003cServerName\u003e -SslEnforcement Enabled\n```\n\n### Default Value\n\nBy default, secure connectivity is enforced, but some application frameworks may not enable it during deployment.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_2",
    "description": "Enable log_checkpoints on PostgreSQL Servers.",
    "title": "4.3.2 Ensure Server Parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.2",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnable `log_checkpoints` on `PostgreSQL Servers`.\n\nEnabling `log_checkpoints` helps the PostgreSQL Database to `Log each checkpoint` in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Go to `Azure Database for PostgreSQL servers`.\n3. For each database, click on `Server parameters`.\n4. Search for `log_checkpoints`.\n5. Click `ON` and save.\n\n### From Azure CLI\n\nUse the below command to update `log_checkpoints` configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --name log_checkpoints --value on\n```\n\n### From PowerShell\n\n```bash\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName \u003cResourceGroupName\u003e - ServerName \u003cServerName\u003e -Name log_checkpoints -Value on\n```\n\n### Default Value\n\nBy default `log_checkpoints` is enabled (set to `on`).\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_3",
    "description": "Enable log_connections on PostgreSQL Servers.",
    "title": "4.3.3 Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.3",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnable `log_connections` on `PostgreSQL Servers`.\n\nEnabling `log_connections` helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `Azure Database for PostgreSQL servers`.\n3. For each database, click on `Server parameters`.\n4. Search for `log_connections`.\n5. Click `ON` and save.\n\n### From Azure CLI\n\nUse the below command to update `log_connections` configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --name log_connections --value on\n```\n\n### From PowerShell\n\nUse the below command to update `log_connections` configuration.\n\n```bash\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName \u003cResourceGroupName\u003e - ServerName \u003cServerName\u003e -Name log_connections -Value on\n```\n\n### Default Value\n\nBy default `log_connections` is enabled (set to `on`).\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_4",
    "description": "Enable log_disconnections on PostgreSQL Servers.",
    "title": "4.3.4 Ensure server parameter 'log_disconnections' is set to 'ON' for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.4",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnable `log_disconnections` on `PostgreSQL Servers`.\n\nEnabling `log_disconnections` helps PostgreSQL Database to `Logs end of a session`, including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Go to `Azure Database` for `PostgreSQL servers`.\n3. For each database, click on `Server parameters`.\n4. Search for `log_disconnections`.\n5. Click `ON` and save.\n\n### From Azure CLI\n\nUse the below command to update `log_disconnections` configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --name log_connections --value on\n```\n\n### From Powershell\n\nUse the below command to update `log_disconnections` configuration.\n\n```bash\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName \u003cResourceGroupName\u003e - ServerName \u003cServerName\u003e -Name log_disconnections -Value on\n```\n\n### Default Value\n\nBy default `log_disconnections` is disabled (set to `off`).\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_5",
    "description": "Enable connection_throttling on PostgreSQL Servers.",
    "title": "4.3.5 Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.5",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnable `connection_throttling` on `PostgreSQL Servers`.\n\nEnabling `connection_throttling` helps the PostgreSQL Database to `Set the verbosity of logged messages`. This in turn generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\n## Remediation\n\n### From Azure Console\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `Azure Database for PostgreSQL servers`.\n3. For each database, click on `Server parameters`.\n4. Search for `connection_throttling`.\n5. Click `ON` and save.\n\n### From Azure CLI\n\nUse the below command to update `connection_throttling` configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --name connection_throttling --value on\n```\n\n### From PowerShell\n\nUse the below command to update `connection_throttling` configuration.\n\n```bash\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName \u003cResourceGroupName\u003e - ServerName \u003cServerName\u003e -Name connection_throttling -Value on\n```\n\n### Default Value\n\nBy default, `connection_throttling` is enabled (set to `on`).\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_6",
    "description": "Ensure log_retention_days on PostgreSQL Servers is set to an appropriate value.",
    "title": "4.3.6 Ensure Server Parameter 'log_retention_days' is greater than 3 days for PostgreSQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.6",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nEnsure `log_retention_days` on `PostgreSQL Servers` is set to an appropriate value.\n\nConfiguring `log_retention_days` determines the duration in days that `Azure Database for PostgreSQL` retains log files. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Go to `Azure Database for PostgreSQL servers`.\n3. For each database, click on `Server parameters`.\n4. Search for `log_retention_days`.\n5. Input a value between 4 and 7 (inclusive) and click `Save`.\n\n### From Azure CLI\n\nUse the below command to update `log_retention_days` configuration.\n\n```bash\naz postgres server configuration set --resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --name log_retention_days --value \u003c4-7\u003e\n```\n\n### From Powershell\n\nUse the below command to update `log_retention_days` configuration.\n\n```bash\nUpdate-AzPostgreSqlConfiguration -ResourceGroupName \u003cResourceGroupName\u003e - ServerName \u003cServerName\u003e -Name log_retention_days -Value \u003c4-7\u003e\n```\n\n### Default Value\n\nBy default `log_retention_days` is set to `3`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_7",
    "description": "Disable access from Azure services to PostgreSQL Database Server.",
    "title": "4.3.7 Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.7",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nDisable access from Azure services to PostgreSQL Database Server.\n\nIf access from Azure services is enabled, the server's firewall will accept connections from all Azure resources, including resources not in your subscription. This is usually not a desired configuration. Instead, set up firewall rules to allow access from specific network ranges or VNET rules to allow access from specific virtual networks.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `Azure Database for PostgreSQL servers`.\n3. For each database, click on `Connection security`.\n4. Under `Firewall rules`, set `Allow access to Azure services` to `No`.\n5. Click `Save`.\n\n### From Azure CLI\n\nUse the below command to delete the AllowAllWindowsAzureIps rule for PostgreSQL Database.\n\n```bash\naz postgres server firewall-rule delete --name AllowAllWindowsAzureIps -- resource-group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e\n```\n\n### Default Value\n\nThe Azure Postgres firewall is set to block all access by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.3 PostgreSQL Database Server",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.3 PostgreSQL Database Server"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_3_8",
    "description": "Azure Database for PostgreSQL servers should be created with 'infrastructure double encryption' enabled.",
    "title": "4.3.8 Ensure 'Infrastructure double encryption' for PostgreSQL Database Server is 'Enabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.3.8",
      "cis_level": "1",
      "cis_section_id": "4.3",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/PostgreSQL"
    },
    "documentation": "## Description\n\nAzure Database for PostgreSQL servers should be created with 'infrastructure double encryption' enabled.\n\nIf Double Encryption is enabled, another layer of encryption is implemented at the hardware level before the storage or network level. Information will be encrypted before it is even accessed, preventing both interception of data in motion if the network layer encryption is broken and data at rest in system resources such as memory or processor cache. Encryption will also be in place for any backups taken of the database, so the key will secure access the data in all forms. For the most secure implementation of key based encryption, it is recommended to use a Customer Managed asymmetric RSA 2048 Key in Azure Key Vault.\n\n## Remediation\n\nIt is not possible to enable 'infrastructure double encryption' on an existing Azure Database for PostgreSQL server.\nThe remediation steps detail the creation of a new Azure Database for PostgreSQL server with 'infrastructure double encryption' enabled.\n\n### From Azure Portal\n\n1. Go through the normal process of database creation.\n2. On step 2 titled 'Additional settings' ensure that 'Infrastructure double encryption enabled' is 'checked'.\n3. Acknowledge that you understand this will impact database performance.\n4. Finish database creation as normal.\n\n```bash\naz postgres server create --resource-group \u003cresourcegroup\u003e --name \u003cservername\u003e --location \u003clocation\u003e --admin-user \u003cadminusername\u003e --admin- password \u003cserver_admin_password\u003e --sku-name GP_Gen4_2 --version 11 -- infrastructure-encryption Enabled\n```\n\n### Default Value:\n\nBy Default, Double Encryption is disabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.4 MySQL Database",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.4 MySQL Database"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_4_1",
    "description": "Enable SSL connection on MySQL Servers.",
    "title": "4.4.1 Ensure 'Enforce SSL connection' is set to 'Enabled' for Standard MySQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.4.1",
      "cis_level": "1",
      "cis_section_id": "4.4",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/MySQL"
    },
    "documentation": "## Description\n\nEnable `SSL connection` on `MYSQL` Servers.\n\nSSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against \"man in the middle\" attacks by encrypting the data stream between the server and application.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `Azure Database for MySQL servers`.\n3. For each database, click on `Connection security`.\n4. In `SSL` settings, click on `ENABLED` to `Enforce SSL connections`.\n\n### From Azure CLI\n\nUse the below command to set MYSQL Databases to Enforce SSL connection.\n\n```bash\naz mysql server update --resource-group \u003cresourceGroupName\u003e --name \u003cserverName\u003e --ssl-enforcement Enabled\n```\n\n### Default Value\n\nAzure Database for MySQL when provisioned through the Azure portal or CLI will require SSL connections by default.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_4"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_4",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.4 MySQL Database",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.4 MySQL Database"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_4_2",
    "description": "Ensure TLS version on MySQL flexible servers is set to the default value.",
    "title": "4.4.2 Ensure 'TLS Version' is set to 'TLSV1.2' for MySQL flexible Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.4.2",
      "cis_level": "1",
      "cis_section_id": "4.4",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/MySQL"
    },
    "documentation": "## Description\n\nEnsure `TLS version` on `MySQL flexible` servers is set to the default value.\n\nTLS connectivity helps to provide a new layer of security by connecting database server to client applications using Transport Layer Security (TLS). Enforcing TLS connections between database server and client applications helps protect against \"man in the middle\" attacks by encrypting the data stream between the server and application.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com)\n2. Go to `Azure Database for MySQL flexible servers`\n3. For each database, click on `Server parameters` under `Settings`\n4. In the search box, type in `tls_version`\n5. Click on the VALUE dropdown, and ensure only `TLSV1.2` is selected for `tls_version`\n\n### From Azure CLI\n\nUse the below command to set MYSQL flexible databases to used version 1.2 for the `tls_version` parameter.\n\n```bash\naz mysql flexible-server parameter set --name tls_version --resource- group \u003cresourceGroupName\u003e --server-name \u003cserverName\u003e --value TLSV1.2\n```\n\n### Default Value\n\nBy default, TLS is set to v1.2 for MySQL Flexible servers.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_4"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_4",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.4 MySQL Database",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.4 MySQL Database"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_4_3",
    "description": "Enable audit_log_enabled on MySQL Servers.",
    "title": "4.4.3 Ensure server parameter 'audit_log_enabled' is set to 'ON' for MySQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.4.3",
      "cis_level": "2",
      "cis_section_id": "4.4",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/MySQL"
    },
    "documentation": "## Description\n\nEnable audit_log_enabled on MySQL Servers.\n\nEnabling audit_log_enabled helps MySQL Database to log items such as connection attempts to the server, DDL/DML access, and more. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Select `Azure Database for MySQL Servers`.\n3. Select a database.\n4. Under Settings, select `Server parameters`.\n5. Update `audit_log_enabled` parameter to ON\n6. Under Monitoring, select `Diagnostic settings`.\n7. Select `+ Add diagnostic setting`.\n8. Provide a diagnostic setting name.\n9. Under Categories, select `MySQL Audit Logs`.\n10. Specify destination details.\n11. Click `Save`.\n\nIt may take up to 10 minutes for the logs to appear in the configured destination.\n\n### Default Value\n\naudit_log_enabled is set to OFF by default\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_4"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_4",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.4 MySQL Database",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.4 MySQL Database"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_4_4",
    "description": "Set audit_log_enabled to include CONNECTION on MySQL Servers.",
    "title": "4.4.4 Ensure server parameter 'audit_log_events' has 'CONNECTION' set for MySQL Database Server",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.4.4",
      "cis_level": "2",
      "cis_section_id": "4.4",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/MySQL"
    },
    "documentation": "## Description\n\nSet `audit_log_enabled` to include CONNECTION on MySQL Servers.\n\nEnabling CONNECTION helps MySQL Database to log items such as successful and failed connection attempts to the server. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Select `Azure Database for MySQL servers`.\n3. Select a database.\n4. Under Settings, select `Server parameters`.\n5. Update `audit_log_enabled` parameter to `ON`.\n6. Update `audit_log_events` parameter to have at least `CONNECTION` checked.\n7. Click `Save`.\n8. Under `Monitoring`, select `Diagnostic settings`.\n9. Select `+ Add diagnostic setting`.\n10. Provide a diagnostic setting name.\n11. Under `Categories`, select `MySQL Audit Logs`.\n12. Specify destination details.\n13. Click `Save`.\n\nIt may take up to 10 minutes for the logs to appear in the configured destination.\n\n### Default Value\n\nBy default `audit_log_events` is disabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_4"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_4",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.5 Cosmos DB",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.5 Cosmos DB"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_5_1",
    "description": "Limiting your Cosmos DB to only communicate on whitelisted networks lowers its attack footprint.",
    "title": "4.5.1 Ensure That 'Firewalls \u0026 Networks' Is Limited to Use Selected Networks Instead of All Networks",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.5.1",
      "cis_level": "2",
      "cis_section_id": "4.5",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nLimiting your Cosmos DB to only communicate on whitelisted networks lowers its attack footprint.\n\nSelecting certain networks for your Cosmos DB to communicate restricts the number of networks including the internet that can interact with what is stored within the database.\n\n## Remediation\n\n### From Azure Portal\n\n1. Open the portal menu.\n2. Select the Azure Cosmos DB blade.\n3. Select a Cosmos DB account to audit.\n4. Select `Networking`.\n5. Under `Public network access`, select `Selected networks`.\n6. Under `Virtual networks`, select `+ Add existing virtual network` or `+ Add a new virtual network`.\n7. For existing networks, select subscription, virtual network, subnet and click `Add`. For new networks, provide a name, update the default values if required, and click `Create`.\n8. Click `Save`.\n\n### Default Value\n\nBy default, Cosmos DBs are set to have access all networks.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_5",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.5 Cosmos DB",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.5 Cosmos DB"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_5_2",
    "description": "Private endpoints limit network traffic to approved sources.",
    "title": "4.5.2 Ensure That Private Endpoints Are Used Where Possible",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.5.2",
      "cis_level": "2",
      "cis_section_id": "4.5",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nPrivate endpoints limit network traffic to approved sources.\n\nFor sensitive data, private endpoints allow granular control of which services can communicate with Cosmos DB and ensure that this network traffic is private. You set this up on a case by case basis for each service you wish to be connected.\n\n## Remediation\n\n### From Azure Portal\n\n1. Open the portal menu.\n2. Select the Azure Cosmos DB blade.\n3. Select the Azure Cosmos DB account.\n4. Select `Networking`.\n5. Select `Private access`.\n6. Click `+ Private Endpoint`.\n7. Provide a Name.\n8. Click `Next`.\n9. From the Resource type drop down, select `Microsoft.AzureCosmosDB/databaseAccounts`.\n10. From the Resource drop down, select the Cosmos DB account.\n11. Click `Next`.\n12. Provide appropriate Virtual Network details.\n13. Click `Next`.\n14. Provide appropriate DNS details.\n15. Click `Next`.\n16. Optionally provide Tags.\n17. Click `Next` : `Review + create`.\n18. Click `Create`.\n\n### Default Value\n\nBy default Cosmos DB does not have private endpoints enabled and its traffic is public to the network.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_5",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 4 Database Services \u003e 4.5 Cosmos DB",
    "category_hierarchy": [
      "CIS v2.0.0",
      "4 Database Services",
      "4.5 Cosmos DB"
    ],
    "control_id": "azure_compliance.control.cis_v200_4_5_3",
    "description": "Cosmos DB can use tokens or AAD for client authentication which in turn will use Azure RBAC for authorization. Using AAD is significantly more secure because AAD handles the credentials and allows for MFA and centralized management, and the Azure RBAC better integrated with the rest of Azure.",
    "title": "4.5.3 Use Azure Active Directory (AAD) Client Authentication and Azure RBAC where possible",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "4.5.3",
      "cis_level": "1",
      "cis_section_id": "4.5",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/SQL"
    },
    "documentation": "## Description\n\nCosmos DB can use tokens or AAD for client authentication which in turn will use Azure RBAC for authorization. Using AAD is significantly more secure because AAD handles the credentials and allows for MFA and centralized management, and the Azure RBAC better integrated with the rest of Azure.\n\nAAD client authentication is considerably more secure than token-based authentication because the tokens must be persistent at the client. AAD does not require this.\n\n## Remediation\n\nMap all the resources that currently access to the Azure Cosmos DB account with keys or access tokens.\nCreate an Azure Active Directory (AAD) identity for each of these resources:\nFor Azure resources, you can create a managed identity . You may choose between system-assigned and user-assigned managed identities.\nFor non-Azure resources, create an AAD identity.\nGrant each AAD identity the minimum permission it requires. When possible, we recommend you use one of the 2 built-in role definitions: Cosmos DB Built-in Data Reader or Cosmos DB Built-in Data Contributor.\nValidate that the new resource is functioning correctly. After new permissions are granted to identities, it may take a few hours until they propagate. When all resources are working correctly with the new identities, continue to the next step.\nYou can use the az resource update powershell command:\n- $cosmosdbname = \"cosmos-db-account-name\"\n- $resourcegroup = \"resource-group-name\"\n- $cosmosdb = az cosmosdb show --name $cosmosdbname --resource-group\n- $resourcegroup | ConvertFrom-Json\naz resource update --ids $cosmosdb.id --set properties.disableLocalAuth=true --latest- include-preview.\n\n### Default Value:\n\nThe default is to use tokens/keys for client authentication.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_4",
      "azure_compliance.benchmark.cis_v200_4_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_4/azure_compliance.benchmark.cis_v200_4_5",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_1",
    "description": "Enable Diagnostic settings for exporting activity logs. Diagnostic settings are available for each individual resource within a subscription. Settings should be configured for all appropriate resources for your environment.",
    "title": "5.1.1 Ensure that a 'Diagnostic Setting' exists",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.1",
      "cis_level": "1",
      "cis_section_id": "5.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nEnable Diagnostic settings for exporting activity logs. Diagnostic settings are available for each individual resource within a subscription. Settings should be configured for all appropriate resources for your environment.\n\nA diagnostic setting controls how a diagnostic log is exported. By default, logs are retained only for 90 days. Diagnostic settings should be defined so that logs can be exported and stored for a longer duration in order to analyze security activities within an Azure subscription.\n\n## Remediation\n\n### From Azure Portal\n\nTo enable Diagnostic Settings on a Subscription:\n\n1. Go to `Monitor`.\n2. Click on `Activity Log`.\n3. Click on `Export Activity Logs`.\n4. Click `+ Add diagnostic setting`.\n5. Enter a `Diagnostic setting name`.\n6. Select `Categories` for the diagnostic settings.\n7. Select the appropriate `Destination details` (this may be Log Analytics/Storage Account/Event Hub or Partner solution).\n8. Click `Save`.\n\nTo enable Diagnostic Settings on a specific resource:\n\n1. Go to `Monitor`.\n2. Click `Diagnostic settings`.\n3. Click on the resource that has a diagnostics status of `disabled`.\n4. Select `Add Diagnostic Setting`.\n5. Enter a `Diagnostic setting name`.\n6. Select the appropriate log, metric, and destination. (This may be Log Analytics/Storage account or Event Hub).\n7. Click `save`.\n\nRepeat these step for all resources as needed.\n\n### From Azure CLI\n\nTo configure Diagnostic Settings on a Subscription:\n\n```bash\naz monitor diagnostic-settings subscription create --subscription \u003csubscription id\u003e --name \u003cdiagnostic settings name\u003e --location \u003clocation\u003e \u003c[- -event-hub \u003cevent hub ID\u003e --event-hub-auth-rule \u003cevent hub auth rule ID\u003e] [-- storage-account \u003cstorage account ID\u003e] [--workspace \u003clog analytics workspace ID\u003e] --logs \"\u003cJSON encoded categories\u003e\" (e.g. [{category:Security,enabled:true},{category:Administrative,enabled:true},{cat egory:Alert,enabled:true},{category:Policy,enabled:true}])\n```\n\nTo configure Diagnostic Settings on a specific resource:\n\n```bash\naz monitor diagnostic-settings create --subscription \u003csubscription ID\u003e -- resource \u003cresource ID\u003e --name \u003cdiagnostic settings name\u003e \u003c[--event-hub \u003cevent hub ID\u003e --event-hub-rule \u003cevent hub auth rule ID\u003e] [--storage-account \u003cstorage account ID\u003e] [--workspace \u003clog analytics workspace ID\u003e] --logs \u003cresource specific JSON encoded log settings\u003e --metrics \u003cmetric settings (shorthand|json-file|yaml-file)\u003e\n```\n\n### From PowerShell\n\nTo configure Diagnostic Settings on a subscription:\n\n```bash\n$logCategories = @();\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Administrative -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Security -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category ServiceHealth -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Alert -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Recommendation -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject -\nCategory Policy -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Autoscale -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category ResourceHealth -Enabled $true\n\nNew-AzSubscriptionDiagnosticSetting -SubscriptionId \u003csubscription ID\u003e -Name \u003cDiagnostic settings name\u003e \u003c[-EventHubAuthorizationRule \u003cevent hub auth rule ID\u003e -EventHubName \u003cevent hub name\u003e] [-StorageAccountId \u003cstorage account ID\u003e] [-WorkSpaceId \u003clog analytics workspace ID\u003e] [-MarketplacePartner ID \u003cfull ARM Marketplace resource ID\u003e]\u003e -Log $logCategories\n```\n\nTo configure Diagnostic Settings on a specific resource:\n\n```bash\n$logCategories = @()\n$logCategories += New-AzDiagnosticSettingLogSettingsObject -Category \u003cresource specific log category\u003e -Enabled $true\n\nRepeat command and variable assignment for each Log category specific to the resource where this Diagnostic Setting will get configured.\n\n$metricCategories = @()\n$metricCategories += New-AzDiagnosticSettingMetricSettingsObject -Enabled $true [-Category \u003cresource specific metric category | AllMetrics\u003e] [- RetentionPolicyDay \u003cInteger\u003e] [-RetentionPolicyEnabled $true]\n\nRepeat command and variable assignment for each Metric category or use the 'AllMetrics' category.\n\nNew-AzDiagnosticSetting -ResourceId \u003cresource ID\u003e -Name \u003cDiagnostic settings name\u003e -Log $logCategories -Metric $metricCategories [- EventHubAuthorizationRuleId \u003cevent hub auth rule ID\u003e -EventHubName \u003cevent hub name\u003e] [-StorageAccountId \u003cstorage account ID\u003e] [-WorkspaceId \u003clog analytics workspace ID\u003e] [-MarketplacePartnerId \u003cfull ARM marketplace resource ID\u003e]\u003e\n```\n\n### Default Value\n\nBy default, diagnostic setting is not set.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_2",
    "description": "A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recommendation will not be available. Please review the recommendation at the beginning of this subsection titled: 'Ensure that a 'Diagnostic Setting' exists.' The diagnostic setting should be configured to log the appropriate activities from the control/management plane.",
    "title": "5.1.2 Ensure Diagnostic Setting captures appropriate categories",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.2",
      "cis_level": "1",
      "cis_section_id": "5.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\n**Prerequisite:** A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recommendation will not be available. Please review the recommendation at the beginning of this subsection titled: \"Ensure that a 'Diagnostic Setting' exists.\"\n\nThe diagnostic setting should be configured to log the appropriate activities from the control/management plane.\n\nA diagnostic setting controls how the diagnostic log is exported. Capturing the diagnostic setting categories for appropriate control/management plane activities allows proper alerting.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Azure Monitor`.\n2. Click `Activity log`.\n3. Click on `Export Activity Logs`.\n4. Select the `Subscription` from the drop down menu.\n5. Click on `Add diagnostic setting`.\n6. Enter a name for your new Diagnostic Setting.\n7. Check the following categories: `Administrative`, `Alert`, `Policy`, and `Security`.\n8. Choose the destination details according to your organization's needs.\n\n### From Az CLI\n\n```bash\naz monitor diagnostic-settings subscription create --subscription \u003csubscription id\u003e --name \u003cdiagnostic settings name\u003e --location \u003clocation\u003e \u003c[- -event-hub \u003cevent hub ID\u003e --event-hub-auth-rule \u003cevent hub auth rule ID\u003e] [-- storage-account \u003cstorage account ID\u003e] [--workspace \u003clog analytics workspace ID\u003e] --logs \"[{category:Security,enabled:true},{category:Administrative,enabled:true},{ca tegory:Alert,enabled:true},{category:Policy,enabled:true}]\"\n```\n\n### From Powershell\n\n```bash\n$logCategories = @();\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Administrative -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Security -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Alert -Enabled $true\n$logCategories += New-AzDiagnosticSettingSubscriptionLogSettingsObject - Category Policy -Enabled $true\n\nNew-AzSubscriptionDiagnosticSetting -SubscriptionId \u003csubscription ID\u003e -Name \u003cDiagnostic settings name\u003e \u003c[-EventHubAuthorizationRule \u003cevent hub auth rule ID\u003e -EventHubName \u003cevent hub name\u003e] [-StorageAccountId \u003cstorage account ID\u003e] [-WorkSpaceId \u003clog analytics workspace ID\u003e] [-MarketplacePartner ID \u003cfull ARM Marketplace resource ID\u003e]\u003e -Log $logCategories\n```\n\n### Default Value\n\nWhen the diagnostic setting is created using Azure Portal, by default no categories are selected.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_3",
    "description": "The storage account container containing the activity log export should not be publicly accessible.",
    "title": "5.1.3 Ensure the Storage Container Storing the Activity Logs is not Publicly Accessible",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.3",
      "cis_level": "1",
      "cis_section_id": "5.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nThe storage account container containing the activity log export should not be publicly accessible.\n\nAllowing public access to activity log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home select the Portal Menu.\n2. Search for `Storage Accounts` to access Storage account blade.\n3. Click on the storage account name.\n4. Click on `Configuration` under settings.\n5. Select `Enabled` under \"Allow Blob public access\".\n\n### From Azure CLI\n\n```bash\naz storage container set-permission --name insights-activity-logs --account- name \u003cStorage Account Name\u003e --sas-token \u003cSAS token\u003e --public-access off\n```\n\n### From PowerShell\n\nCreate a new storage account context for the storage account holding the `insight- activity-logs` container making sure to use a valid `Shared Access Signature (SAS)` token.\n\n```bash\n$context = New-AzStorageContext -StorageAccountName \u003cstorage account name\u003e - SasToken \"\u003cSAS token\u003e\"\n```\n\nChange the `insights-activity-logs` container public access to `off`\n\n```bash\nSet-AzStorageContainerAcl -Context $context -Name \"insights-activity-logs\" - Permission Off -PassThru\n```\n\n### Default Value\n\nBy default, public access is set to null (allowing only private access) for a container with activity log export.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_4",
    "description": "Storage accounts with the activity log exports can be configured to use Customer Managed Keys (CMK).",
    "title": "5.1.4 Ensure the storage account containing the container with activity logs is encrypted with Customer Managed Key",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.4",
      "cis_level": "2",
      "cis_section_id": "5.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nStorage accounts with the activity log exports can be configured to use Customer Managed Keys (CMK).\n\nConfiguring the storage account with the activity log export container to use CMKs provides additional confidentiality controls on log data, as a given user must have read permission on the corresponding storage account and must be granted decrypt permission by the CMK.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the Storage accounts blade.\n2. Click on the storage account.\n3. Under `Security + networking`, click `Encryption`.\n4. Next to `Encryption type`, select `Customer-managed keys`.\n5. Complete the steps to configure a customer-managed key for encryption of the storage account.\n\n### From Azure CLI\n\n```bash\naz storage account update --name \u003cname of the storage account\u003e --resource- group \u003cresource group for a storage account\u003e --encryption-key- source=Microsoft.Keyvault --encryption-key-vault \u003cKey Vault URI\u003e -- encryption-key-name \u003cKeyName\u003e --encryption-key-version \u003cKey Version\u003e\n```\n\n### From PowerShell\n\n```bash\nSet-AzStorageAccount -ResourceGroupName \u003cresource group name\u003e -Name \u003cstorage account name\u003e -KeyvaultEncryption -KeyVaultUri \u003ckey vault URI\u003e -KeyName \u003ckey name\u003e\n```\n\n### Default Value\n\nBy default, for a storage account `keySource` is set to `Microsoft.Storage` allowing encryption with vendor Managed key and not a Customer Managed Key.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_5",
    "description": "Enable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.",
    "title": "5.1.5 Ensure that logging for Azure Key Vault is 'Enabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.5",
      "cis_level": "1",
      "cis_section_id": "5.1",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnable AuditEvent logging for key vault instances to ensure interactions with key vaults are logged and available.\n\nMonitoring how and when key vaults are accessed, and by whom, enables an audit trail of interactions with confidential information, keys, and certificates managed by Azure Keyvault. Enabling logging for Key Vault saves information in an Azure storage account which the user provides. This creates a new container named insights-logs-auditevent automatically for the specified storage account. This same storage account can be used for collecting logs for multiple key vaults.\n\n## Remediation\n\n## From Azure Portal\n\n1. Go to `Key vaults`.\n2. Select a Key vault.\n3. Select `Diagnostic settings`.\n4. Click on `Edit setting` against an existing diagnostic setting, or `Add diagnostic setting`.\n5. If creating a new diagnostic setting, provide a name.\n6. Check `Archive to a storage account`.\n7. Under Categories, check `Audit Logs`.\n8. Set an appropriate value for `Retention (days)`.\n9. Click `Save`.\n\n## From Azure CLI\n\nTo update an existing `Diagnostic Settings`\n\n```bash\naz monitor diagnostic-settings update --name \"\u003cdiagnostics settings name\u003e\" -- resource \u003ckey vault resource ID\u003e --set retentionPolicy.days=90\n```\n\nTo create a new `Diagnostic Settings`\n\n```bash\naz monitor diagnostic-settings create --name \u003cdiagnostic settings name\u003e -- resource \u003ckey vault resource ID\u003e --logs \"[{category:AuditEvents,enabled:true,retention- policy:{enabled:true,days:180}}]\" --metrics \"[{category:AllMetrics,enabled:true,retention- policy:{enabled:true,days:180}}]\" \u003c[--event-hub \u003cevent hub ID\u003e --event-hub- rule \u003cevent hub auth rule ID\u003e | --storage-account \u003cstorage account ID\u003e |-- workspace \u003clog analytics workspace ID\u003e | --marketplace-partner-id \u003cfull\nresource ID of third-party solution\u003e]\u003e\n```\n\n### From PowerShell\n\nCreate the `Log` settings object\n\n```bash\n$logSettings = @()\n$logSettings += New-AzDiagnosticSettingLogSettingsObject -Enabled $true - RetentionPolicyDay 180 -RetentionPolicyEnabled $true -Category AuditEvent\n```\n\nCreate the `Metric` settings object\n\n```bash\n$metricSettings = @()\n$metricSettings += New-AzDiagnosticSettingMetricSettingsObject -Enabled $true -RetentionPolicyDay 180 -RetentionPolicyEnabled $true -Category AllMetrics\n```\n\nCreate the `Diagnostic Settings` for each `Key Vault`\n\n```bash\nNew-AzDiagnosticSetting -Name \"\u003cdiagnostic setting name\u003e\" -ResourceId \u003ckey vault resource ID\u003e -Log $logSettings -Metric $metricSettings [- StorageAccountId \u003cstorage account ID\u003e | -EventHubName \u003cevent hub name\u003e - EventHubAuthorizationRuleId \u003cevent hub auth rule ID\u003e | -WorkSpaceId \u003clog analytics workspace ID\u003e | -MarketPlacePartnerId \u003cfull resource ID for third- party solution\u003e]\n```\n\n### Default Value\n\nBy default, Diagnostic AuditEvent logging is not enabled for Key Vault instances.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_6",
    "description": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
    "title": "5.1.6 Ensure that Network Security Group Flow logs are captured and sent to Log Analytics",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.6",
      "cis_level": "2",
      "cis_section_id": "5.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnsure that network flow logs are captured and fed into a central log analytics workspace.\n\nNetwork Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to `Network Watcher`.\n2. Select `NSG flow logs`.\n3. Select `+ Create`.\n4. Select the desired Subscription.\n5. Select `+ Select NSG`.\n6. Select a network security group.\n7. Click `Confirm selection`.\n8. Select or create a new Storage Account.\n9. Input the retention in days to retain the log.\n10. Click `Next`.\n11. Under `Configuration`, select `Version 2`.\n12. If rich analytics are required, select `Enable Traffic Analytics`, a processing interval, and a `Log Analytics Workspace`.\n13. Select `Next`.\n14. Optionally add Tags.\n15. Select `Review + create`.\n16. Select `Create`.\n\n**Warning**\nThe remediation policy creates remediation deployment and names them by concatenating the subscription name and the resource group name. The MAXIMUM permitted length of a deployment name is 64 characters. Exceeding this will cause the remediation task to fail.\n\n### Default Value\n\nBy default Network Security Group logs are not sent to Log Analytics.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.1 Configuring Diagnostic Settings",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.1 Configuring Diagnostic Settings"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_1_7",
    "description": "Enable AppServiceHTTPLogs diagnostic log category for Azure App Service instances to ensure all http requests are captured and centrally logged.",
    "title": "5.1.7 Ensure that logging for Azure AppService 'HTTP logs' is enabled",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.1.7",
      "cis_level": "2",
      "cis_section_id": "5.1",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnable AppServiceHTTPLogs diagnostic log category for Azure App Service instances to ensure all http requests are captured and centrally logged.\n\nCapturing web requests can be important supporting information for security analysts performing monitoring and incident response activities. Once logging, these logs can be ingested into SIEM or other central aggregation point for the organization.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `App Services` and for each `App Service`:\n2. Go to `Diagnostic Settings`.\n3. Click `Add Diagnostic Setting`.\n4. Check the checkbox next to 'HTTP logs'.\n5. Configure a destination based on your specific logging consumption capability (for example Stream to an event hub and then consuming with SIEM integration for Event Hub logging).\n\n### Default Value:\n\nNot configured.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_1"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_1",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_1",
    "description": "Create an activity log alert for the Create Policy Assignment event.",
    "title": "5.2.1 Ensure that Activity Log Alert exists for Create Policy Assignment",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.1",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Create Policy Assignment event.\n\nMonitoring for create policy assignment events gives insight into changes done in \"Azure policy - assignments\" and can reduce the time it takes to detect unsolicited changes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Policy assignment (policyAssignments)`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Create policy assignment (Microsoft.Authorization/policyAssignments)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\"\n--condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/write and level=\u003cverbose | information | warning | error | critical\u003e --scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription ID\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Authorization/policyAssignments/write -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nGet the `Action Group` information and store it in a variable, then create a new `Action` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e -\nName \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` variable.\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Authorization/policyAssignments/write`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity alert rule name\u003e\" -ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_2",
    "description": "Create an activity log alert for the Delete Policy Assignment event.",
    "title": "5.2.2 Ensure that Activity Log Alert exists for Delete Policy Assignment",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.2",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Delete Policy Assignment event.\n\nMonitoring for delete policy assignment events gives insight into changes done in \"azure policy - assignments\" and can reduce the time it takes to detect unsolicited changes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Click on `Alerts`.\n3. Click on `Create`.\n4. Click on `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Policy assignment (policyAssignments)`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Delete policy assignment (Microsoft.Authorization/policyAssignments)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a Resource group, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Authorization/policyAssignments/delete and level=\u003cverbose | information | warning | error | critical\u003e --scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the conditions object\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Authorization/policyAssignments/delete -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Action` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e - Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` variable.\n\n```bash\n$scope = \"/subscriptions/\u003csubscription id\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Authorization/policyAssignments/delete`.\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" -\nResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_3",
    "description": "Create an Activity Log Alert for the Create or Update Network Security Group event.",
    "title": "5.2.3 Ensure that Activity Log Alert exists for Create or Update Network Security Group",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.3",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an Activity Log Alert for the Create or Update Network Security Group event.\n\nMonitoring for Create or Update Network Security Group events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Network security groups`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Create or Update Network Security Group (Microsoft.Network/networkSecurityGroups)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/write and level=verbose --scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" --subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Network/networkSecurityGroups/write -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e - Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription id\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Network/networkSecurityGroups/write`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" - ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_4",
    "description": "Create an activity log alert for the Delete Network Security Group event.",
    "title": "5.2.4 Ensure that Activity Log Alert exists for Delete Network Security Group",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.4",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Delete Network Security Group event.\n\nMonitoring for \"Delete Network Security Group\" events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Network security groups`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Delete Network Security Group (Microsoft.Network/networkSecurityGroups)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Network/networkSecurityGroups/delete and level=\u003cverbose | information | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Network/networkSecurityGroups/delete -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e - Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription id\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Network/networkSecurityGroups/delete`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" -\nResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_5",
    "description": "Create an activity log alert for the Create or Update Security Solution event.",
    "title": "5.2.5 Ensure that Activity Log Alert exists for Create or Update Security Solution",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.5",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Create or Update Security Solution event.\n\nMonitoring for Create or Update Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Network security groups`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Create or Update Security Solutions (Microsoft.Security/securitySolutions)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/write and level=\u003cverbose | information | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Security/securitySolutions/write -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e - Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Security/securitySolutions/write`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" -\nResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_6",
    "description": "Create an activity log alert for the Delete Security Solution event.",
    "title": "5.2.6 Ensure that Activity Log Alert exists for Delete Security Solution",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.6",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Delete Security Solution event.\n\nMonitoring for Delete Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Security Solutions (securitySolutions).`\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Delete Security Solutions (Microsoft.Security/securitySolutions)`\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Security/securitySolutions/delete and level=\u003cverbose | information | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Security/securitySolutions/delete -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e - Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Security/securitySolutions/delete`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" -\nResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_7",
    "description": "Create an activity log alert for the Create or Update SQL Server Firewall Rule event.",
    "title": "5.2.7 Ensure that Activity Log Alert exists for Create or Update SQL Server Firewall Rule",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.7",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Create or Update SQL Server Firewall Rule event.\n\nMonitoring for Create or Update SQL Server Firewall Rule events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Server Firewall Rule (servers/firewallRules)`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Create/Update server firewall rule (Microsoft.Sql/servers/firewallRules)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/write and level=\u003cverbose |\ninformation | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Sql/servers/firewallRules/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e -Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Security/securitySolutions/write`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" - ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created or active.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_8",
    "description": "Create an activity log alert for the 'Delete SQL Server Firewall Rule.'",
    "title": "5.2.8 Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.8",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the \"Delete SQL Server Firewall Rule.\"\n\nMonitoring for Delete SQL Server Firewall Rule events gives insight into SQL network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Server Firewall Rule (servers/firewallRules)`\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Delete server firewall rule (Microsoft.Sql/servers/firewallRules)`\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Sql/servers/firewallRules/delete and level=\u003cverbose |\ninformation | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Sql/servers/firewallRules/delete -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e -Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Sql/servers/firewallRules/delete`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" - ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created or active.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_9",
    "description": "Create an activity log alert for the Create or Update Public IP Addresses rule.",
    "title": "5.2.9 Ensure that Activity Log Alert exists for Create or Update Public IP Address rule",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.9",
      "cis_level": "1",
      "cis_section_id": "5.2",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Create or Update Public IP Addresses rule.\n\nMonitoring for Create or Update Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Public IP addresses`.\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Create or Update Public Ip Address (Microsoft.Network/publicIPAddresses)`.\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and operationName=Microsoft.Network/publicIPAddresses/write and level=\u003cverbose | information | warning | error | critical\u003e--scope\n\"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Network/publicIPAddresses/write -Field operationName\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e -Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Sql/servers/firewallRules/delete`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" - ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created or active.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.2 Monitoring using Activity Log Alerts",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.2 Monitoring using Activity Log Alerts"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_2_10",
    "description": "Create an activity log alert for the Delete Public IP Address rule.",
    "title": "5.2.10 Ensure that Activity Log Alert exists for Delete Public IP Address rule",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.2.10",
      "cis_level": "1",
      "cis_section_id": "5",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nCreate an activity log alert for the Delete Public IP Address rule.\n\nMonitoring for Delete Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `Monitor` blade.\n2. Select `Alerts`.\n3. Select `Create`.\n4. Select `Alert rule`.\n5. Under `Filter by subscription`, choose a subscription.\n6. Under `Filter by resource type`, select `Public IP addresses`\n7. Under `Filter by location`, select `All`.\n8. From the results, select the subscription.\n9. Select `Done`.\n10. Select the `Condition` tab.\n11. Under `Signal name`, click `Delete Public Ip Address (Microsoft.Network/publicIPAddresses)`\n12. Select the `Actions` tab.\n13. To use an existing action group, click `Select action groups`. To create a new action group, click `Create action group`. Fill out the appropriate details for the selection.\n14. Select the `Details` tab.\n15. Select a `Resource group`, provide an `Alert rule name` and an optional `Alert rule description`.\n16. Click `Review + create`.\n17. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor activity-log alert create --resource-group \"\u003cresource group name\u003e\" --condition category=Administrative and\noperationName=Microsoft.Network/publicIPAddresses/delete and level=\u003cverbose | information | warning | error | critical\u003e--scope \"/subscriptions/\u003csubscription ID\u003e\" --name \"\u003cactivity log rule name\u003e\" -- subscription \u003csubscription id\u003e --action-group \u003caction group ID\u003e --location global\n```\n\n### From PowerShell\n\nCreate the `Conditions` object.\n\n```bash\n$conditions = @()\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Administrative -Field category\n$conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Microsoft.Network/publicIPAddresses/delete -Field operationName $conditions += New-AzActivityLogAlertAlertRuleAnyOfOrLeafConditionObject - Equal Verbose -Field level\n```\n\nRetrieve the `Action Group` information and store in a variable, then create the `Actions` object.\n\n```bash\n$actionGroup = Get-AzActionGroup -ResourceGroupName \u003cresource group name\u003e -Name \u003caction group name\u003e\n$actionObject = New-AzActivityLogAlertActionGroupObject -Id $actionGroup.Id\n```\n\nCreate the `Scope` object\n\n```bash\n$scope = \"/subscriptions/\u003csubscription ID\u003e\"\n```\n\nCreate the `Activity Log Alert Rule` for `Microsoft.Sql/servers/firewallRules/delete`\n\n```bash\nNew-AzActivityLogAlert -Name \"\u003cactivity log alert rule name\u003e\" - ResourceGroupName \"\u003cresource group name\u003e\" -Condition $conditions -Scope $scope -Location global -Action $actionObject -Subscription \u003csubscription ID\u003e -Enabled $true\n```\n\n### Default Value\n\nBy default, no monitoring alerts are created or active.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_2"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_2",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.3 Configuring Application Insights",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.3 Configuring Application Insights"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_3_1",
    "description": "Application Insights within Azure act as an Application Performance Monitoring solution providing valuable data into how well an application performs and additional information when performing incident response. The types of log data collected include application metrics, telemetry data, and application trace logging data providing organizations with detailed information about application activity and application transactions.",
    "title": "5.3.1 Ensure Application Insights are Configured",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.3.1",
      "cis_level": "2",
      "cis_section_id": "5",
      "cis_type": "automated",
      "cis_version": "v1.4.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nApplication Insights within Azure act as an Application Performance Monitoring solution providing valuable data into how well an application performs and additional information when performing incident response. The types of log data collected include application metrics, telemetry data, and application trace logging data providing organizations with detailed information about application activity and application transactions. Both data sets help organizations adopt a proactive and retroactive means to handle security and performance related metrics within their modern applications.\n\nConfiguring Application Insights provides additional data not found elsewhere within Azure as part of a much larger logging and monitoring program within an organization's Information Security practice. The types and contents of these logs will act as both a potential cost saving measure (application performance) and a means to potentially confirm the source of a potential incident (trace logging). Metrics and Telemetry data provide organizations with a proactive approach to cost savings by monitoring an application's performance, while the trace logging data provides necessary details in a reactive incident response scenario by helping organizations identify the potential source of an incident within their application.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to `Application Insights`.\n2. Under the `Basics` tab within the `PROJECT DETAILS` section, select the `Subscription`.\n3. Select the `Resource group`.\n4. Within the `INSTANCE DETAILS`, enter a `Name`.\n5. Select a `Region`.\n6. Next to `Resource Mode`, select `Workspace-based`.\n7. Within the `WORKSPACE DETAILS`, select the `Subscription` for the log analytics workspace.\n8. Select the appropriate `Log Analytics Workspace`.\n9. Click `Next : Tags \u003e`.\n10. Enter the appropriate `Tags` as `Name`, `Value` pairs.\n11. Click `Next: Review + Create`.\n12. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz monitor app-insights component create --app \u003capp name\u003e --resource-group \u003cresource group name\u003e --location \u003clocation\u003e --kind \"web\" --retention-time \u003cINT days to retain logs\u003e --workspace \u003clog analytics workspace ID\u003e -- subscription \u003csubscription ID\u003e\n```\n\n### From PowerShell\n\n```bash\nNew-AzApplicationInsights -Kind \"web\" -ResourceGroupName \u003cresource group name\u003e -Name \u003capp insights name\u003e -location \u003clocation\u003e -RetentionInDays \u003cINT days to retain logs\u003e -SubscriptionID \u003csubscription ID\u003e -WorkspaceResourceId \u003clog analytics workspace ID\u003e\n```\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_3"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_3",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring"
    ],
    "control_id": "azure_compliance.control.cis_v200_5_4",
    "description": "Resource Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself; for example, reading or updating a secret from a Key Vault.",
    "title": "5.4 Ensure that Azure Monitor Resource Logging is Enabled for All Services that Support it",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "5.4",
      "cis_level": "1",
      "cis_section_id": "5",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Monitor"
    },
    "documentation": "## Description\n\nResource Logs capture activity to the data access plane while the Activity log is a subscription-level log for the control plane. Resource-level diagnostic logs provide insight into operations that were performed within that resource itself; for example, reading or updating a secret from a Key Vault. Currently, 95 Azure resources support Azure Monitoring (See the more information section for a complete list), including Network Security Groups, Load Balancers, Key Vault, AD, Logic Apps, and CosmosDB. The content of these logs varies by resource type.\n\nA number of back-end services were not configured to log and store Resource Logs for certain activities or for a sufficient length. It is crucial that monitoring is correctly configured to log all relevant activities and retain those logs for a sufficient length of time. Given that the mean time to detection in an enterprise is 240 days, a minimum retention period of two years is recommended.\n\nA lack of monitoring reduces the visibility into the data plane, and therefore an organization's ability to detect reconnaissance, authorization attempts or other malicious activity. Unlike Activity Logs, Resource Logs are not enabled by default. Specifically, without monitoring it would be impossible to tell which entities had accessed a data store that was breached. In addition, alerts for failed attempts to access APIs for Web Services or Databases are only possible when logging is enabled.\n\n## Remediation\n\nAzure Subscriptions should log every access and operation for all resources.\n\nLogs should be sent to Storage and a Log Analytics Workspace or equivalent third-party system. Logs should be kept in readily-accessible storage for a minimum of one year, and then moved to inexpensive cold storage for a duration of time as necessary. If retention policies are set but storing logs in a Storage Account is disabled (for example, if only Event Hubs or Log Analytics options are selected), the retention policies have no effect. Enable all monitoring at first, and then be more aggressive moving data to cold storage if the volume of data becomes a cost concern.\n\n### From Azure Portal\n\nThe specific steps for configuring resources within the Azure console vary depending on resource, but typically the steps are:\n\n1. Go to the resource\n2. Click on Diagnostic settings\n3. In the blade that appears, click \"Add diagnostic setting\"\n4. Configure the diagnostic settings\n5. Click on Save\n\n### From Azure CLI\n\nFor each `resource`, run the following making sure to use a `resource` appropriate JSON encoded `category` for the `--logs` option.\n\n```bash\naz monitor diagnostic-settings create --name \u003cdiagnostic settings name\u003e -- resource \u003cresource ID\u003e --logs \"[{category:\u003cresource specific category\u003e,enabled:true,rentention-policy:{enabled:true,days:180}}]\" --metrics \"[{category:AllMetrics,enabled:true,retention- policy:{enabled:true,days:180}}]\" \u003c[--event-hub \u003cevent hub ID\u003e --event-hub- rule \u003cevent hub auth rule ID\u003e | --storage-account \u003cstorage account ID\u003e |-- workspace \u003clog analytics workspace ID\u003e | --marketplace-partner-id \u003cfull resource ID of third-party solution\u003e]\u003e\n```\n\n### From PowerShell\n\nCreate the `log` settings object\n\n```bash\n$logSettings = @()\n$logSettings += New-AzDiagnosticSettingLogSettingsObject -Enabled $true - RetentionPolicyDay 180 -RetentionPolicyEnabled $true -Category \u003cresource specific category\u003e\n$logSettings += New-AzDiagnosticSettingLogSettingsObject -Enabled $true - RetentionPolicyDay 180 -RetentionPolicyEnabled $true -Category \u003cresource specific category number 2\u003e\n```\n\nCreate the `metric` settings object\n\n```bash\n$metricSettings = @()\n$metricSettings += New-AzDiagnosticSettingMetricSettingsObject -Enabled $true -RetentionPolicyDay 180 -RetentionPolicyEnabled $true -Category AllMetrics\n```\n\nCreate the diagnostic setting for a specific resource\n\n```bash\nNew-AzDiagnosticSetting -Name \"\u003cdiagnostic settings name\u003e\" -ResourceId \u003cresource ID\u003e -Log $logSettings -Metric $metricSettings\n```\n\n### Default Value\n\nBy default, Azure Monitor Resource Logs are 'Disabled' for all resources.",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)"
    ],
    "control_id": "azure_compliance.control.network_lb_no_basic_sku",
    "description": "The use of Basic or Free SKUs in Azure whilst cost effective have significant limitations in terms of what can be monitored and what support can be realized from Microsoft. Typically, these SKU’s do not have a service SLA and Microsoft will usually refuse to provide support for them. Consequently Basic/Free SKUs should never be used for production workloads.",
    "title": "Network load balancers should use standard SKUs as a minimum",
    "tags": {
      "service": "Azure/Network"
    },
    "documentation": "",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_5",
    "executable": false
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)"
    ],
    "control_id": "azure_compliance.control.network_public_ip_no_basic_sku",
    "description": "The use of Basic or Free SKUs in Azure whilst cost effective have significant limitations in terms of what can be monitored and what support can be realized from Microsoft. Typically, these SKU’s do not have a service SLA and Microsoft will usually refuse to provide support for them. Consequently Basic/Free SKUs should never be used for production workloads.",
    "title": "Network public IPs should use standard SKUs as a minimum",
    "tags": {
      "service": "Azure/Network"
    },
    "documentation": "",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_5",
    "executable": false
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)"
    ],
    "control_id": "azure_compliance.control.network_virtual_network_gateway_no_basic_sku",
    "description": "The use of Basic or Free SKUs in Azure whilst cost effective have significant limitations in terms of what can be monitored and what support can be realized from Microsoft. Typically, these SKU’s do not have a service SLA and Microsoft will usually refuse to provide support for them. Consequently Basic/Free SKUs should never be used for production workloads.",
    "title": "Virtual network gateways should use standard SKUs as a minimum",
    "tags": {
      "service": "Azure/Network"
    },
    "documentation": "",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_5",
    "executable": false
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 5 Logging and Monitoring \u003e 5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)",
    "category_hierarchy": [
      "CIS v2.0.0",
      "5 Logging and Monitoring",
      "5.5 Ensure that SKU Basic/Consumption is not used on artifacts that need to be monitored (Particularly for Production Workloads)"
    ],
    "control_id": "azure_compliance.control.redis_cache_no_basic_sku",
    "description": "The use of Basic or Free SKUs in Azure whilst cost effective have significant limitations in terms of what can be monitored and what support can be realized from Microsoft. Typically, these SKU’s do not have a service SLA and Microsoft will usually refuse to provide support for them. Consequently Basic/Free SKUs should never be used for production workloads.",
    "title": "Azure Cache for Redis should use standard SKUs as a minimum",
    "tags": {
      "service": "Azure/Redis"
    },
    "documentation": "",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_5",
      "azure_compliance.benchmark.cis_v200_5_5"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_5/azure_compliance.benchmark.cis_v200_5_5",
    "executable": false
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_1",
    "description": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
    "title": "6.1 Ensure that RDP access from the Internet is evaluated and restricted",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.1",
      "cis_level": "1",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nNetwork security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nThe potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.\n\n## Remediation\n\nWhere RDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\n\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\n\n1. [ExpressRoute](https://docs.microsoft.com/en-us/azure/expressroute/)\n2. [Site-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal)\n3. [Point-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)\n\n\n### Default Value\n\nBy default, RDP access from internet is not `enabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_2",
    "description": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
    "title": "6.2 Ensure that SSH access from the Internet is evaluated and restricted",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.2",
      "cis_level": "1",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nNetwork security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nThe potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.\n\n## Remediation\n\nWhere SSH is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\n\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\n\n1. [ExpressRoute](https://docs.microsoft.com/en-us/azure/expressroute/)\n2. [Site-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal)\n3. [Point-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)\n\n### Default Value\n\nBy default, SSH access from internet is not `enabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_3",
    "description": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
    "title": "6.3 Ensure that UDP access from the Internet is evaluated and restricted",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.3",
      "cis_level": "1",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nNetwork security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.\n\nThe potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.\n\n## Remediation\n\nWhere UDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\n\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\n\n1. [ExpressRoute](https://docs.microsoft.com/en-us/azure/expressroute/)\n2. [Site-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal)\n3. [Point-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)\n\n\n### Default Value\n\nBy default, UDP access from internet is not `enabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_4",
    "description": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.",
    "title": "6.4 Ensure that HTTP(S) access from the Internet is evaluated and restricted",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.4",
      "cis_level": "1",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nNetwork security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.\n\nThe potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.\n\n## Remediation\n\nWhere HTTP(S) is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated.\n\nFor internal access to relevant resources, configure an encrypted network tunnel such as:\n\n1. [ExpressRoute](https://docs.microsoft.com/en-us/azure/expressroute/)\n2. [Site-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/tutorial-site-to-site-portal)\n3. [Point-to-site VPN](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-point-to-site-resource-manager-portal)\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_5",
    "description": "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.",
    "title": "6.5 Ensure that Network Security Group Flow Log retention period is 'greater than 90 days'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.5",
      "cis_level": "2",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nNetwork Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.\n\nFlow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.\n\n## Remediation\n\n### From Azure Console\n\n1. Go to `Network Watcher`.\n2. Select `NSG flow logs` blade in the Logs section.\n3. Select each Network Security Group from the list.\n4. Ensure `Status` is set to `On`.\n5. Ensure `Retention(days)` setting `greater than 90 days`.\n6. Select your storage account in the `Storage account` field.\n7. Select `Save`.\n\n### From Azure CLI\n\nEnable the `NSG flow logs` and set the Retention (days) to greater than or equal to 90 days.\n\n```bash\naz network watcher flow-log configure --nsg \u003cNameorID of the Network Security Group\u003e --enabled true --resource-group \u003cresourceGroupName\u003e --retention 91 -- storage-account \u003cNameorID of the storage account to save flow logs\u003e\n```\n\n### Default Value\n\nBy default, Network Security Group Flow Logs are `disabled`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_6",
    "description": "Enable Network Watcher for Azure subscriptions.",
    "title": "6.6 Ensure that Network Watcher is 'Enabled'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.6",
      "cis_level": "2",
      "cis_section_id": "6",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nEnable Network Watcher for Azure subscriptions.\n\nNetwork diagnostic and visualization tools available with Network Watcher help users understand, diagnose, and gain insights to the network in Azure.\n\n## Remediation\n\nOpting out of Network Watcher automatic enablement is a permanent change. Once you opt-out you cannot opt-in without contacting support.\n\n### Default Value\n\nNetwork Watcher is automatically enabled. When you create or update a virtual network in your subscription, Network Watcher will be enabled automatically in your Virtual Network's region. There is no impact to your resources or associated charge for automatically enabling Network Watcher.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 6 Networking",
    "category_hierarchy": [
      "CIS v2.0.0",
      "6 Networking"
    ],
    "control_id": "azure_compliance.control.cis_v200_6_7",
    "description": "Public IP Addresses provide tenant accounts with Internet connectivity for resources contained within the tenant. During the creation of certain resources in Azure, a Public IP Address may be created. All Public IP Addresses within the tenant should be periodically reviewed for accuracy and necessity.",
    "title": "6.7 Ensure that Public IP addresses are Evaluated on a Periodic Basis",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "6.7",
      "cis_level": "1",
      "cis_section_id": "6",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Network"
    },
    "documentation": "## Description\n\nPublic IP Addresses provide tenant accounts with Internet connectivity for resources contained within the tenant. During the creation of certain resources in Azure, a Public IP Address may be created. All Public IP Addresses within the tenant should be periodically reviewed for accuracy and necessity.\n\nPublic IP Addresses allocated to the tenant should be periodically reviewed for necessity. Public IP Addresses that are not intentionally assigned and controlled present a publicly facing vector for threat actors and significant risk to the tenant.\n\n## Remediation\n\nRemediation will vary significantly depending on your organization's security requirements for the resources attached to each individual Public IP address.\n\n### Default Value\n\nDuring Virtual Machine and Application creation, a setting may create and attach a public IP.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_6"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_6",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_1",
    "description": "The Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Internet. The Azure Bastion service provides this access using TLS over 443/TCP, and subscribes to hardened configurations within an organization's Azure Active Directory service.",
    "title": "7.1 Ensure an Azure Bastion Host Exists",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.1",
      "cis_level": "2",
      "cis_section_id": "7",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nThe Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Internet. The Azure Bastion service provides this access using TLS over 443/TCP, and subscribes to hardened configurations within an organization's Azure Active Directory service.\n\nThe Azure Bastion service allows organizations a more secure means of accessing Azure Virtual Machines over the Internet without assigning public IP addresses to those Virtual Machines. The Azure Bastion service provides Remote Desktop Protocol (RDP) and Secure Shell (SSH) access to Virtual Machines using TLS within a web browser, thus preventing organizations from opening up 3389/TCP and 22/TCP to the Internet on Azure Virtual Machines. Additional benefits of the Bastion service includes Multi-Factor Authentication, Conditional Access Policies, and any other hardening measures configured within Azure Active Directory using a central point of access.\n\n## Remediation\n\n### From Azure Portal\n\n1. Click on `Bastions`.\n2. Select the `Subscription`.\n3. Select the `Resource group`.\n4. Type a `Name` for the new Bastion host.\n5. Select a `Region`.\n6. Choose `Standard` next to `Tier`.\n7. Use the slider to set the `Instance count`.\n8. Select the `Virtual network` or `Create new`.\n9. Select the `Subnet` named `AzureBastionSubnet`. Create a `Subnet` named `AzureBastionSubnet` using a `/26` CIDR range if it doesn't already exist.\n10. Selct the appropriate `Public IP address` option.\n11. If `Create new` is selected for the `Public IP address` option, provide a `Public IP address name`.\n12. If Use existing is selected for Public IP address option, select an IP address from `Choose public IP address`.\n13. Click `Next: Tags \u003e`.\n14. Configure the appropriate `Tags`.\n15. Click `Next: Advanced \u003e`.\n16. Select the appropriate `Advanced` options.\n17. Click `Next: Review + create \u003e`.\n18. Click `Create`.\n\n### From Azure CLI\n\n```bash\naz network bastion create --location \u003clocation\u003e --name \u003cname of bastion host\u003e --public-ip-address \u003cpublic IP address name or ID\u003e --resource-group \u003cresource group name or ID\u003e --vnet-name \u003cvirtual network containing subnet called \"AzureBastionSubnet\"\u003e --scale-units \u003cinteger\u003e --sku Standard [--disable-copy- paste true|false] [--enable-ip-connect true|false] [--enable-tunneling true|false]\n```\n\n### Using Powershell\n\nCreate the appropriate `Virtual network` settings and `Public IP Address` settings.\n\n```bash\n$subnetName = \"AzureBastionSubnet\"\n$subnet = New-AzVirtualNetworkSubnetConfig -Name $subnetName -AddressPrefix \u003cIP address range in CIDR notation making sure to use a /26\u003e\n$virtualNet = New-AzVirtualNetwork -Name \u003cvirtual network name\u003e - ResourceGroupName \u003cresource group name\u003e -Location \u003clocation\u003e -AddressPrefix \u003cIP address range in CIDR notation\u003e -Subnet $subnet\n$publicip = New-AzPublicIpAddress -ResourceGroupName \u003cresource group name\u003e - Name \u003cpublic IP address name\u003e -Location \u003clocation\u003e -AllocationMethod Dynamic -Sku Standard\n```\n\nCreate the `Azure Bastion` service using the information within the created variables from above.\n\n```bash\nNew-AzBastion -ResourceGroupName \u003cresource group name\u003e -Name \u003cbastion name\u003e - PublicIpAddress $publicip -VirtualNetwork $virtualNet -Sku \"Standard\" - ScaleUnit \u003cinteger\u003e\n```\n\n### Default Value\n\nBy default, the Azure Bastion service is not configured.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_2",
    "description": "Migrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration.",
    "title": "7.2 Ensure Virtual Machines are utilizing Managed Disks",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.2",
      "cis_level": "1",
      "cis_section_id": "7",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nMigrate blob-based VHDs to Managed Disks on Virtual Machines to exploit the default features of this configuration. The features include:\n\n1. Default Disk Encryption\n2. Resilience, as Microsoft will managed the disk storage and move around if underlying hardware goes faulty\n3. Reduction of costs over storage accounts\n\nManaged disks are by default encrypted on the underlying hardware, so no additional encryption is required for basic protection. It is available if additional encryption is required. Managed disks are by design more resilient that storage accounts.\n\nFor ARM-deployed Virtual Machines, Azure Adviser will at some point recommend moving VHDs to managed disks both from a security and cost management perspective.\n\n## Remediation\n\n### From Azure Portal\n\n1. Using the search feature, go to `Virtual Machines`.\n2. Select the virtual machine you would like to convert.\n3. Select `Disks` in the menu for the VM.\n4. At the top select `Migrate to managed disks`.\n5. You may follow the prompts to convert the disk and finish by selecting `Migrate` to start the process.\n\n**NOTE** VMs will be stopped and restarted after migration is complete.\n\n### From PowerShell\n\n```bash\nStop-AzVM -ResourceGroupName $rgName -Name $vmName -Force ConvertTo-AzVMManagedDisk -ResourceGroupName $rgName -VMName $vmName Start-AzVM -ResourceGroupName $rgName -Name $vmName\n```\n\n### Default Value\n\nManaged disks or are an option upon the creation of VMs.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_3",
    "description": "Ensure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption(SSE).",
    "title": "7.3 Ensure that 'OS and Data' disks are encrypted with Customer Managed Key (CMK)",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.3",
      "cis_level": "2",
      "cis_section_id": "7",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nEnsure that OS disks (boot volumes) and data disks (non-boot volumes) are encrypted with CMK (Customer Managed Keys). Customer Managed keys can be either ADE or Server Side Encryption (SSE).\n\nEncrypting the IaaS VM's OS disk (boot volume) and Data disks (non-boot volume) ensures that the entire content is fully unrecoverable without a key, thus protecting the volume from unwanted reads. PMK (Platform Managed Keys) are enabled by default in Azure-managed disks and allow encryption at rest. CMK is recommended because it gives the customer the option to control which specific keys are used for the encryption and decryption of the disk. The customer can then change keys and increase security by disabling them instead of relying on the PMK key that remains unchanging. There is also the option to increase security further by using automatically rotating keys so that access to disk is ensured to be limited. Organizations should evaluate what their security requirements are, however, for the data stored on the disk. For high-risk data using CMK is a must, as it provides extra steps of security. If the data is low risk, PMK is enabled by default and provides sufficient data security.\n\n## Remediation\n\n### From Azure Portal\n\n**Note:** Disks must be detached from VMs to have encryption changed.\n\n1. Go to `Virtual machines`.\n2. For each virtual machine, go to `Settings`.\n3. Click on `Disks`.\n4. Click the ellipsis (...), then click `Detach` to detach the disk from the VM.\n5. Now search for `Disks` and locate the unattached disk.\n6. Click the disk then select `Encryption`.\n7. Change your encryption type, then select your encryption set.\n8. Click `Save`.\n9. Go back to the VM and re-attach the disk.\n\n### From PowerShell\n\n```bash\n$KVRGname = 'MyKeyVaultResourceGroup';\n$VMRGName = 'MyVirtualMachineResourceGroup';\n$vmName = 'MySecureVM';\n$KeyVaultName = 'MySecureVault';\n$KeyVault = Get-AzKeyVault -VaultName $KeyVaultName -ResourceGroupName\n$KVRGname;\n$diskEncryptionKeyVaultUrl = $KeyVault.VaultUri; $KeyVaultResourceId = $KeyVault.ResourceId;\nSet-AzVMDiskEncryptionExtension -ResourceGroupName $VMRGname -VMName $vmName -DiskEncryptionKeyVaultUrl $diskEncryptionKeyVaultUrl - DiskEncryptionKeyVaultId $KeyVaultResourceId;\n```\n\n**NOTE:** During encryption it is likely that a reboot will be required. It may take up to 15 minutes to complete the process.\n\n**NOTE 2:** This may differ for Linux machines as you may need to set the `-skipVmBackup` parameter\n\n### Default Value\n\nBy default, Azure disks are encrypted using SSE with PMK.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_4",
    "description": "Ensure that unattached disks in a subscription are encrypted with a Customer Managed Key (CMK).",
    "title": "7.4 Ensure that 'Unattached disks' are encrypted with 'Customer Managed Key' (CMK)",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.4",
      "cis_level": "2",
      "cis_section_id": "7",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nEnsure that unattached disks in a subscription are encrypted with a Customer Managed Key (CMK).\n\nManaged disks are encrypted by default with Platform-managed keys. Using Customer- managed keys may provide an additional level of security or meet an organization's regulatory requirements. Encrypting managed disks ensures that its entire content is fully unrecoverable without a key and thus protects the volume from unwarranted reads. Even if the disk is not attached to any of the VMs, there is always a risk where a compromised user account with administrative access to VM service can mount/attach these data disks, which may lead to sensitive information disclosure and tampering.\n\n## Remediation\n\nIf data stored in the disk is no longer useful, refer to Azure documentation to delete unattached data disks at:\n\n```bash\n-https://docs.microsoft.com/en-us/rest/api/compute/disks/delete -https://docs.microsoft.com/en-us/cli/azure/disk?view=azure-cli-latest#az- disk-delete\n```\n\nIf data stored in the disk is important, To encrypt the disk refer azure documentation at:\n\n```bash\n-https://docs.microsoft.com/en-us/azure/virtual-machines/disks-enable- customer-managed-keys-portal\n-https://docs.microsoft.com/en- us/rest/api/compute/disks/update#encryptionsettings\n```\n\n### Default Value\n\nBy default, managed disks are encrypted with a Platform-managed key.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_5",
    "description": "For added security, only install organization-approved extensions on VMs.",
    "title": "7.5 Ensure that Only Approved Extensions Are Installed",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.5",
      "cis_level": "1",
      "cis_section_id": "7",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nFor added security, only install organization-approved extensions on VMs.\n\nAzure virtual machine extensions are small applications that provide post-deployment configuration and automation tasks on Azure virtual machines. These extensions run with administrative privileges and could potentially access anything on a virtual machine. The Azure Portal and community provide several such extensions. Each organization should carefully evaluate these extensions and ensure that only those that are approved for use are actually implemented.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Virtual machines`.\n2. For each virtual machine, go to `Settings`.\n3. Click on `Extensions + applications`.\n4. If there are unapproved extensions, uninstall them.\n\n### From Azure CLI\n\nFrom the audit command identify the unapproved extensions, and use the below CLI command to remove an unapproved extension attached to VM.\n\n```bash\naz vm extension delete --resource-group \u003cresourceGroupName\u003e --vm-name \u003cvmName\u003e --name \u003cextensionName\u003e\n```\n\n### From PowerShell\n\nFor each VM and each insecure extension from the Audit Procedure run the following command.\n\n```bash\nRemove-AzVMExtension -ResourceGroupName \u003cResourceGroupName\u003e -Name \u003cExtensionName\u003e -VMName \u003cVirtualMachineName\u003e\n```\n\n### Default Value\n\nBy default, no extensions are added to the virtual machines.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_6",
    "description": "Install endpoint protection for all virtual machines.",
    "title": "7.6 Ensure that Endpoint Protection for all Virtual Machines is installed",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.6",
      "cis_level": "2",
      "cis_section_id": "7",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\nInstall endpoint protection for all virtual machines.\n\nInstalling endpoint protection systems (like anti-malware for Azure) provides for real- time protection capability that helps identify and remove viruses, spyware, and other malicious software. These also offer configurable alerts when known-malicious or unwanted software attempts to install itself or run on Azure systems.\n\n## Remediation\n\nFollow Microsoft Azure documentation to install endpoint protection from the security center. Alternatively, you can employ your own endpoint protection tool for your OS.\n\n### Default Value\n\nBy default Endpoint Protection is disabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 7 Virtual Machines",
    "category_hierarchy": [
      "CIS v2.0.0",
      "7 Virtual Machines"
    ],
    "control_id": "azure_compliance.control.cis_v200_7_7",
    "description": "VHD (Virtual Hard Disks) are stored in blob storage and are the old-style disks that were attached to Virtual Machines. The blob VHD was then leased to the VM. By default, storage accounts are not encrypted, and Microsoft Defender will then recommend that the OS disks should be encrypted. Storage accounts can be encrypted as a whole using PMK or CMK. This should be turned on for storage accounts containing VHDs.",
    "title": "7.7 Ensure that VHDs are Encrypted",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "7.7",
      "cis_level": "2",
      "cis_section_id": "7",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/Compute"
    },
    "documentation": "## Description\n\n**NOTE: This is a legacy recommendation. Managed Disks are encrypted by default and recommended for all new VM implementations.**\n\nVHD (Virtual Hard Disks) are stored in blob storage and are the old-style disks that were attached to Virtual Machines. The blob VHD was then leased to the VM. By default, storage accounts are not encrypted, and Microsoft Defender will then recommend that the OS disks should be encrypted. Storage accounts can be encrypted as a whole using PMK or CMK. This should be turned on for storage accounts containing VHDs.\n\nWhile it is recommended to use Managed Disks which are encrypted by default, \"legacy\" VHDs may exist for a variety of reasons and may need to remain in VHD format. VHDs are not encrypted by default, so this recommendation intends to address the security of these disks. In these niche cases, VHDs should be encrypted using the procedures in this recommendation to encrypt and protect the data content.\n\nIf a virtual machine is using a VHD and can be converted to a managed disk, instructions for this procedure can be found in the resources section of this recommendation under the title \"Convert VHD to Managed Disk.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the `storage account` that you wish to encrypt.\n2. Select `encryption`.\n3. Select the `encryption type` that you wish to use.\n\nIf you wish to use a Microsoft-managed key (the default), you can save at this point and encryption will be applied to the account.\n\nIf you select `Customer-managed keys`, it will ask for the location of the key (The default is an Azure Key Vault) and the key name.\n\nOnce these are captured, save the configuration and the account will be encrypted using the provided key.\n\n### From Azure CLI\n\n**Create the Key Vault**\n\n```bash\naz keyvault create --name \u003cname\u003e --resource-group \u003cresourceGroup\u003e --location \u003clocation\u003e --enabled-for-disk-encryption\n```\n\n**Encrypt the disk and store the key in Key Vault**\n\n```bash\naz vm encryption enable -g \u003cresourceGroup\u003e --name \u003cname\u003e --disk-encryption- keyvault myKV\n```\n\n### From PowerShell\n\nThis process uses a Key Vault to store the keys\n\n**Create the Key Vault**\n\n```bash\nNew-AzKeyvault -name \u003cname\u003e -ResourceGroupName \u003cresourceGroup\u003e -Location \u003clocation\u003e -EnabledForDiskEncryption\n```\n\n**Encrypt the disk and store the key in Key Vault**\n\n```bash\n$KeyVault = Get-AzKeyVault -VaultName \u003cname\u003e -ResourceGroupName \u003cresourceGroup\u003e\nSet-AzVMDiskEncryptionExtension -ResourceGroupName \u003cresourceGroup\u003e -VMName \u003cname\u003e -DiskEncryptionKeyVaultUrl $KeyVault.VaultUri - DiskEncryptionKeyVaultId $KeyVault.ResourceId\n```\n\n### Default Value\n\nThe default value for encryption is \"NO Encryption\"\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_7"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_7",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_1",
    "description": "Ensure that all Keys in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
    "title": "8.1 Ensure that the Expiration Date is set for all Keys in RBAC Key Vaults",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.1",
      "cis_level": "1",
      "cis_section_id": "8",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnsure that all Keys in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nAzure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The `exp` (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for encryption of new data, wrapping of new keys, and signing. By default, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys to help enforce the key rotation. This ensures that the keys cannot be used beyond their assigned lifetimes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Key vaults`.\n2. For each Key vault, click on `Keys`.\n3. In the main pane, ensure that an appropriate `Expiration date` is set for any keys that are `Enabled`.\n\n### From Azure CLI\n\nUpdate the `Expiration date` for the secret using the below command:\n\n```bash\naz keyvault key set-attributes --name \u003ckeyName\u003e --vault-name \u003cvaultName\u003e -- expires Y-m-d'T'H:M:S'Z'\n```\n\n**Note:** To view the expiration date on all keys in a Key Vault using Microsoft API, the \"List\" Key permission is required.\n\nTo update the expiration date for the keys:\n1. Go to the Key vault, click on Access Control (IAM).\n2. Click on Add role assignment and assign the role of Key Vault Crypto Officer to the appropriate user.\n\n### From PowerShell\n\n```bash\nSet-AzKeyVaultKeyAttribute -VaultName \u003cVaultName\u003e -Name \u003cKeyName\u003e -Expires \u003cDateTime\u003e\n```\n\n### Default Value\n\nBy default, keys do not expire.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_2",
    "description": "Ensure that all Keys in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
    "title": "8.2 Ensure that the Expiration Date is set for all Keys in Non-RBAC Key Vaults",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.2",
      "cis_level": "1",
      "cis_section_id": "8",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnsure that all Keys in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nAzure Key Vault enables users to store and use cryptographic keys within the Microsoft Azure environment. The `exp` (expiration date) attribute identifies the expiration date on or after which the key MUST NOT be used for a cryptographic operation. By default, keys never expire. It is thus recommended that keys be rotated in the key vault and set an explicit expiration date for all keys. This ensures that the keys cannot be used beyond their assigned lifetimes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Key vaults`.\n2. For each Key vault, click on `Keys`.\n3. In the main pane, ensure that an appropriate `Expiration date` is set for any keys that are `Enabled`.\n4. For each enabled key, ensure that an appropriate `Expiration date` is set.\n\n### From Azure CLI\n\nUpdate the `Expiration date` for the secret using the below command:\n\n```bash\naz keyvault key set-attributes --name \u003ckeyName\u003e --vault-name \u003cvaultName\u003e -- expires Y-m-d'T'H:M:S'Z'\n```\n\n**Note:** To view the expiration date on all keys in a Key Vault using Microsoft API, the `List` Key permission is required.\n\nTo update the expiration date for the keys:\n1. Go to Key vault, click on `Access policies`.\n2. Click on `Create` and add an access policy with the `Update` permission (in the Key Permissions - Key Management Operations section).\n\n### From PowerShell\n\n```bash\nSet-AzKeyVaultKeyAttribute -VaultName \u003cVault Name\u003e -Name \u003cKey Name\u003e -Expires \u003cDateTime\u003e\n```\n\n### Default Value\n\nBy default, keys do not expire.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_3",
    "description": "Ensure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
    "title": "8.3 Ensure that the Expiration Date is set for all Secrets in RBAC Key Vaults",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.3",
      "cis_level": "1",
      "cis_section_id": "8",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnsure that all Secrets in Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nThe Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Key vaults`.\n2. For each Key vault, click on `Secrets`.\n3. In the main pane, ensure that the status of the secret is `Enabled`.\n4. For each enabled secret, ensure that an appropriate `Expiration dat`e is set.\n\n### From Azure CLI\n\nUpdate the `Expiration date` for the secret using the below command:\n\n```bash\naz keyvault secret set-attributes --name \u003csecretName\u003e --vault-name \u003cvaultName\u003e --expires Y-m-d'T'H:M:S'Z'\n```\n\n**Note** To view the expiration date on all secrets in a Key Vault using Microsoft API, the `List` Key permission is required.\n\nTo update the expiration date for the secrets:\n1. Go to the Key vault, click on `Access Control (IAM)`.\n2. Click on `Add role assignment` and assign the role of `Key Vault Secrets Officer` to the appropriate user.\n\n### From Powershell\n\n```bash\nSet-AzKeyVaultSecretAttribute -VaultName \u003cVault Name\u003e -Name \u003cSecret Name\u003e - Expires \u003cDateTime\u003e\n```\n\n### Default Value\n\nBy default, secrets do not expire.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_4",
    "description": "Ensure that all Secrets in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.",
    "title": "8.4 Ensure that the Expiration Date is set for all Secrets in Non- RBAC Key Vaults",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.4",
      "cis_level": "1",
      "cis_section_id": "8",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nEnsure that all Secrets in Non Role Based Access Control (RBAC) Azure Key Vaults have an expiration date set.\n\nThe Azure Key Vault enables users to store and keep secrets within the Microsoft Azure environment. Secrets in the Azure Key Vault are octet sequences with a maximum size of 25k bytes each. The exp (expiration date) attribute identifies the expiration date on or after which the secret MUST NOT be used. By default, secrets never expire. It is thus recommended to rotate secrets in the key vault and set an explicit expiration date for all secrets. This ensures that the secrets cannot be used beyond their assigned lifetimes.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to `Key vaults`.\n2. For each Key vault, click on `Secrets`.\n3. In the main pane, ensure that the status of the secret is `Enabled`.\n4. Set an appropriate `Expiration date` on all secrets.\n\n### From Azure CLI\n\nUpdate the `Expiration date` for the secret using the below command:\n\n```bash\naz keyvault secret set-attributes --name \u003csecretName\u003e --vault-name \u003cvaultName\u003e --expires Y-m-d'T'H:M:S'Z'\n```\n\n**Note** To view the expiration date on all secrets in a Key Vault using Microsoft API, the `List` Key permission is required.\n\nTo update the expiration date for the secrets:\n1. Go to the Key vault, click on `Access policies`.\n2. Click on `Create` and add an access policy with the `Update` permission (in the Secret Permissions - Secret Management Operations section).\n\n### From Powershell\n\nFor each Key vault with the `EnableRbacAuthorization` setting set to `False` or empty, run the following command.\n\n```bash\nSet-AzKeyVaultSecret -VaultName \u003cVault Name\u003e -Name \u003cSecret Name\u003e -Expires \u003cDateTime\u003e\n```\n\n### Default Value\n\nBy default, secrets do not expire.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_5",
    "description": "The key vault contains object keys, secrets and certificates. Accidental unavailability of a key vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the key vault objects. It is recommended the key vault be made recoverable by enabling the \"Do Not Purge\" and \"Soft Delete\" functions.",
    "title": "8.5 Ensure the Key Vault is Recoverable",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.5",
      "cis_level": "1",
      "cis_section_id": "8",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nThe Key Vault contains object keys, secrets, and certificates. Accidental unavailability of a Key Vault can cause immediate data loss or loss of security functions (authentication, validation, verification, non-repudiation, etc.) supported by the Key Vault objects.\n\nIt is recommended the Key Vault be made recoverable by enabling the \"Do Not Purge\" and \"Soft Delete\" functions. This is in order to prevent loss of encrypted data, including storage accounts, SQL databases, and/or dependent services provided by Key Vault objects (Keys, Secrets, Certificates) etc. This may happen in the case of accidental deletion by a user or from disruptive activity by a malicious user.\n\n**WARNING:** A current limitation of the soft-delete feature across all Azure services is role assignments disappearing when Key Vault is deleted. All role assignments will need to be recreated after recovery.\n\nThere could be scenarios where users accidentally run delete/purge commands on Key Vault or an attacker/malicious user deliberately does so in order to cause disruption. Deleting or purging a Key Vault leads to immediate data loss, as keys encrypting data and secrets/certificates allowing access/services will become non-accessible. There are 2 Key Vault properties that play a role in permanent unavailability of a Key Vault:\n\n1. `enableSoftDelete`:\n\nSetting this parameter to \"true\" for a Key Vault ensures that even if Key Vault is deleted, Key Vault itself or its objects remain recoverable for the next 90 days. Key Vault/objects can either be recovered or purged (permanent deletion) during those 90 days. If no action is taken, key vault and its objects will subsequently be purged.\n\n2. `enablePurgeProtection`:\n\nenableSoftDelete only ensures that Key Vault is not deleted permanently and will be recoverable for 90 days from date of deletion. However, there are scenarios in which the Key Vault and/or its objects are accidentally purged and hence will not be recoverable. Setting enablePurgeProtection to \"true\" ensures that the Key Vault and its objects cannot be purged.\n\nEnabling both the parameters on Key Vaults ensures that Key Vaults and their objects cannot be deleted/purged permanently.\n\n## Remediation\n\nTo enable \"Do Not Purge\" and \"Soft Delete\" for a Key Vault:\n\n### From Azure Portal\n\n1. Go to `Key Vaults`.\n2. For each Key Vault.\n3. Click `Properties`.\n4. Ensure the status of soft-delete reads `Soft delete has been enabled on this key vault`.\n5. At the bottom of the page, click 'Enable Purge Protection' Note, once enabled you cannot disable it.\n\n### From Azure CLI\n\n```bash\naz resource update --id /subscriptions/xxxxxx-xxxx-xxxx-xxxx- xxxxxxxxxxxx/resourceGroups/\u003cresourceGroupName\u003e/providers/Microsoft.KeyVault /vaults/\u003ckeyVaultName\u003e --set properties.enablePurgeProtection=true properties.enableSoftDelete=true\n```\n\n### From Powershell\n\n```bash\nUpdate-AzKeyVault -VaultName \u003cvaultName -ResourceGroupName \u003cresourceGroupName -EnablePurgeProtection\n```\n\n### Default Value\n\nWhen a new Key Vault is created, both the parameters `enableSoftDelete` and `enablePurgeProtection` are set to `null`, disabling both the features.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_6",
    "description": "Role assignments disappear when a Key Vault has been deleted (soft- delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.",
    "title": "8.6 Enable Role Based Access Control for Azure Key Vault",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.6",
      "cis_level": "2",
      "cis_section_id": "8",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\n**WARNING:** Role assignments disappear when a Key Vault has been deleted (soft- delete) and recovered. Afterwards it will be required to recreate all role assignments. This is a limitation of the soft-delete feature across all Azure services.\n\nThe new RBAC permissions model for Key Vaults enables a much finer grained access control for key vault secrets, keys, certificates, etc., than the vault access policy. This in turn will permit the use of privileged identity management over these roles, thus securing the key vaults with JIT Access management.\n\n## Remediation\n\n### From Azure Portal\n\nKey Vaults can be configured to use `Azure role-based access control` on creation. For existing Key Vaults:\n\n1. From Azure Home open the Portal Menu in the top left corner.\n2. Select `Key Vaults`.\n3. Open every Key Vault you wish to audit.\n4. Select `Access configuration`.\n5. Set the Permission model radio button to `Azure role-based access control`, taking note of the warning message.\n6. Click `Save`.\n7. Select `Access Control (IAM)`.\n8. Select the `Role Assignments` tab.\n9. Reapply permissions as needed to groups or users.\n\n### Default Value\n\nThe default value for Access control in Key Vaults is Vault Policy.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_7",
    "description": "Private endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.",
    "title": "8.7 Ensure that Private Endpoints are Used for Azure Key Vault",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.7",
      "cis_level": "2",
      "cis_section_id": "8",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nPrivate endpoints will secure network traffic from Azure Key Vault to the resources requesting secrets and keys.\n\nPrivate endpoints will keep network requests to Azure Key Vault limited to the endpoints attached to the resources that are whitelisted to communicate with each other. Assigning the Key Vault to a network without an endpoint will allow other resources on that network to view all traffic from the Key Vault to its destination. In spite of the complexity in configuration, this is recommended for high security secrets.\n\n## Remediation\n\nPlease see the additional information about the requirements needed before starting this remediation procedure.\n\n### From Azure Portal\n\n1. From Azure Home open the Portal Menu in the top left.\n2. Select Key Vaults.\n3. Select a Key Vault to audit.\n4. Select `Networking` in the left column.\n5. Select `Private endpoint connections` from the top row.\n6. Select `+ Create.`\n7. Select the subscription the Key Vault is within, and other desired configuration.\n8. Select `Next`.\n9. For resource type select `Microsoft.KeyVault/vaults`.\n10. Select the Key Vault to associate the Private Endpoint with.\n11. Select `Next`.\n12. In the `Virtual Networking` field, select the network to assign the Endpoint. 13.Select other configuration options as desired, including an existing or new application security group.\n13. Select `Next`.\n14. Select the private DNS the Private Endpoints will use.\n15. Select `Next`.\n16. Optionally add `Tags`.\n17. Select `Next : Review + Create`.\n18. Review the information and select `Create`. Follow the Audit Procedure to determine if it has successfully applied.\n19. Repeat steps 3-19 for each Key Vault.\n\n### From Azure CLI\n\n1. To create an end point, run the following command:\n\n```bash\naz network private-endpoint create --resource-group \u003cresourceGroup --vnet- name \u003cvnetName\u003e --subnet \u003csubnetName\u003e --name \u003cPrivateEndpointName\u003e -- private-connection-resource-id \"/subscriptions/\u003cAZURE SUBSCRIPTION ID\u003e/resourceGroups/\u003cresourceGroup\u003e/providers/Microsoft.KeyVault/vaults/\u003ckeyVa\nultName\u003e\" --group-ids vault --connection-name \u003cprivateLinkConnectionName\u003e -- location \u003cazureRegion\u003e --manual-request\n```\n\n2. To manually approve the end point request, run the following command:\n\n```bash\naz keyvault private-endpoint-connection approve --resource-group \u003cresourceGroup\u003e --vault-name \u003ckeyVaultName\u003e –name \u003cprivateLinkName\u003e\n```\n\n3. Determine the Private Endpoint's IP address to connect the Key Vault to the Private DNS you have previously created:\n\n4. Look for the property networkInterfaces then id; the value must be placed in the variable \u0026lt;privateEndpointNIC\u0026gt; within step 6.\n\n```bash\naz network private-endpoint show -g \u003cresourceGroupName\u003e -n \u003cprivateEndpointName\u003e\n```\n\n5. Look for the property networkInterfaces then id; the value must be placed on \u0026lt;privateEndpointNIC\u0026gt;  in step 6.\n\n```bash\naz network nic show --ids \u003cprivateEndpointName\u003e\n```\n\n6. Create a Private DNS record within the DNS Zone you created for the Private Endpoint:\n\n```bash\naz network private-dns record-set a add-record -g \u003cresourcecGroupName\u003e -z \"privatelink.vaultcore.azure.net\" -n \u003ckeyVaultName\u003e -a \u003cprivateEndpointNIC\u003e\n```\n\n7. nslookup the private endpoint to determine if the DNS record is correct:\n\n```bash\nnslookup \u003ckeyVaultName\u003e.vault.azure.net\nnslookup \u003ckeyVaultName\u003e.privatelink.vaultcore.azure.n\n```\n\n### Default Value\n\nBy default, Private Endpoints are not enabled for any services within Azure.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 8 Key Vault",
    "category_hierarchy": [
      "CIS v2.0.0",
      "8 Key Vault"
    ],
    "control_id": "azure_compliance.control.cis_v200_8_8",
    "description": "Automatic Key Rotation is available in Public Preview. The currently supported applications are Key Vault, Managed Disks, and Storage accounts accessing keys within Key Vault. The number of supported applications will incrementally increased.",
    "title": "8.8 Ensure Automatic Key Rotation is Enabled Within Azure Key Vault for the Supported Services",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "8.8",
      "cis_level": "2",
      "cis_section_id": "8",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/KeyVault"
    },
    "documentation": "## Description\n\nAutomatic Key Rotation is available in Public Preview. The currently supported applications are Key Vault, Managed Disks, and Storage accounts accessing keys within Key Vault. The number of supported applications will incrementally increased.\n\nOnce set up, Automatic Private Key Rotation removes the need for manual administration when keys expire at intervals determined by your organization's policy. The recommended key lifetime is 2 years. Your organization should determine its own key expiration policy.\n\n## Remediation\n\n**Note:** Azure CLI and Powershell use ISO8601 flags to input timespans. Every timespan input will be in the format P\u0026lt;timespanInISO8601Format\u0026gt;(Y,M,D). The leading P is required with it denoting `period`. The (Y,M,D) are for the duration of Year, Month,and Day respectively. A time frame of 2 years, 2 months, 2 days would be (P2Y2M2D).\n\n### From Azure Portal\n\n1. From Azure Portal select the Portal Menu in the top left.\n2. Select Key Vaults.\n3. Select a Key Vault to audit.\n4. Under `Objects` select `Keys`.\n5. Select a key to audit.\n6. In the top row select `Rotation policy`.\n7. Select an `Expiry time`.\n8. Set `Enable auto rotation` to `Enabled`.\n9. Set an appropriate `Rotation option` and `Rotation time`.\n10. Optionally set the `Notification time`.\n11. Select `Save`.\n12. Repeat steps 3-11 for each Key Vault and Key.\n\n### From Azure CLI\n\nRun the following command for each key to update its policy to be auto-rotated:\n\n```bash\naz keyvault key rotation-policy update -n \u003ckeyName\u003e --vault-name \u003cvaultName\u003e --value \u003cpath/to/policy.json\u003e\n\nNote: It is easiest to supply the policy flags in a .json file. An example json file would be:\n\n{\n  \"lifetimeActions\": [\n    {\n      \"trigger\": {\n        \"timeAfterCreate\": \"\u003ctimespanInISO8601Format\u003e\",\n        \"timeBeforeExpiry\" : null\n      },\n      \"action\": {\n        \"type\": \"Rotate\"\n      }\n    },\n    {\n      \"trigger\": {\n        \"timeBeforeExpiry\" : \"\u003ctimespanInISO8601Format\u003e\"\n      },\n      \"action\": {\n        \"type\": \"Notify\"\n      }\n    }\n  ],\n  \"attributes\": {\n    \"expiryTime\": \"\u003ctimespanInISO8601Format\u003e\"\n  }\n}\n```\n\n### From Powershell\n\nRun the following command for each key to update its policy:\n\n```bash\nSet-AzKeyVaultKeyRotationPolicy -VaultName test-kv -Name test-key -PolicyPath rotation_policy.json\n```\n\n**Note**: It is easiest to supply the policy flags in a .json file. An example json file would be:\n\n```bash\n\u003c#\nrotation_policy.json\n{\n  \"lifetimeActions\": [\n    {\n      \"trigger\": {\n        \"timeAfterCreate\": \"P\u003ctimespanInISO8601Format\u003eM\",\n        \"timeBeforeExpiry\": null\n      },\n      \"action\": {\n        \"type\": \"Rotate\"\n      }\n    },\n    {\n      \"trigger\": {\n        \"timeBeforeExpiry\": \"P\u003ctimespanInISO8601Format\u003eD\"\n      },\n      \"action\": {\n        \"type\": \"Notify\"\n      }\n    }\n  ],\n  \"attributes\": {\n    \"expiryTime\": \"P\u003ctimespanInISO8601Format\u003eY\"\n  }\n}\n#\u003e\n```\n\n### Default Value:\n\nBy default, Automatic Key Rotation is not enabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_8"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_8",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_1",
    "description": "Azure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.",
    "title": "9.1 Ensure App Service Authentication is set up for apps in Azure App Service",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.1",
      "cis_level": "2",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nAzure App Service Authentication is a feature that can prevent anonymous HTTP requests from reaching a Web Application or authenticate those with tokens before they reach the app. If an anonymous request is received from a browser, App Service will redirect to a logon page. To handle the logon process, a choice from a set of identity providers can be made, or a custom authentication mechanism can be implemented.\n\nBy Enabling App Service Authentication, every incoming HTTP request passes through it before being handled by the application code. It also handles authentication of users with the specified provider (Azure Active Directory, Facebook, Google, Microsoft Account, and Twitter), validation, storing and refreshing of tokens, managing the authenticated sessions and injecting identity information into request headers.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Setting` section, click on `Authentication`.\n5. If no identity providers are set up, then click `Add identity provider`.\n6. Choose other parameters as per your requirements and click on `Add`.\n\n### From Azure CLI\n\nTo set App Service Authentication for an existing app, run the following command:\n\n```bash\naz webapp auth update --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e --enabled true\n```\n\n**Note:** In order to access `App Service authentication` settings for Web app using Microsoft API requires `Website contributor` permission at subscription level. A custom role can be created in place of `Website contributor` to provide more specific permission and maintain the principle of least privileged access.\n\n### Default Value\n\nBy default, App Service Authentication is disabled when a new app is created using the command-line tool or Azure Portal console.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_2",
    "description": "Azure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.",
    "title": "9.2 Ensure Web App Redirects All HTTP traffic to HTTPS in Azure App Service",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.2",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nAzure Web Apps allows sites to run under both HTTP and HTTPS by default. Web apps can be accessed by anyone using non-secure HTTP links by default. Non-secure HTTP requests can be restricted and all HTTP requests redirected to the secure HTTPS port. It is recommended to enforce HTTPS-only traffic.\n\nEnabling HTTPS-only traffic will redirect all non-secure HTTP requests to HTTPS ports. HTTPS uses the TLS/SSL protocol to provide a secure connection which is both encrypted and authenticated. It is therefore important to support HTTPS for the security benefits.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Setting` section, Click on `TLS/SSL settings`.\n5. Under the `Bindings` pane, set `HTTPS Only` to `On` under `Protocol Settings` section.\n\n### From Azure CLI\n\nTo set HTTPS-only traffic value for an existing app, run the following command:\n\n```bash\naz webapp update --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e -- set httpsOnly=true\n```\n\n### From Powershell\n\n```bash\nSet-AzWebApp -ResourceGroupName \u003cRESOURCE_GROUP_NAME\u003e -Name \u003cAPP_NAME\u003e - HttpsOnly $true\n```\n\n### Default Value\n\nBy default, HTTPS-only feature will be disabled when a new app is created using the command-line tool or Azure Portal console.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_3",
    "description": "The TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.",
    "title": "9.3 Ensure Web App is using the latest version of TLS encryption",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.3",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nThe TLS (Transport Layer Security) protocol secures transmission of data over the internet using standard encryption technology. Encryption should be set with the latest version of TLS. App service allows TLS 1.2 by default, which is the recommended TLS level by industry standards such as PCI DSS.\n\nApp service currently allows the web app to set TLS versions 1.0, 1.1 and 1.2. It is highly recommended to use the latest TLS 1.2 version for web app secure connections.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Setting` section, Click on `SSL settings`.\n5. Under the `Bindings` pane, set `Minimum TLS Version` to `1.2` under `Protocol Settings` section.\n\n### From Azure CLI\n\nTo set TLS Version for an existing app, run the following command:\n\n```bash\naz webapp config set --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e --min-tls-version 1.2\n```\n\n### From Powershell\n\n```bash\nSet-AzWebApp -ResourceGroupName \u003cRESOURCE_GROUP_NAME\u003e -Name \u003cAPP_NAME\u003e - MinTlsVersion 1.2\n```\n\n### Default Value\n\nBy default, TLS Version feature will be set to 1.2 when a new app is created using the command-line tool or Azure Portal console.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_4",
    "description": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
    "title": "9.4 Ensure the web app has 'Client Certificates (Incoming client certificates)' set to 'On'",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.4",
      "cis_level": "2",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nClient certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.\n\nThe TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled, then only an authenticated client who has valid certificates can access the app.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under the Settings section, Click on `Configuration`, then `General settings`.\n5. Set the option `Client certificate mode` located under Incoming client certificates is set to `Require`.\n\n\n### From Azure CLI\n\nTo set Incoming client certificates value for an existing app, run the following command:\n\n```bash\naz webapp update --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e -- set clientCertEnabled=true\n```\n\n### Default Value\n\nBy default, incoming client certificates will be disabled when a new app is created using the command-line tool or Azure Portal console.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_5",
    "description": "Managed service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services securely without the need for usernames and passwords.",
    "title": "9.5 Ensure that Register with Azure Active Directory is enabled on App Service",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.5",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nManaged service identity in App Service provides more security by eliminating secrets from the app, such as credentials in the connection strings. When registering with Azure Active Directory in App Service, the app will connect to other Azure services securely without the need for usernames and passwords.\n\nApp Service provides a highly scalable, self-patching web hosting service in Azure. It also provides a managed identity for apps, which is a turn-key solution for securing access to Azure SQL Database and other Azure services.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Setting` section, Click on `Identity`.\n5. Under the `System assigned` pane, set `Status` to `On`.\n\n### From Azure CLI\n\nTo set Register with Azure Active Directory feature for an existing app, run the following command\n\n```bash\naz webapp identity assign --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e\n```\n\n### From PowerShell\n\nTo register with Azure Active Directory feature for an existing app, run the following command:\n\n```bash\nSet-AzWebApp -AssignIdentity $True -ResourceGroupName \u003cresource_Group_Name\u003e - Name \u003cApp_Name\u003e\n```\n\n### Default Value\n\nBy default, Managed service identity via Azure AD is disabled.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_6",
    "description": "Periodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.",
    "title": "9.6 Ensure That 'PHP version' is the Latest, If Used to Run the Web App",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.6",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nPeriodically newer versions are released for PHP software either due to security flaws or to include additional functionality. Using the latest PHP version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home open the Portal Menu in the top left.\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Settings` section, click on `Configuration`.\n5. Click on the `General settings` pane, ensure that for a `Stack` of `PHP` the `Major Version` and `Minor Version` reflect the latest stable and supported release.\n\n**Note:** No action is required If `PHP version` is set to `Off` or is set with an empty value as PHP is not used by your web app.\n\n### From Azure CLI\n\nList the available PHP runtimes:\n\n```bash\naz webapp list-runtimes\n```\n\nTo set latest PHP version for an existing app, run the following command:\n\n```bash\naz webapp config set --resource-group \u003cresource group name\u003e --name \u003capp name\u003e [--linux-fx-version \u003cphp runtime version\u003e][--php-version \u003cphp version\u003e]\n```\n\n### From Powershell\n\nTo set latest PHP version for an existing app, run the following command:\n\n```bash\nSet-AzWebApp -ResourceGroupName \u003cresource group name\u003e -Name \u003capp name\u003e - phpVersion \u003cphp version\u003e\n```\n\n**Note:** Currently there is no way to update an existing web app `Linux FX Version` setting using PowerShell, nor is there a way to create a new web app using PowerShell that configures the PHP runtime in the `Linux FX Version` setting.\n\n### Default Value\n\nThe version of PHP is whatever was selected upon App creation.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_7",
    "description": "Periodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.",
    "title": "9.7 Ensure that 'Python version' is the Latest Stable Version, if Used to Run the Web App",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.7",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nPeriodically, newer versions are released for Python software either due to security flaws or to include additional functionality. Using the latest full Python version for web apps is recommended in order to take advantage of security fixes, if any, and/or additional functionalities of the newer version.\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected. Using the latest full version will keep your stack secure to vulnerabilities and exploits.\n\n## Remediation\n\n### From Azure Portal\n\n1. From Azure Home open the Portal Menu in the top left.\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Settings` section, click on `Configuration`.\n5. Click on the General settings pane and ensure that the Major Version and the Minor Version is set to the latest stable version available (Python 3.11, at the time of writing).\n\n**NOTE:** No action is required if `Python version` is set to `Off`, as Python is not used by your web app.\n\n### From Azure CLI\n\nTo see the list of supported runtimes:\n\n```bash\naz webapp list-runtimes\n```\n\nTo set latest Python version for an existing app, run the following command:\n\n```bash\naz webapp config set --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e [--windows-fx-version \"PYTHON|3.11\"] [--linux-fx-version \"PYTHON|3.11\"]\n```\n\n### From PowerShell\n\nAs of this writing, there is no way to update an existing application's `SiteConfig` or set the a new application's `SiteConfig` settings during creation via PowerShell.\n\n### Default Value\n\nThe version of Python is whatever was selected upon App creation.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_8",
    "description": "Periodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the newer version.",
    "title": "9.8 Ensure that 'Java version' is the latest, if used to run the Web App",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.8",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nPeriodically, newer versions are released for Java software either due to security flaws or to include additional functionality. Using the latest Java version for web apps is recommended in order to take advantage of security fixes, if any, and/or new functionalities of the newer version.\n\nNewer versions may contain security enhancements and additional functionality. Using the latest software version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\n## Remediation\n\n### From Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com)\n2. Go to `App Services`\n3. Click on each App\n4. Under `Settings` section, click on `Configuration`\n5. Click on the `General settings` pane and ensure that for a `Stack` of `Java` the `Major Version` and `Minor Version` reflect the latest stable and supported release, and that the `Java web server version` is set to the `auto-update` option.\n\n**Note** No action is required if `Java version` is set to `Off`, as Java is not used by your web app.\n\n### From Azure CLI\n\nTo see the list of supported runtimes:\n\n```bash\naz webapp list-runtimes\n```\n\nTo set latest Java version for an existing app, run the following command:\n\n```bash\naz webapp config set --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e [--java-version \u003cJAVA_VERSION\u003e --java-container \u003cJAVA_CONTAINER\u003e --java- container-version \u003cJAVA_CONTAINER_VERSION\u003e [--windows-fx-version \u003cjava runtime version\u003e] [--linux-fx-version \u003cjava runtime version version\u003e]\n```\n\nIf creating a new web application to use a currently supported version of Java, run the following commands.\n\nTo create an app service plan:\n\n```bash\naz appservice plan create --resource-group \u003cresource group name\u003e --name \u003cplan name\u003e --location \u003clocation\u003e [--is-linux --number-of-workers \u003cint\u003e --sku \u003cpricing tier\u003e] [--hyper-v --sku \u003cpricing tier\u003e]\n```\n\nGet the app service plan ID:\n\n```bash\naz appservice plan list --query \"[].{Name:name, ID:id, SKU:sku, Location:location}\"\n```\n\nTo create a new Java web application using the retrieved app service ID:\n\n```bash\naz webapp create --resource-group \u003cresource group name\u003e --plan \u003capp service plan ID\u003e --name \u003capp name\u003e [--linux-fx-version \u003cjava run time version\u003e] [--\nwindows-fx-version \u003cjava run time version\u003e]\n```\n\n### From PowerShell\n\nAs of this writing, there is no way to update an existing application's `SiteConfig` or set a new application's `SiteConfig` settings during creation via PowerShell.\n\n### Default Value\n\nThe default setting is whichever setting was chosen in the creation of the webapp.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_9",
    "description": "Periodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.",
    "title": "9.9 Ensure that 'HTTP Version' is the Latest, if Used to Run the Web App",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.9",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nPeriodically, newer versions are released for HTTP either due to security flaws or to include additional functionality. Using the latest HTTP version for web apps to take advantage of security fixes, if any, and/or new functionalities of the newer version.\n\nNewer versions may contain security enhancements and additional functionality. Using the latest version is recommended in order to take advantage of enhancements and new capabilities. With each software installation, organizations need to determine if a given update meets their requirements. They must also verify the compatibility and support provided for any additional software against the update revision that is selected.\n\nHTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.\n\n## Remediation\n\n### Azure Portal\n\n1. Login to Azure Portal using [https://portal.azure.com](https://portal.azure.com).\n2. Go to `App Services`.\n3. Click on each App.\n4. Under `Setting` section, Click on `Configuration`.\n5. Set `HTTP version` to `2.0` under `General settings`.\n\n**NOTE:** Most modern browsers support HTTP 2.0 protocol over TLS only, while non- encrypted traffic continues to use HTTP 1.1. To ensure that client browsers connect to your app with HTTP/2, either buy an App Service Certificate for your app's custom domain or bind a third party certificate.\n\n### From Azure CLI\n\nTo set HTTP 2.0 version for an existing app, run the following command:\n\n```bash\naz webapp config set --resource-group \u003cRESOURCE_GROUP_NAME\u003e --name \u003cAPP_NAME\u003e --http20-enabled true\n```\n\n### From PowerShell\n\nTo enable HTTP 2.0 version support, run the following command:\n\n```bash\nSet-AzWebApp -ResourceGroupName \u003capp resource group\u003e -Name \u003capp name\u003e - Http20Enabled $true\n```\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_10",
    "description": "By default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.",
    "title": "9.10 Ensure FTP deployments are Disabled",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.10",
      "cis_level": "1",
      "cis_section_id": "9",
      "cis_type": "automated",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nBy default, Azure Functions, Web, and API Services can be deployed over FTP. If FTP is required for an essential deployment workflow, FTPS should be required for FTP login for all App Service Apps and Functions.\n\nAzure FTP deployment endpoints are public. An attacker listening to traffic on a wifi network used by a remote employee or a corporate network could see login traffic in clear-text which would then grant them full control of the code base of the app or service. This finding is more severe if User Credentials for deployment are set at the subscription level rather than using the default Application Credentials which are unique per App.\n\n## Remediation\n\n### From Azure Portal\n\n1. Go to the Azure Portal.\n2. Select `App Services`.\n3. Click on an app.\n4. Select `Settings` and then `Configuration`.\n5. Under `General Settings`, for the `Platform Settings`, the `FTP state` should be set to `Disabled` or `FTPS Only`.\n\n### From Azure CLI\n\nFor each out of compliance application, run the following choosing either 'disabled' or 'FtpsOnly' as appropriate:\n\n```bash\naz webapp config set --resource-group \u003cresource group name\u003e --name \u003capp name\u003e --ftps-state [disabled|FtpsOnly]\n```\n\n### From PowerShell\n\nFor each out of compliance application, run the following:\n\n```bash\nSet-AzWebApp -ResourceGroupName \u003cresource group name\u003e -Name \u003capp name\u003e - FtpsState \u003cDisabled or FtpsOnly\u003e\n```\n\n### Default Value\n\nBy default, FTP based deployment is `All allowed`.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 9 AppService",
    "category_hierarchy": [
      "CIS v2.0.0",
      "9 AppService"
    ],
    "control_id": "azure_compliance.control.cis_v200_9_11",
    "description": "Azure Key Vault will store multiple types of sensitive information such as encryption keys, certificate thumbprints, and Managed Identity Credentials. Access to these 'Secrets' can be controlled through granular permissions.",
    "title": "9.11 Ensure Azure Key Vaults are Used to Store Secrets",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "9.11",
      "cis_level": "2",
      "cis_section_id": "9",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure/AppService"
    },
    "documentation": "## Description\n\nAzure Key Vault will store multiple types of sensitive information such as encryption keys, certificate thumbprints, and Managed Identity Credentials. Access to these 'Secrets' can be controlled through granular permissions.\n\nThe credentials given to an application have permissions to create, delete, or modify data stored within the systems they access. If these credentials are stored within the application itself, anyone with access to the application or a copy of the code has access to them. Storing within Azure Key Vault as secrets increases security by controlling access. This also allows for updates of the credentials without redeploying the entire application.\n\n## Remediation\n\nRemediation has 2 steps\n\n1. Set up the Key Vault\n2. Set up the App Service to use the Key Vault\n\n### Step 1: Set up the Key Vault\n\n### From Azure CLI\n\n```bash\naz keyvault create --name \"\u003cname\u003e\" --resource-group \"\u003cmyResourceGroup\u003e\" -- location myLocation\n```\n\n### From Powershell\n\n```bash\nNew-AzKeyvault -name \u003cname\u003e -ResourceGroupName \u003cmyResourceGroup\u003e -Location \u003cmyLocation\u003e\n```\n\n### Step 2: Set up the App Service to use the Key Vault\n\nSample JSON Template for App Service Configuration:\n\n```bash\n{\n   \"resources\":[\n      {\n        \"type\":\"Microsoft.Storage/storageAccounts\",\n        \"name\":\"[variables('storageAccountName')]\",\n      },\n      {\n        \"type\":\"Microsoft.Insights/components\",\n        \"name\":\"[variables('appInsightsName')]\",\n      },\n      {\n        \"type\":\"Microsoft.Web/sites\",\n        \"name\":\"[variables('functionAppName')]\",\n        \"identity\":{\n            \"type\":\"SystemAssigned\"\n         },\n         \"resources\":[\n            {\n               \"type\":\"config\",\n               \"name\":\"appsettings\",\n               \"dependsOn\":[\n                  \"[resourceId('Microsoft.Web/sites', variables('functionAppName'))]\",\n                  \"[resourceId('Microsoft.KeyVault/vaults/', variables('keyVaultName'))]\",\n                  \"[resourceId('Microsoft.KeyVault/vaults/secrets', variables('keyVaultName'), variables('storageConnectionStringName'))]\",\n                  \"[resourceId('Microsoft.KeyVault/vaults/secrets', variables('keyVaultName'), variables('appInsightsKeyName'))]\"\n               ],\n               \"properties\":{\n                  \"AzureWebJobsStorage\":\"[concat('@Microsoft.KeyVault(SecretUri=', reference(variables('storageConnectionStringResourceId')).secretUriWithVersio n, ')')]\",\n                  \"WEBSITE_CONTENTAZUREFILECONNECTIONSTRING\":\"[concat('@Microsoft.KeyVault(SecretUri=',\n    reference(variables('storageConnectionStringResourceId')).secretUriWithVersio n, ')')]\",\n                  \"APPINSIGHTS_INSTRUMENTATIONKEY\":\"[concat('@Microsoft.KeyVault(SecretUri=',\n    reference(variables('appInsightsKeyResourceId')).secretUriWithVersion, ')')]\",\n                  \"WEBSITE_ENABLE_SYNC_UPDATE_SITE\":\"true\"\n               }\n            },\n            {\n               \"type\":\"sourcecontrols\",\n               \"name\":\"web\",\n               \"dependsOn\":[\n                  \"[resourceId('Microsoft.Web/sites', variables('functionAppName'))]\",\n                  \"[resourceId('Microsoft.Web/sites/config', variables('functionAppName'), 'appsettings')]\"\n               ]\n            }{\n               \"type\":\"Microsoft.KeyVault/vaults\",\n               \"name\":\"[variables('keyVaultName')]\",\n            ]\n         },\n         \"dependsOn\":[\n            \"[resourceId('Microsoft.Web/sites',\n    variables('functionAppName'))]\"\n         ],\n         \"properties\":{\n            \"accessPolicies\":[\n               {\n                  \"tenantId\":\"[reference(concat('Microsoft.Web/sites/', variables('functionAppName'),\n    '/providers/Microsoft.ManagedIdentity/Identities/default'), '2015-08-31- PREVIEW').tenantId]\",\n                  \"objectId\":\"[reference(concat('Microsoft.Web/sites/', variables('functionAppName'),\n    '/providers/Microsoft.ManagedIdentity/Identities/default'), '2015-08-31- PREVIEW').principalId]\",\n                  \"permissions\":{\n                     \"secrets\":[\n                        \"get\"\n                     ]\n                  }\n               }\"resources\":[\n                  {\n                     \"type\":\"secrets\"\n                  ]\n               },\n               \"name\":\"[variables('storageConnectionStringName')]\",\n               \"dependsOn\":[\n                  \"[resourceId('Microsoft.KeyVault/vaults/', variables('keyVaultName'))]\",\n                  \"[resourceId('Microsoft.Storage/storageAccounts', variables('storageAccountName'))]\"\n               ],\n               \"properties\":{\n                  \"value\":\"[concat('DefaultEndpointsProtocol=https;AccountName=',\n    variables('storageAccountName'), ';AccountKey=', listKeys(variables('storageAccountResourceId'),'2015-05-01-preview').key1)]\"\n               }\n            },\n            {\n               \"type\":\"secrets\",\n               \"name\":\"[variables('appInsightsKeyName')]\",\n               \"dependsOn\":[\n                  \"[resourceId('Microsoft.KeyVault/vaults/', variables('keyVaultName'))]\",\n                  \"[resourceId('Microsoft.Insights/components', variables('appInsightsName'))]\"\n               ],\n               \"properties\":{\n                  \"value\":\"[reference(resourceId('microsoft.insights/components/',\n    variables('appInsightsName')), '2015-05-01').InstrumentationKey]\"\n               }\n            }\n         ]\n      }\n   ]\n}\n```\n\n### Default Value\n\nBy default, no Azure Key Vaults are created.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_9"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_9",
    "executable": true
  },
  {
    "category_breadcrumb": "CIS v2.0.0 \u003e 10 Miscellaneous",
    "category_hierarchy": [
      "CIS v2.0.0",
      "10 Miscellaneous"
    ],
    "control_id": "azure_compliance.control.cis_v200_10_1",
    "description": "Resource Manager Locks provide a way for administrators to lock down Azure resources to prevent deletion of, or modifications to, a resource. These locks sit outside of the Role Based Access Controls (RBAC) hierarchy and, when applied, will place restrictions on the resource for all users.",
    "title": "10.1 Ensure that Resource Locks are set for Mission-Critical Azure Resources",
    "tags": {
      "category": "Compliance",
      "cis": "true",
      "cis_item_id": "10.1",
      "cis_level": "2",
      "cis_section_id": "8",
      "cis_type": "manual",
      "cis_version": "v2.0.0",
      "plugin": "azure",
      "service": "Azure"
    },
    "documentation": "## Description\n\nResource Manager Locks provide a way for administrators to lock down Azure resources to prevent deletion of, or modifications to, a resource. These locks sit outside of the Role Based Access Controls (RBAC) hierarchy and, when applied, will place restrictions on the resource for all users. These locks are very useful when there is an important resource in a subscription that users should not be able to delete or change. Locks can help prevent accidental and malicious changes or deletion.\n\nAs an administrator, it may be necessary to lock a subscription, resource group, or resource to prevent other users in the organization from accidentally deleting or modifying critical resources. The lock level can be set to to `CanNotDelete` or `ReadOnly` to achieve this purpose.\n\n- `CanNotDelete` means authorized users can still read and modify a resource, but they cannot delete the resource.\n- `ReadOnly` means authorized users can read a resource, but they cannot delete or update the resource. Applying this lock is similar to restricting all authorized users to the permissions granted by the Reader role.\n\n## Remediation\n\n### From Azure Portal\n\n1. Navigate to the specific Azure Resource or Resource Group.\n2. For each of the mission critical resource, click on `Locks`.\n3. Click `Add`.\n4. Give the lock a name and a description, then select the type, `Read-only` or `Delete` as appropriate.\n5. Click OK.\n\n### From Azure CLI\n\nTo lock a resource, provide the name of the resource, its resource type, and its resource group name.\n\n```bash\naz lock create --name \u003cLockName\u003e --lock-type \u003cCanNotDelete/Read-only\u003e -- resource-group \u003cresourceGroupName\u003e --resource-name \u003cresourceName\u003e --resource- type \u003cresourceType\u003e\n```\n\n### From Powershel\n\n```bash\nGet-AzResourceLock -ResourceName \u003cResource Name\u003e -ResourceType \u003cResource Type\u003e -ResourceGroupName \u003cResource Group Name\u003e -Locktype \u003cCanNotDelete/Read- only\u003e\n```\n\n### Default Value\n\nBy default, no locks are set.\n",
    "parent_control_hierarchy": [
      "azure_compliance.benchmark.cis_v200",
      "azure_compliance.benchmark.cis_v200_10"
    ],
    "parent_control_breadcrumb": "azure_compliance.benchmark.cis_v200/azure_compliance.benchmark.cis_v200_10",
    "executable": true
  }
]