import { Listbox, ListboxOption } from 'ui-components';

import { useGetMalwareClassesForScan } from '@/features/malwares/data-components/malwareScanClassesApiLoader';

export const MalwareClassesForScan = ({
  scanId,
  selectedClasses,
  onChange,
}: {
  scanId: string;
  selectedClasses: string[];
  onChange: (classes: string[]) => void;
}) => {
  const { classes } = useGetMalwareClassesForScan({ scanId });
  return (
    <Listbox
      multiple
      sizing="sm"
      label="Class"
      placeholder="Select Class"
      name="classFilter"
      value={selectedClasses}
      onChange={(value) => {
        onChange(value);
      }}
    >
      {[...classes].sort().map((cls) => {
        return (
          <ListboxOption key={cls} value={cls}>
            {cls}
          </ListboxOption>
        );
      })}
    </Listbox>
  );
};
